<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>af490-greco.dvi</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="generator" content="pdftohtml 0.35beta">
<META name="date" content="2005-09-30T08:56:21+00:00">
</HEAD>
<BODY bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft0{font-size:24px;font-family:Helvetica;color:#000000;}
	.ft1{font-size:15px;font-family:Helvetica;color:#000000;}
	.ft2{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft3{font-size:15px;font-family:Times;color:#000000;}
	.ft4{font-size:11px;font-family:Times;color:#000000;}
	.ft5{font-size:9px;font-family:Times;color:#000000;}
	.ft6{font-size:9px;font-family:Times;color:#000000;}
	.ft7{font-size:16px;font-family:Courier;color:#000000;}
	.ft8{font-size:11px;font-family:Times;color:#000000;}
	.ft9{font-size:11px;line-height:15px;font-family:Times;color:#000000;}
	.ft10{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143001.png" alt="background image">
<DIV style="position:absolute;top:109;left:134"><nobr><span class="ft0"><b>On the Complexity of Computing Peer Agreements</b></span></nobr></DIV>
<DIV style="position:absolute;top:139;left:153"><nobr><span class="ft0"><b>for Consistent Query Answering in Peer-to-Peer</b></span></nobr></DIV>
<DIV style="position:absolute;top:168;left:296"><nobr><span class="ft0"><b>Data Integration Systems</b></span></nobr></DIV>
<DIV style="position:absolute;top:237;left:226"><nobr><span class="ft1">Gianluigi Greco</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:225"><nobr><span class="ft2">Dip. di Matematica</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:207"><nobr><span class="ft2">Universit `a della Calabria</span></nobr></DIV>
<DIV style="position:absolute;top:286;left:223"><nobr><span class="ft2">87030 Rende - Italy</span></nobr></DIV>
<DIV style="position:absolute;top:308;left:204"><nobr><span class="ft1">ggreco@mat.unical.it</span></nobr></DIV>
<DIV style="position:absolute;top:237;left:546"><nobr><span class="ft1">Francesco Scarcello</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:609"><nobr><span class="ft2">DEIS</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:546"><nobr><span class="ft2">Universit `a della Calabria</span></nobr></DIV>
<DIV style="position:absolute;top:286;left:562"><nobr><span class="ft2">87030 Rende - Italy</span></nobr></DIV>
<DIV style="position:absolute;top:308;left:533"><nobr><span class="ft1">scarcello@deis.unical.it</span></nobr></DIV>
<DIV style="position:absolute;top:362;left:81"><nobr><span class="ft3"><b>ABSTRACT</b></span></nobr></DIV>
<DIV style="position:absolute;top:387;left:81"><nobr><span class="ft9">Peer-to-Peer (P2P ) data integration systems have recently<br>attracted significant attention for their ability to manage<br>and share data dispersed over different peer sources. While<br>integrating data for answering user queries, it often happens<br>that inconsistencies arise, because some integrity constraints<br>specified on peers' global schemas may be violated. In these<br>cases, we may give semantics to the inconsistent system by<br>suitably "repairing" the retrieved data, as typically done in<br>the context of traditional data integration systems. How-<br>ever, some specific features of P2P systems, such as peer<br>autonomy and peer preferences (e.g., different source trust-<br>ing), should be properly addressed to make the whole ap-<br>proach effective. In this paper, we face these issues that<br>were only marginally considered in the literature. We first<br>present a formal framework for reasoning about autonomous<br>peers that exploit individual preference criteria in repairing<br>the data. The idea is that queries should be answered over<br>the best possible database repairs with respect to the pref-<br>erences of all peers, i.e., the states on which they are able to<br>find an agreement. Then, we investigate the computational<br>complexity of dealing with peer agreements and of answer-<br>ing queries in P2P data integration systems. It turns out<br>that considering peer preferences makes these problems only<br>mildly harder than in traditional data integration systems.</span></nobr></DIV>
<DIV style="position:absolute;top:790;left:81"><nobr><span class="ft3"><b>Categories and Subject Descriptors</b></span></nobr></DIV>
<DIV style="position:absolute;top:815;left:81"><nobr><span class="ft4">H.2.4 [Database Management]:</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:318"><nobr><span class="ft4">systems--Relational</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:81"><nobr><span class="ft9">databases; F.2.2 [Analysis of Algorithms and Problem<br>Complexity]: Nonnumerical Algorithms and Problems</span></nobr></DIV>
<DIV style="position:absolute;top:884;left:81"><nobr><span class="ft3"><b>General Terms</b></span></nobr></DIV>
<DIV style="position:absolute;top:909;left:81"><nobr><span class="ft4">Theory, Management</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:81"><nobr><span class="ft10">Permission to make digital or hard copies of all or part of this work for<br>personal or classroom use is granted without fee provided that copies are<br>not made or distributed for profit or commercial advantage and that copies<br>bear this notice and the full citation on the first page. To copy otherwise, to<br>republish, to post on servers or to redistribute to lists, requires prior specific<br>permission and/or a fee.<br><i>CIKM'05, </i>October 31­November 5, 2005, Bremen, Germany.<br>Copyright 2005 ACM 1-59593-140-6/05/0010 ...</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:316"><nobr><span class="ft4">$</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:323"><nobr><span class="ft5">5.00.</span></nobr></DIV>
<DIV style="position:absolute;top:362;left:475"><nobr><span class="ft3"><b>Keywords</b></span></nobr></DIV>
<DIV style="position:absolute;top:387;left:475"><nobr><span class="ft4">Peer-to-Peer Systems, Data Integration Systems</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:475"><nobr><span class="ft3"><b>1.</b></span></nobr></DIV>
<DIV style="position:absolute;top:432;left:506"><nobr><span class="ft3"><b>INTRODUCTION</b></span></nobr></DIV>
<DIV style="position:absolute;top:455;left:489"><nobr><span class="ft4">Peer-to-Peer (P2P ) data integration systems are networks</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:475"><nobr><span class="ft9">of autonomous peers that have recently emerged as an effec-<br>tive architecture for decentralized data sharing, integration,<br>and querying. Indeed, P2P systems offer transparent ac-<br>cess to the data stored at (the sources of) each peer p, by<br>means of the global schema equipped with p for modeling<br>its domain of interest; moreover, pair of peers with the same<br>domain of interest one peer and the system is in charge of<br>accessing each peer containing relevant data separately, and<br>combining local results into a global answer by suitably ex-<br>ploiting the mapping rules.</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:489"><nobr><span class="ft4">P2P systems can be considered the natural evolution of</span></nobr></DIV>
<DIV style="position:absolute;top:643;left:475"><nobr><span class="ft9">traditional data integration systems, which have received<br>considerable attention in the last few years, and which have<br>already become a key technology for managing enormous<br>amounts of information dispersed over many data sources.</span></nobr></DIV>
<DIV style="position:absolute;top:706;left:489"><nobr><span class="ft4">In fact, P2P systems have attracted significant attention</span></nobr></DIV>
<DIV style="position:absolute;top:721;left:475"><nobr><span class="ft9">recently, both in the development of efficient distributed al-<br>gorithms for the retrieval of relevant information and for<br>answering user queries (see, e.g., [9, 21, 12, 13]), and in the<br>investigation of its theoretical underpinnings (see, e.g., [16,<br>3, 20, 11, 9, 5]).</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:489"><nobr><span class="ft4">In this paper, we continue along this latter line of research,</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:475"><nobr><span class="ft9">by investigating some important theoretical issues. In par-<br>ticular, we consider an expressive framework where integrity<br>constraints are specified on peer schemas in order to enhance<br>their expressiveness, so that each peer can be in fact con-<br>sidered a completely specified data integration system. In<br>this scenario, it may happen that data at different peers are<br>mutually inconsistent, i.e., some integrity constraints are vi-<br>olated after the integration is carried out; then, a "repair"<br>for the P2P system has to be computed [5, 17]. Roughly<br>speaking, repairs may be viewed as insertions or deletions<br>of tuples at the peers that are able to lead the system to a<br>consistent state.</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:489"><nobr><span class="ft4">Our aim is to deal with data integration in P2P systems,</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:475"><nobr><span class="ft9">by extending some of the ideas described in previous studies<br>on merging mutually inconsistent databases into a single<br>consistent theory [2, 14] and on repairing individual data<br>integration systems [8, 6, 4, 10].</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">36</span></nobr></DIV>
</DIV>
<!-- Page 2 -->
<a name="2"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft11{font-size:6px;font-family:Times;color:#000000;}
	.ft12{font-size:11px;line-height:19px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143002.png" alt="background image">
<DIV style="position:absolute;top:86;left:94"><nobr><span class="ft4">Indeed, in order to be effective in this framework, the re-</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft9">pair approach should consider the peculiarities of P2P sys-<br>tems and, specifically, the following two issues:</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:101"><nobr><span class="ft4">· In practical applications, peers often have an a-priori</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:114"><nobr><span class="ft9">knowledge about the reliability of the sources that, in<br>turn, determines their criteria for computing repairs.<br>That is, peers will rarely delete tuples coming from<br>highly reliable sources, and will try to solve conflicts<br>by updating the less reliable sources only.</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:101"><nobr><span class="ft4">· Peers are autonomous and not benevolent: they rarely</span></nobr></DIV>
<DIV style="position:absolute;top:257;left:114"><nobr><span class="ft9">disregard their individual preferences in order to find<br>an agreement with other peers on the way the repair<br>should be carried out. Therefore, the presence of pos-<br>sibly contrasting interests of selfish peers should be<br>accounted for, when answering user queries.</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:81"><nobr><span class="ft9">Despite the wide interest in this field, none of the approaches<br>in the literature considered the issue of modeling the auton-<br>omy of the peers in providing a semantics for the system,<br>and therefore they implicitly assume that all the peers act<br>cooperatively in the network. Moreover, the possibility of<br>modeling peer preferences has been rarely considered in pre-<br>vious studies, even though it has been widely recognized to<br>be a central issue for the design of quality-aware integra-<br>tion systems (cf. [17]). Indeed, the first and almost isolated<br>attempt is in [5], where the authors considered trust rela-<br>tionships among peers in a simplified setting in which the<br>system does not transitively propagate information through<br>peers. Actually, an extension to the case of transitive propa-<br>gations is also argued, but peers autonomy is not considered,<br>and query answering is undecidable in presence of loops.</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:94"><nobr><span class="ft4">In this paper, we face the above issues by introducing</span></nobr></DIV>
<DIV style="position:absolute;top:595;left:81"><nobr><span class="ft9">a formal framework for reasoning about autonomous peers<br>that exploit individual preference criteria in repairing data.<br>In summary, our contributions are the following:</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:97"><nobr><span class="ft4">£ We preliminary introduce a framework for P2P data</span></nobr></DIV>
<DIV style="position:absolute;top:661;left:114"><nobr><span class="ft9">integration systems, where each peer is equipped with<br>integrity constraints on its global schema. The model<br>is simple yet very expressive, since each peer is as-<br>sumed to be in turn a data integration system. The<br>semantics of a P2P system is defined in terms of suit-<br>able databases for the peers, called models. We show<br>that checking whether a system has a model can be<br>done efficiently.</span></nobr></DIV>
<DIV style="position:absolute;top:785;left:97"><nobr><span class="ft4">£ We propose an approach to the repair of inconsis-</span></nobr></DIV>
<DIV style="position:absolute;top:804;left:114"><nobr><span class="ft9">tent P2P systems that focuses on data stored at the<br>sources, rather than on the global schema (following<br>the approach described by [15] for the standard data<br>integration setting).</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:251"><nobr><span class="ft4">This is particularly suited for</span></nobr></DIV>
<DIV style="position:absolute;top:867;left:114"><nobr><span class="ft9">dealing with peers, as their preferences are typically<br>expressed over the sources. Indeed, if repairs were con-<br>sidered on the global schema, suitable reformulations<br>and translation of the preferences would be required.</span></nobr></DIV>
<DIV style="position:absolute;top:928;left:97"><nobr><span class="ft4">£ We investigate the effect of considering individual pref-</span></nobr></DIV>
<DIV style="position:absolute;top:947;left:114"><nobr><span class="ft9">erences on the semantics of P2P database integration<br>systems. The idea is that queries should be answered<br>over the best possible database repairs with respect<br>to the preferences of all peers, i.e., over the states on<br>which they are able to find an agreement. Unfortu-<br>nately, but not surprisingly, it turns out that consid-<br>ering autonomous peers gives rise to scenarios where<br>they are not able to find any agreement on the way<br>the integration should be done.</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:491"><nobr><span class="ft4">£ The above result motivates the subsequent study of</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:509"><nobr><span class="ft9">the complexity of dealing with peer agreements and<br>of answering queries in such P2P data integration sys-<br>tems. We show that checking whether a given database<br>is an agreed repair is a difficult task, since it is com-<br>plete for the class co-NP. Moreover, the complexity of<br>computing an agreement turns out to be complete for</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:509"><nobr><span class="ft9">the functional class FPNP. Finally, we study the com-<br>plexity of computing consistent answers and show that<br>this problem is </span></nobr></DIV>
<DIV style="position:absolute;top:226;left:618"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:618"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:626"><nobr><span class="ft4">-complete. It follows that our ap-</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:509"><nobr><span class="ft9">proach for handling preferences in P2P systems is just<br>mildly harder than the basic data integration frame-<br>work, where in fact query answering lies at the first<br>level of the polynomial hierarchy [8], as well.</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:489"><nobr><span class="ft4">The rest of the paper is organized as follows.</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:790"><nobr><span class="ft4">In Sec-</span></nobr></DIV>
<DIV style="position:absolute;top:336;left:475"><nobr><span class="ft9">tion 2, we briefly present some preliminaries on relational<br>databases. In Section 3, we introduce a simple formaliza-<br>tion of P2P data integration systems and in the subsequent<br>section we enrich it to take care of peers' preferences. The<br>computational complexity of the concept of agreement in<br>query answering is studied in Section 5. Finally, in Section 6<br>we draw our conclusions.</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:475"><nobr><span class="ft3"><b>2.</b></span></nobr></DIV>
<DIV style="position:absolute;top:462;left:506"><nobr><span class="ft3"><b>PRELIMINARIES</b></span></nobr></DIV>
<DIV style="position:absolute;top:462;left:671"><nobr><span class="ft3"><b>ON</b></span></nobr></DIV>
<DIV style="position:absolute;top:462;left:715"><nobr><span class="ft3"><b>RELATIONAL</b></span></nobr></DIV>
<DIV style="position:absolute;top:483;left:507"><nobr><span class="ft3"><b>DATABASES</b></span></nobr></DIV>
<DIV style="position:absolute;top:506;left:489"><nobr><span class="ft4">We recall the basic notions of the relational model with</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:475"><nobr><span class="ft9">integrity constraints. For further background on relational<br>database theory, we refer the reader to [1].</span></nobr></DIV>
<DIV style="position:absolute;top:553;left:489"><nobr><span class="ft4">We assume a (possibly infinite) fixed database domain </span></nobr></DIV>
<DIV style="position:absolute;top:569;left:475"><nobr><span class="ft4">whose elements can be referenced by constants c</span></nobr></DIV>
<DIV style="position:absolute;top:571;left:781"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:787"><nobr><span class="ft4">,. . . , c</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:826"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:475"><nobr><span class="ft9">under the unique name assumption, i.e. different constants<br>denote different objects. These elements are assumed to be<br>shared by all the peers and are, in fact, the constants that<br>can appear in the P2P system.</span></nobr></DIV>
<DIV style="position:absolute;top:647;left:489"><nobr><span class="ft4">A relational schema (or simply schema)</span></nobr></DIV>
<DIV style="position:absolute;top:644;left:751"><nobr><span class="ft4">RS is a pair</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:481"><nobr><span class="ft4">,  , where:  is a set of relation symbols, each with an</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:475"><nobr><span class="ft9">associated arity that indicates the number of its attributes,<br>and  is a set of integrity constraints, i.e., (first-order) as-<br>sertions that have to be satisfied by each database instance.<br>We deal with quantified constraints, i.e., first order formulas<br>of the form:</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:544"><nobr><span class="ft4">~x.</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:574"><nobr><span class="ft11">l</span></nobr></DIV>
<DIV style="position:absolute;top:793;left:567"><nobr><span class="ft11">i=1</span></nobr></DIV>
<DIV style="position:absolute;top:775;left:587"><nobr><span class="ft4">A</span></nobr></DIV>
<DIV style="position:absolute;top:779;left:598"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:606"><nobr><span class="ft4"> ~y.</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:648"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:793;left:644"><nobr><span class="ft11">j=1</span></nobr></DIV>
<DIV style="position:absolute;top:775;left:665"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:779;left:676"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:684"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:761;left:703"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:794;left:697"><nobr><span class="ft11">k=1</span></nobr></DIV>
<DIV style="position:absolute;top:775;left:719"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:779;left:727"><nobr><span class="ft11">k</span></nobr></DIV>
<DIV style="position:absolute;top:775;left:734"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:775;left:816"><nobr><span class="ft4">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:475"><nobr><span class="ft4">where l+m &gt; 0, n  0, A</span></nobr></DIV>
<DIV style="position:absolute;top:802;left:626"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:632"><nobr><span class="ft4">, . . . A</span></nobr></DIV>
<DIV style="position:absolute;top:805;left:667"><nobr><span class="ft11">l</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:675"><nobr><span class="ft4">and B</span></nobr></DIV>
<DIV style="position:absolute;top:802;left:711"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:717"><nobr><span class="ft4">, . . . B</span></nobr></DIV>
<DIV style="position:absolute;top:805;left:752"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:766"><nobr><span class="ft4">are positive</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:475"><nobr><span class="ft4">literals, </span></nobr></DIV>
<DIV style="position:absolute;top:818;left:533"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:539"><nobr><span class="ft4">, . . . </span></nobr></DIV>
<DIV style="position:absolute;top:820;left:572"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:584"><nobr><span class="ft4">are built-in literals, and ~</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:733"><nobr><span class="ft4">x and ~</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:773"><nobr><span class="ft4">y are lists</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:475"><nobr><span class="ft4">of distinct variables.</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:489"><nobr><span class="ft4">Actually, to keep things simple, we shall assume through-</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:475"><nobr><span class="ft4">out the paper that ~</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:591"><nobr><span class="ft4">y is empty, thereby dealing with univer-</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:475"><nobr><span class="ft9">sally quantified constraints. We recall here that this kind of<br>constraint covers most of the classical constraints issued on<br>a relational schema, such as keys, functional dependencies,<br>and exclusion dependencies. A brief discussion on how to<br>generalize the results in the paper to other classes of con-<br>straints is reported in Section 6.</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:489"><nobr><span class="ft4">A database instance (or simply database)</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:736"><nobr><span class="ft4">DB for a schema</span></nobr></DIV>
<DIV style="position:absolute;top:985;left:475"><nobr><span class="ft9">RS = ,  is a set of facts of the form r(t) where r is a<br>relation of arity n in  and t is an n-tuple of constants<br>from . We denote as r</span></nobr></DIV>
<DIV style="position:absolute;top:1015;left:618"><nobr><span class="ft11">DB</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:640"><nobr><span class="ft4">the set</span></nobr></DIV>
<DIV style="position:absolute;top:1016;left:686"><nobr><span class="ft4">{t | r(t)  DB}.</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:489"><nobr><span class="ft4">A database</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:562"><nobr><span class="ft4">DB for a schema RS is said to be consistent</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:475"><nobr><span class="ft4">with</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:506"><nobr><span class="ft4">RS if it satisfies (in the first order logic sense) all con-</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:475"><nobr><span class="ft4">straints expressed on</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:606"><nobr><span class="ft4">RS.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">37</span></nobr></DIV>
</DIV>
<!-- Page 3 -->
<a name="3"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft13{font-size:5px;font-family:Times;color:#000000;}
	.ft14{font-size:11px;line-height:12px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143003.png" alt="background image">
<DIV style="position:absolute;top:272;left:302"><nobr><span class="ft4">Figure 1: The</span></nobr></DIV>
<DIV style="position:absolute;top:269;left:405"><nobr><span class="ft4">P2P system P</span></nobr></DIV>
<DIV style="position:absolute;top:269;left:504"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:272;left:516"><nobr><span class="ft4">in Example 1.</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:94"><nobr><span class="ft4">A relational query (or simply query ) over</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:361"><nobr><span class="ft4">RS is a for-</span></nobr></DIV>
<DIV style="position:absolute;top:332;left:81"><nobr><span class="ft9">mula that is intended to extract tuples of elements from<br>the underlying domain of constants .</span></nobr></DIV>
<DIV style="position:absolute;top:348;left:337"><nobr><span class="ft4">We assume that</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:81"><nobr><span class="ft4">queries over</span></nobr></DIV>
<DIV style="position:absolute;top:360;left:154"><nobr><span class="ft4">RS = ,  are Unions of Conjunctive Queries</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:81"><nobr><span class="ft4">(UCQs), i.e., formulas of the form</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:297"><nobr><span class="ft4">{~x | ~y</span></nobr></DIV>
<DIV style="position:absolute;top:381;left:343"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:349"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:354"><nobr><span class="ft4">conj</span></nobr></DIV>
<DIV style="position:absolute;top:383;left:380"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:386"><nobr><span class="ft4">(~</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:392"><nobr><span class="ft4">x, ~</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:406"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:381;left:415"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:421"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:430"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:391;left:81"><nobr><span class="ft4">· · ·  ~y</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:131"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:141"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:146"><nobr><span class="ft4">conj</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:173"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:183"><nobr><span class="ft4">(~</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:188"><nobr><span class="ft4">x, ~</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:203"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:212"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:222"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:391;left:227"><nobr><span class="ft4">} where, for each i  {1, . . . , m},</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:81"><nobr><span class="ft4">conj</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:107"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:112"><nobr><span class="ft4">(~</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:118"><nobr><span class="ft4">x, ~</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:132"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:140"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:145"><nobr><span class="ft4">) is a conjunction of atoms whose predicate sym-</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:81"><nobr><span class="ft4">bols are in , and involve ~</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:262"><nobr><span class="ft4">x = X</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:312"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:318"><nobr><span class="ft4">, . . . , X</span></nobr></DIV>
<DIV style="position:absolute;top:431;left:360"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:376"><nobr><span class="ft4">and ~</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:406"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:431;left:415"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:429"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:81"><nobr><span class="ft4">Y</span></nobr></DIV>
<DIV style="position:absolute;top:446;left:89"><nobr><span class="ft11">i,1</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:102"><nobr><span class="ft4">, . . . , Y</span></nobr></DIV>
<DIV style="position:absolute;top:446;left:141"><nobr><span class="ft11">i,n</span></nobr></DIV>
<DIV style="position:absolute;top:448;left:155"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:161"><nobr><span class="ft4">, where n is the arity of the query, and each</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:81"><nobr><span class="ft4">X</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:92"><nobr><span class="ft11">k</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:104"><nobr><span class="ft4">and each Y</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:170"><nobr><span class="ft11">i,</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:187"><nobr><span class="ft4">is either a variable or a constant in .</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:94"><nobr><span class="ft4">Given a database</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:208"><nobr><span class="ft4">DB for RS, the answer to a UCQ Q</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:81"><nobr><span class="ft4">over</span></nobr></DIV>
<DIV style="position:absolute;top:485;left:111"><nobr><span class="ft4">DB, denoted Q</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:206"><nobr><span class="ft11">DB</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:223"><nobr><span class="ft4">, is the set of n-tuples of constants</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:86"><nobr><span class="ft4">c</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:92"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:98"><nobr><span class="ft4">, . . . , c</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:135"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:151"><nobr><span class="ft4">such that, when substituting each X</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:364"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:372"><nobr><span class="ft4">with c</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:408"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:413"><nobr><span class="ft4">, the</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:81"><nobr><span class="ft4">formula</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:130"><nobr><span class="ft4">~y</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:147"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:153"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:157"><nobr><span class="ft4">conj</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:184"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:190"><nobr><span class="ft4">(~</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:195"><nobr><span class="ft4">x, ~</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:210"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:218"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:224"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:231"><nobr><span class="ft4">· · ·~y</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:284"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:295"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:299"><nobr><span class="ft4">conj</span></nobr></DIV>
<DIV style="position:absolute;top:527;left:326"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:337"><nobr><span class="ft4">(~</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:342"><nobr><span class="ft4">x, ~</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:356"><nobr><span class="ft4">y</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:365"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:375"><nobr><span class="ft4">) evaluates</span></nobr></DIV>
<DIV style="position:absolute;top:536;left:81"><nobr><span class="ft4">to true on</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:146"><nobr><span class="ft4">DB.</span></nobr></DIV>
<DIV style="position:absolute;top:567;left:81"><nobr><span class="ft3"><b>3.</b></span></nobr></DIV>
<DIV style="position:absolute;top:567;left:112"><nobr><span class="ft3"><b>DATA INTEGRATION IN P2P SYSTEMS</b></span></nobr></DIV>
<DIV style="position:absolute;top:589;left:94"><nobr><span class="ft4">In this section, we introduce a simple framework for deal-</span></nobr></DIV>
<DIV style="position:absolute;top:605;left:81"><nobr><span class="ft9">ing with P2P systems. The model is not meant to be a novel<br>comprehensive formalization, since our aim here is to face<br>the problem of finding agreement among peers rather than<br>to investigate new syntactic modeling features.</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:94"><nobr><span class="ft4">Therefore, our approach takes basically the same perspec-</span></nobr></DIV>
<DIV style="position:absolute;top:684;left:81"><nobr><span class="ft4">tive as [9, 11, 5, 17].</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:81"><nobr><span class="ft3"><b>3.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:707;left:121"><nobr><span class="ft3"><b>Basic Framework</b></span></nobr></DIV>
<DIV style="position:absolute;top:729;left:94"><nobr><span class="ft4">A P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:726;left:192"><nobr><span class="ft4">P is a tuple P, I, N , map , where P is</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:81"><nobr><span class="ft4">a non-empty set of distinct peers and</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:322"><nobr><span class="ft4">I, N and map are</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:81"><nobr><span class="ft4">functions whose meaning will be explained below.</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:406"><nobr><span class="ft4">First,</span></nobr></DIV>
<DIV style="position:absolute;top:777;left:81"><nobr><span class="ft9">each peer p  P is equipped with its own data integration<br>system</span></nobr></DIV>
<DIV style="position:absolute;top:789;left:127"><nobr><span class="ft4">I(p), which is formalized as a triple G</span></nobr></DIV>
<DIV style="position:absolute;top:797;left:361"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:367"><nobr><span class="ft4">, S</span></nobr></DIV>
<DIV style="position:absolute;top:797;left:382"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:388"><nobr><span class="ft4">, M</span></nobr></DIV>
<DIV style="position:absolute;top:797;left:411"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:423"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:94"><nobr><span class="ft4">Basically,</span></nobr></DIV>
<DIV style="position:absolute;top:804;left:159"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:812;left:167"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:181"><nobr><span class="ft4">is meant to denote the set of sources to</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:81"><nobr><span class="ft9">which p is allowed to access and is in fact modeled as a<br>relational schema of the form</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:268"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:277"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:839;left:289"><nobr><span class="ft4">= </span></nobr></DIV>
<DIV style="position:absolute;top:845;left:322"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:839;left:328"><nobr><span class="ft4">,  , i.e., there are</span></nobr></DIV>
<DIV style="position:absolute;top:855;left:81"><nobr><span class="ft9">no integrity constraints on the sources. The structure of<br>the global schema is, instead, represented by means of the<br>schema</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:130"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:891;left:139"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:886;left:151"><nobr><span class="ft4">= </span></nobr></DIV>
<DIV style="position:absolute;top:891;left:185"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:886;left:191"><nobr><span class="ft4">, </span></nobr></DIV>
<DIV style="position:absolute;top:891;left:207"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:886;left:219"><nobr><span class="ft4">, whereas the relationships between</span></nobr></DIV>
<DIV style="position:absolute;top:902;left:81"><nobr><span class="ft4">the sources and the global schema are specified by</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:413"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:907;left:429"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:902;left:436"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:918;left:81"><nobr><span class="ft4">which is a set of local mapping assertions between</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:377"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:385"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:918;left:395"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:421"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:429"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:918;left:436"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:81"><nobr><span class="ft4">We assume that each assertion is of the form Q</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:374"><nobr><span class="ft11">S</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:381"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:411"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:422"><nobr><span class="ft11">G</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:429"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:436"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:81"><nobr><span class="ft4">where Q</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:131"><nobr><span class="ft11">S</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:138"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:149"><nobr><span class="ft4">and Q</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:186"><nobr><span class="ft11">G</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:193"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:204"><nobr><span class="ft4">are two conjunctive queries of the same</span></nobr></DIV>
<DIV style="position:absolute;top:965;left:81"><nobr><span class="ft4">arity over the source schema</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:265"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:273"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:965;left:286"><nobr><span class="ft4">and the peer schema</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:421"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:429"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:965;left:436"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:981;left:81"><nobr><span class="ft4">respectively.</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:81"><nobr><span class="ft4">Example 1 Let us introduce three peers, namely p</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:406"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:412"><nobr><span class="ft4">, p</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:429"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:436"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:81"><nobr><span class="ft4">and p</span></nobr></DIV>
<DIV style="position:absolute;top:1037;left:115"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:121"><nobr><span class="ft4">, that constitute the P2P scenario that will be used</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:81"><nobr><span class="ft9">as a running example throughout this paper to illustrate<br>technical definitions.</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:489"><nobr><span class="ft4">The global schema</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:612"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:621"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:626"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:640"><nobr><span class="ft4">of peer p</span></nobr></DIV>
<DIV style="position:absolute;top:319;left:697"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:710"><nobr><span class="ft4">consists of the rela-</span></nobr></DIV>
<DIV style="position:absolute;top:332;left:475"><nobr><span class="ft9">tion predicate secretary (Employee, Manager ) (without con-<br>straints), the source schema</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:644"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:653"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:354;left:658"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:348;left:668"><nobr><span class="ft4">consists of the relation sym-</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:475"><nobr><span class="ft4">bol s</span></nobr></DIV>
<DIV style="position:absolute;top:366;left:506"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:512"><nobr><span class="ft4">, and the set</span></nobr></DIV>
<DIV style="position:absolute;top:360;left:595"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:369;left:612"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:370;left:618"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:629"><nobr><span class="ft4">of the local mapping assertions is</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:475"><nobr><span class="ft4">{X, Y | s</span></nobr></DIV>
<DIV style="position:absolute;top:381;left:529"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:535"><nobr><span class="ft4">(X, Y )}</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:603"><nobr><span class="ft4">{X, Y | secretary (X, Y )}.</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:489"><nobr><span class="ft4">As for peer p</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:579"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:585"><nobr><span class="ft4">, the schema</span></nobr></DIV>
<DIV style="position:absolute;top:391;left:677"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:685"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:691"><nobr><span class="ft13">2</span></nobr></DIV>
<DIV style="position:absolute;top:395;left:706"><nobr><span class="ft4">consists of the rela-</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:475"><nobr><span class="ft9">tion financial (Employee, Manager ) (without constraints),<br>the source schema consists of the relation symbol s</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:795"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:802"><nobr><span class="ft4">, and</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:475"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:492"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:448;left:498"><nobr><span class="ft13">2</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:508"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:523"><nobr><span class="ft4">{X, Y | s</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:576"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:582"><nobr><span class="ft4">(X, Y )}</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:651"><nobr><span class="ft4">{X, Y | financial(X, Y )}.</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:489"><nobr><span class="ft4">The schema</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:579"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:587"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:593"><nobr><span class="ft13">3</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:611"><nobr><span class="ft4">of peer p</span></nobr></DIV>
<DIV style="position:absolute;top:460;left:678"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:696"><nobr><span class="ft4">consists of the rela-</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:475"><nobr><span class="ft9">tions employee(Name, Dept) and boss(Employee, Manager ),<br>whose set of constraints contains the assertions (quantifiers<br>are omitted) employee (X, Y )  boss(X</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:708"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:715"><nobr><span class="ft4">, Y</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:729"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:735"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:501;left:745"><nobr><span class="ft4"> X = Y</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:800"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:812"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:475"><nobr><span class="ft4">boss(X, Y )  boss(X</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:597"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:603"><nobr><span class="ft4">, Y</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:617"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:624"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:633"><nobr><span class="ft4"> Y</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:656"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:665"><nobr><span class="ft4">= X, stating that managers</span></nobr></DIV>
<DIV style="position:absolute;top:536;left:475"><nobr><span class="ft4">are never employees; the source schema</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:724"><nobr><span class="ft4">S</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:733"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:739"><nobr><span class="ft13">3</span></nobr></DIV>
<DIV style="position:absolute;top:536;left:751"><nobr><span class="ft4">comprises the</span></nobr></DIV>
<DIV style="position:absolute;top:552;left:475"><nobr><span class="ft4">relation symbols s</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:584"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:552;left:590"><nobr><span class="ft4">; and, the set of the local mapping asser-</span></nobr></DIV>
<DIV style="position:absolute;top:567;left:475"><nobr><span class="ft4">tions is</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:523"><nobr><span class="ft4">{X, Y | s</span></nobr></DIV>
<DIV style="position:absolute;top:570;left:577"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:567;left:583"><nobr><span class="ft4">(X, Y )}</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:651"><nobr><span class="ft4">{X, Y | employee(X, Y )}.</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:600;left:489"><nobr><span class="ft4">Each peer p  P in a P2P system P = P, I, N , map is</span></nobr></DIV>
<DIV style="position:absolute;top:616;left:475"><nobr><span class="ft4">also equipped with the neighborhood function</span></nobr></DIV>
<DIV style="position:absolute;top:612;left:759"><nobr><span class="ft4">N providing</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:475"><nobr><span class="ft4">a set of peers</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:561"><nobr><span class="ft4">N (p)  P - {p} containing the peers (called</span></nobr></DIV>
<DIV style="position:absolute;top:647;left:475"><nobr><span class="ft9">neighbors) who potentially have some information of interest<br>to p. Intuitively, the neighborhood relation determines the<br>structure of a P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:647"><nobr><span class="ft4">P. Such a structure is better</span></nobr></DIV>
<DIV style="position:absolute;top:694;left:475"><nobr><span class="ft4">described by the dependency graph G(</span></nobr></DIV>
<DIV style="position:absolute;top:691;left:715"><nobr><span class="ft4">P) of P, i.e., by a</span></nobr></DIV>
<DIV style="position:absolute;top:710;left:475"><nobr><span class="ft9">directed graph having P as its set of vertices and {(p, q) |<br>q  P  p  N (q)} as its set of edges.</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:489"><nobr><span class="ft4">In particular, a peer q is in N (p) iff p is interested in the</span></nobr></DIV>
<DIV style="position:absolute;top:757;left:475"><nobr><span class="ft9">data exported by q by means of its global schema, i.e., some<br>of the global relations of p can be populated by means of<br>the data coming from q besides the data coming from the<br>sources of p itself. To this aim, map(p) defines the set of<br>peer mapping assertions of p.</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:489"><nobr><span class="ft4">Each assertion is an expression of the form Q</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:779"><nobr><span class="ft11">q</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:813"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:824"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:830"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:475"><nobr><span class="ft4">where the peer q  N (p) is a neighbor of p, and Q</span></nobr></DIV>
<DIV style="position:absolute;top:856;left:779"><nobr><span class="ft11">q</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:790"><nobr><span class="ft4">and Q</span></nobr></DIV>
<DIV style="position:absolute;top:856;left:827"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:867;left:475"><nobr><span class="ft14">are two conjunctive queries of the same arity over schemas<br>G</span></nobr></DIV>
<DIV style="position:absolute;top:887;left:483"><nobr><span class="ft11">q</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:494"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:879;left:521"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:887;left:529"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:536"><nobr><span class="ft4">, respectively.</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:475"><nobr><span class="ft4">Example 1 (contd.) Let</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:643"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:654"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:668"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:692"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:702"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:708"><nobr><span class="ft4">, I</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:723"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:729"><nobr><span class="ft4">, N</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:749"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:755"><nobr><span class="ft4">, map</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:788"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:806"><nobr><span class="ft4">be a</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:475"><nobr><span class="ft4">P2P system, where P</span></nobr></DIV>
<DIV style="position:absolute;top:938;left:606"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:616"><nobr><span class="ft4">consists of three peers p</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:759"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:765"><nobr><span class="ft4">, p</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:780"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:791"><nobr><span class="ft4">and p</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:824"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:830"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:475"><nobr><span class="ft4">such that</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:536"><nobr><span class="ft4">N</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:550"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:556"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:568"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:574"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:598"><nobr><span class="ft4">N</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:612"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:618"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:630"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:636"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:660"><nobr><span class="ft4"> and N</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:712"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:718"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:730"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:737"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:761"><nobr><span class="ft4">{p</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:774"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:780"><nobr><span class="ft4">, p</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:794"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:800"><nobr><span class="ft4">}.</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:489"><nobr><span class="ft4">Figure 1 summarizes the structure of the system</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:796"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:970;left:807"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:819"><nobr><span class="ft4">by</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:475"><nobr><span class="ft9">showing, for each peer, its global schema, its source schema,<br>and its local and peer mapping assertions. In particular,<br>notice that the mapping assertions are such that: map(p</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:808"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:814"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:475"><nobr><span class="ft4">map(p</span></nobr></DIV>
<DIV style="position:absolute;top:1037;left:514"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:520"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:544"><nobr><span class="ft4">, and map(p</span></nobr></DIV>
<DIV style="position:absolute;top:1037;left:626"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:632"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:656"><nobr><span class="ft4">{X, Y | financial(X, Y ))}</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:475"><nobr><span class="ft4">{X, Y | boss(X, Y )}  {X, Y | secretary(X, Y )}</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:789"><nobr><span class="ft4">{X, Y |</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:475"><nobr><span class="ft4">boss(X, Y )}.</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">38</span></nobr></DIV>
</DIV>
<!-- Page 4 -->
<a name="4"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="143004.png" alt="background image">
<DIV style="position:absolute;top:86;left:94"><nobr><span class="ft4">A source database for a P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:328"><nobr><span class="ft4">P is a function D</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft4">assigning to each peer p  P such that I(p) = G</span></nobr></DIV>
<DIV style="position:absolute;top:107;left:377"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:384"><nobr><span class="ft4">, S</span></nobr></DIV>
<DIV style="position:absolute;top:107;left:398"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:405"><nobr><span class="ft4">, M</span></nobr></DIV>
<DIV style="position:absolute;top:107;left:428"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:81"><nobr><span class="ft4">a database instance</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:204"><nobr><span class="ft4">D(p) for S</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:267"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:273"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:94"><nobr><span class="ft4">A global database for</span></nobr></DIV>
<DIV style="position:absolute;top:130;left:226"><nobr><span class="ft4">P is a function B assigning to each</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:81"><nobr><span class="ft4">peer p a database instance B(p) for G</span></nobr></DIV>
<DIV style="position:absolute;top:154;left:321"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:327"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:343"><nobr><span class="ft4">Usually, we are</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:81"><nobr><span class="ft9">interested in global databases that can be "retrieved" from<br>a given source, as formalized below.</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:94"><nobr><span class="ft4">Given a source database</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:262"><nobr><span class="ft4">D for P, a retrieved global</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:81"><nobr><span class="ft4">database for</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:163"><nobr><span class="ft4">D is a global database B that satisfies the</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:81"><nobr><span class="ft4">mapping assertions</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:201"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:218"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:230"><nobr><span class="ft4">of each peer p, i.e., B is such that:</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:81"><nobr><span class="ft4">p  P and (Q</span></nobr></DIV>
<DIV style="position:absolute;top:245;left:189"><nobr><span class="ft11">S</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:196"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:231"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:245;left:242"><nobr><span class="ft11">G</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:249"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:256"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:275"><nobr><span class="ft4"> M</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:308"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:315"><nobr><span class="ft4">, it is the case that</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:81"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:257;left:92"><nobr><span class="ft11">D(p)</span></nobr></DIV>
<DIV style="position:absolute;top:267;left:92"><nobr><span class="ft11">S</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:98"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:120"><nobr><span class="ft4"> Q</span></nobr></DIV>
<DIV style="position:absolute;top:257;left:145"><nobr><span class="ft11">B(p)</span></nobr></DIV>
<DIV style="position:absolute;top:267;left:145"><nobr><span class="ft11">G</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:152"><nobr><span class="ft13">p</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:168"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:281;left:94"><nobr><span class="ft4">We denote by ret (</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:204"><nobr><span class="ft4">P, D) the set of all the retrieved global</span></nobr></DIV>
<DIV style="position:absolute;top:297;left:81"><nobr><span class="ft4">databases for</span></nobr></DIV>
<DIV style="position:absolute;top:293;left:165"><nobr><span class="ft4">D in the system P.</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:94"><nobr><span class="ft4">Notice that in the definition above we are considering</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:81"><nobr><span class="ft9">sound mappings: data retrieved from the sources by the<br>mapping views are assumed to be a subset of the data that<br>satisfy the corresponding global relation. This is a classical<br>assumption in data integration, where sources in general do<br>not provide all the intended extensions of the global schema,<br>hence extracted data are to be considered sound but not<br>necessarily complete.</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:81"><nobr><span class="ft4">Example 1 (contd.) Let</span></nobr></DIV>
<DIV style="position:absolute;top:449;left:250"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:450;left:261"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:276"><nobr><span class="ft4">be a source database for</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:81"><nobr><span class="ft4">the P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:186"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:465;left:197"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:209"><nobr><span class="ft4">such that</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:272"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:465;left:283"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:290"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:302"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:308"><nobr><span class="ft4">) is</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:335"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:348"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:354"><nobr><span class="ft4">(Albert, Bill)},</span></nobr></DIV>
<DIV style="position:absolute;top:480;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:481;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:98"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:110"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:116"><nobr><span class="ft4">) consists of</span></nobr></DIV>
<DIV style="position:absolute;top:480;left:197"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:210"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:216"><nobr><span class="ft4">(John, Mary), s</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:307"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:313"><nobr><span class="ft4">(Mary, Tom)}, and</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:497;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:98"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:501;left:110"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:116"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:135"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:159"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:501;left:172"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:178"><nobr><span class="ft4">(Mary, D1)}.</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:278"><nobr><span class="ft4">Consider also the global</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:81"><nobr><span class="ft4">database</span></nobr></DIV>
<DIV style="position:absolute;top:511;left:140"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:512;left:150"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:163"><nobr><span class="ft4">such that</span></nobr></DIV>
<DIV style="position:absolute;top:511;left:228"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:512;left:237"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:244"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:256"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:262"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:511;left:293"><nobr><span class="ft4">{secretary (Albert, Bill)},</span></nobr></DIV>
<DIV style="position:absolute;top:527;left:81"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:90"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:96"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:109"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:115"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:527;left:153"><nobr><span class="ft4">{financial(John, Mary), financial(Mary, Tom)}</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:81"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:543;left:111"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:120"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:127"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:139"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:145"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:543;left:180"><nobr><span class="ft4">{employee(Mary, D1)}. Then, it is easy</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:81"><nobr><span class="ft4">to see that</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:155"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:165"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:177"><nobr><span class="ft4">is a retrieved database for</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:348"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:359"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:372"><nobr><span class="ft4">in</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:390"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:401"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:407"><nobr><span class="ft4">, i.e.,</span></nobr></DIV>
<DIV style="position:absolute;top:574;left:81"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:90"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:574;left:100"><nobr><span class="ft4"> ret(P</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:147"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:578;left:153"><nobr><span class="ft4">, D</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:170"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:578;left:176"><nobr><span class="ft4">).</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:94"><nobr><span class="ft4">Note that a global database</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:261"><nobr><span class="ft4">B whose peer schema for some</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:81"><nobr><span class="ft4">peer p  {p</span></nobr></DIV>
<DIV style="position:absolute;top:611;left:150"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:156"><nobr><span class="ft4">, p</span></nobr></DIV>
<DIV style="position:absolute;top:611;left:169"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:175"><nobr><span class="ft4">, p</span></nobr></DIV>
<DIV style="position:absolute;top:611;left:188"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:194"><nobr><span class="ft4">} is a superset of B</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:312"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:318"><nobr><span class="ft4">(p) is in ret (P</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:404"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:411"><nobr><span class="ft4">, D</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:428"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:434"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:625;left:81"><nobr><span class="ft4">as well - we simply say that</span></nobr></DIV>
<DIV style="position:absolute;top:621;left:253"><nobr><span class="ft4">B is a superset of B</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:372"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:625;left:379"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:621;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:81"><nobr><span class="ft3"><b>3.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:651;left:121"><nobr><span class="ft3"><b>Models of Peer-to-Peer Systems</b></span></nobr></DIV>
<DIV style="position:absolute;top:674;left:94"><nobr><span class="ft4">Given a source database</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:256"><nobr><span class="ft4">D, it is particular important</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:81"><nobr><span class="ft4">to investigate whether it is possible to retrieve from</span></nobr></DIV>
<DIV style="position:absolute;top:686;left:428"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:705;left:81"><nobr><span class="ft9">a database which satisfies the semantics of the network.<br>Therefore, we next define a suitable notion of model for a<br>P2P system. The approach has been inspired by the au-<br>toepistemic approach of [9]; in particular, we assume that<br>peers propagate through mapping assertions only the values<br>they really trust.</span></nobr></DIV>
<DIV style="position:absolute;top:810;left:81"><nobr><span class="ft4">Definition 2 Let</span></nobr></DIV>
<DIV style="position:absolute;top:806;left:193"><nobr><span class="ft4">P = P, I, N , map be a P2P system, p </span></nobr></DIV>
<DIV style="position:absolute;top:825;left:81"><nobr><span class="ft4">P a peer with I(p) = G</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:230"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:236"><nobr><span class="ft4">, S</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:251"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:257"><nobr><span class="ft4">, M</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:280"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:296"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:822;left:324"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:332"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:343"><nobr><span class="ft4">= </span></nobr></DIV>
<DIV style="position:absolute;top:830;left:374"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:380"><nobr><span class="ft4">, </span></nobr></DIV>
<DIV style="position:absolute;top:830;left:396"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:408"><nobr><span class="ft4">, and</span></nobr></DIV>
<DIV style="position:absolute;top:838;left:81"><nobr><span class="ft12">D a source instance for P. Then, a p-model for P w.r.t. D is<br>a maximal nonempty set of global databases</span></nobr></DIV>
<DIV style="position:absolute;top:853;left:352"><nobr><span class="ft4">M  ret(P, D)</span></nobr></DIV>
<DIV style="position:absolute;top:872;left:81"><nobr><span class="ft4">such that:</span></nobr></DIV>
<DIV style="position:absolute;top:891;left:97"><nobr><span class="ft4">1. for each</span></nobr></DIV>
<DIV style="position:absolute;top:887;left:169"><nobr><span class="ft4">B  M, B(p) satisfies the constraints in </span></nobr></DIV>
<DIV style="position:absolute;top:895;left:429"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:891;left:436"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:906;left:114"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:97"><nobr><span class="ft4">2. for each assertion Q</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:235"><nobr><span class="ft11">q</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:263"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:274"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:921;left:289"><nobr><span class="ft4"> map(p), it holds:</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:126"><nobr><span class="ft11">B  M</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:161"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:938;left:172"><nobr><span class="ft11">B (q)</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:172"><nobr><span class="ft11">q</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:202"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:949;left:228"><nobr><span class="ft11">B  M</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:263"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:938;left:274"><nobr><span class="ft11">B (p)</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:274"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:301"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:94"><nobr><span class="ft4">Thus, according to Condition 1, any databases in the p-</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:81"><nobr><span class="ft9">model satisfies all the integrity constraints issued over the<br>global schema of p; moreover, Condition 2 guarantees that<br>peers communicate only those values that belong to all mod-<br>els, i.e., a cautious approach to the propagation has been<br>pursued. Finally we point out that, as for local mapping as-<br>sertions, peer mapping assertions are assumed to be sound.</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:489"><nobr><span class="ft4">Now, given that each peer singles out its models, a notion</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:475"><nobr><span class="ft4">of model for the whole system can be easily stated.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:475"><nobr><span class="ft4">Definition 3 Let</span></nobr></DIV>
<DIV style="position:absolute;top:130;left:591"><nobr><span class="ft4">P = P, I, N , map be a P2P system.</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:475"><nobr><span class="ft4">A model for</span></nobr></DIV>
<DIV style="position:absolute;top:145;left:555"><nobr><span class="ft4">P w.r.t. D is a maximal nonempty set M </span></nobr></DIV>
<DIV style="position:absolute;top:165;left:475"><nobr><span class="ft4">ret (</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:498"><nobr><span class="ft4">P, D) of global databases such that, for each p  P , M</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:475"><nobr><span class="ft4">is a p-model. If a model for P w.r.t. D exists, we say that</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:475"><nobr><span class="ft4">D satisfies P, denoted by D |= P.</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:489"><nobr><span class="ft4">For</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:522"><nobr><span class="ft4">instance,</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:590"><nobr><span class="ft4">in</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:615"><nobr><span class="ft4">our</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:648"><nobr><span class="ft4">running</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:708"><nobr><span class="ft4">example,</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:777"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:788"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:807"><nobr><span class="ft4">does</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:475"><nobr><span class="ft4">not</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:509"><nobr><span class="ft4">satisfy</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:562"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:236;left:573"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:579"><nobr><span class="ft4">;</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:601"><nobr><span class="ft4">indeed,</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:661"><nobr><span class="ft4">the</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:694"><nobr><span class="ft4">peer</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:734"><nobr><span class="ft4">mapping</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:800"><nobr><span class="ft4">asser-</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:475"><nobr><span class="ft4">tions constrain the schema of p</span></nobr></DIV>
<DIV style="position:absolute;top:256;left:697"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:714"><nobr><span class="ft4">to contain in ev-</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:475"><nobr><span class="ft4">ery</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:506"><nobr><span class="ft4">global</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:555"><nobr><span class="ft4">database</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:620"><nobr><span class="ft4">(retrieved</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:691"><nobr><span class="ft4">from</span></nobr></DIV>
<DIV style="position:absolute;top:266;left:731"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:267;left:742"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:748"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:766"><nobr><span class="ft4">the</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:798"><nobr><span class="ft4">tuples</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:475"><nobr><span class="ft4">boss(Albert, Bill), boss(John, Mary), boss(Mary, Tom),</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:812"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:301;left:475"><nobr><span class="ft9">employee (Mary, D1) that violate the integrity constraints<br>over p</span></nobr></DIV>
<DIV style="position:absolute;top:319;left:513"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:519"><nobr><span class="ft4">, since Mary results to be both an employee and a</span></nobr></DIV>
<DIV style="position:absolute;top:332;left:475"><nobr><span class="ft4">manger. Therefore, retrieving data from</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:724"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:735"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:332;left:746"><nobr><span class="ft4">leads to an in-</span></nobr></DIV>
<DIV style="position:absolute;top:348;left:475"><nobr><span class="ft4">consistent scenario.</span></nobr></DIV>
<DIV style="position:absolute;top:364;left:489"><nobr><span class="ft4">We conclude by noticing that deciding whether a P2P</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:475"><nobr><span class="ft9">system admits a model can be done efficiently. The result<br>can be proven by modifying the techniques in [9], in order<br>to first evaluate all the mappings in the network and then<br>check for the satisfaction of the integrity constraints over<br>peer schemas.</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:475"><nobr><span class="ft4">Theorem 4</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:557"><nobr><span class="ft4">Let</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:581"><nobr><span class="ft4">P = P, I, N , map be a P2P system, and</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:475"><nobr><span class="ft12">D be a database instance for P. Then, deciding whether<br>there is a model for</span></nobr></DIV>
<DIV style="position:absolute;top:501;left:600"><nobr><span class="ft4">P w.r.t. D, i.e., D |= P, is feasible in</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:475"><nobr><span class="ft4">polynomial time.</span></nobr></DIV>
<DIV style="position:absolute;top:552;left:475"><nobr><span class="ft3"><b>4.</b></span></nobr></DIV>
<DIV style="position:absolute;top:552;left:506"><nobr><span class="ft3"><b>DEALING</b></span></nobr></DIV>
<DIV style="position:absolute;top:552;left:621"><nobr><span class="ft3"><b>WITH</b></span></nobr></DIV>
<DIV style="position:absolute;top:552;left:702"><nobr><span class="ft3"><b>AUTONOMOUS</b></span></nobr></DIV>
<DIV style="position:absolute;top:572;left:507"><nobr><span class="ft3"><b>PEERS</b></span></nobr></DIV>
<DIV style="position:absolute;top:595;left:489"><nobr><span class="ft4">As shown in our running example, in general data stored</span></nobr></DIV>
<DIV style="position:absolute;top:611;left:475"><nobr><span class="ft9">in local and autonomous sources are not required to sat-<br>isfy constraints expressed on the global schema (for example<br>when a key dependency on</span></nobr></DIV>
<DIV style="position:absolute;top:639;left:646"><nobr><span class="ft4">G is violated by data retrieved</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:475"><nobr><span class="ft9">from the sources). Thus, a P2P system may be unsatisfiable<br>w.r.t. a source database</span></nobr></DIV>
<DIV style="position:absolute;top:670;left:621"><nobr><span class="ft4">D. In this section, we face the prob-</span></nobr></DIV>
<DIV style="position:absolute;top:689;left:475"><nobr><span class="ft9">lem of solving inconsistencies in P2P systems. Specifically,<br>we introduce a semantics for "repairing" a P2P system. To<br>this aim, we first provide a model for peer preferences, and<br>then show the impact of these individual preferences on the<br>cost of reaching a global agreed repair.</span></nobr></DIV>
<DIV style="position:absolute;top:776;left:475"><nobr><span class="ft3"><b>4.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:776;left:515"><nobr><span class="ft3"><b>Peer Preferences and Repairs</b></span></nobr></DIV>
<DIV style="position:absolute;top:798;left:489"><nobr><span class="ft4">Let</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:515"><nobr><span class="ft4">P = P, I, N , map be a P2P system, and D be a</span></nobr></DIV>
<DIV style="position:absolute;top:814;left:475"><nobr><span class="ft4">source database instance for</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:657"><nobr><span class="ft4">P. Next, we define a repair</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:475"><nobr><span class="ft4">weighting function w</span></nobr></DIV>
<DIV style="position:absolute;top:826;left:600"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:600"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:634"><nobr><span class="ft4">for each peer p, encoding its pref-</span></nobr></DIV>
<DIV style="position:absolute;top:848;left:475"><nobr><span class="ft4">erences on candidate repairs of</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:675"><nobr><span class="ft4">D. Formally, w</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:775"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:853;left:775"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:848;left:811"><nobr><span class="ft4">is a</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:475"><nobr><span class="ft9">polynomially-computable function assigning, to each source<br>database instance</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:586"><nobr><span class="ft4">D, a natural number that is a measure of</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:475"><nobr><span class="ft9">the preference of p on having D as a repair for D (the lower<br>the number, the more preferred the repair).</span></nobr></DIV>
<DIV style="position:absolute;top:928;left:489"><nobr><span class="ft4">As a quite simple, yet natural example of weighting func-</span></nobr></DIV>
<DIV style="position:absolute;top:944;left:475"><nobr><span class="ft9">tion, we can consider the evaluation of the number of dele-<br>tions performed to the peer's sources.</span></nobr></DIV>
<DIV style="position:absolute;top:960;left:732"><nobr><span class="ft4">In this case, we</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:475"><nobr><span class="ft4">have that w</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:550"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:549"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:579"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:585"><nobr><span class="ft4">D ) = |D (p) - D(p)|, which in fact cor-</span></nobr></DIV>
<DIV style="position:absolute;top:994;left:475"><nobr><span class="ft4">responds to the size of the difference between</span></nobr></DIV>
<DIV style="position:absolute;top:991;left:772"><nobr><span class="ft4">D and D</span></nobr></DIV>
<DIV style="position:absolute;top:1010;left:475"><nobr><span class="ft9">restricted to tuples of peer p. This weighting function is<br>called cardinality-based in the following.</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:475"><nobr><span class="ft4">Example 1 (contd.) Consider the source databases</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:813"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1048;left:824"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1054;left:823"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:830"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:475"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:486"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:486"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:492"><nobr><span class="ft4">, and</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:525"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:536"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:536"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:546"><nobr><span class="ft4">such that:</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:610"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:621"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:620"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:627"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:640"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:646"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:670"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:681"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:680"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:687"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:699"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:705"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:729"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:740"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:740"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:746"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:759"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:765"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:789"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:800"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:806"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:818"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:825"><nobr><span class="ft4">),</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">39</span></nobr></DIV>
</DIV>
<!-- Page 5 -->
<a name="5"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft15{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
	.ft16{font-size:15px;line-height:20px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143005.png" alt="background image">
<DIV style="position:absolute;top:83;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:84;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:91"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:98"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:110"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:116"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:149"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:162"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:168"><nobr><span class="ft4">(John, Mary)}, D</span></nobr></DIV>
<DIV style="position:absolute;top:84;left:276"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:276"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:282"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:295"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:301"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:333"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:346"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:353"><nobr><span class="ft4">(Mary, Tom)},</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:91"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:98"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:110"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:116"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:143"><nobr><span class="ft4">{}, D</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:177"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:177"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:184"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:196"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:202"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:229"><nobr><span class="ft4">{}, D</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:263"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:263"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:270"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:282"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:288"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:315"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:328"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:334"><nobr><span class="ft4">(Mary, D1)}, and</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:91"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:98"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:120;left:110"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:116"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:140"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:120;left:154"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:160"><nobr><span class="ft4">(Mary, D1)}.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:94"><nobr><span class="ft4">Assume that, for each peer p, w</span></nobr></DIV>
<DIV style="position:absolute;top:130;left:302"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:302"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:314"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:320"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:333"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:339"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:344"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:130;left:349"><nobr><span class="ft4">D) = |D(p) -</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:98"><nobr><span class="ft4">(p)|, i.e., she prefers source repairs where the mini-</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:81"><nobr><span class="ft4">mum number of tuples is deleted from</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:346"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:357"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:364"><nobr><span class="ft4">(p).</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:404"><nobr><span class="ft4">Then,</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:91"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:97"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:91"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:104"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:110"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:122"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:128"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:133"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:179;left:138"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:149"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:149"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:156"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:174"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:197"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:207"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:213"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:207"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:220"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:226"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:238"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:244"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:249"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:179;left:254"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:265"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:265"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:272"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:289"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:313"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:323"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:329"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:323"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:336"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:341"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:354"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:360"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:365"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:179;left:370"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:381"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:381"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:388"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:405"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:429"><nobr><span class="ft4">0;</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:91"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:97"><nobr><span class="ft13">2</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:91"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:104"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:209;left:110"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:122"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:128"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:133"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:138"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:149"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:149"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:156"><nobr><span class="ft4">) = w</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:200"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:206"><nobr><span class="ft13">2</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:200"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:213"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:209;left:219"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:231"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:237"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:242"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:248"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:259"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:258"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:265"><nobr><span class="ft4">) = 1; w</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:330"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:335"><nobr><span class="ft13">2</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:329"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:342"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:209;left:348"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:361"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:366"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:372"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:377"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:388"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:388"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:394"><nobr><span class="ft4">) = 2;</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:91"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:97"><nobr><span class="ft13">3</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:91"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:104"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:110"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:122"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:128"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:133"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:138"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:149"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:149"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:156"><nobr><span class="ft4">) = 1; w</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:205"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:211"><nobr><span class="ft13">3</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:205"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:218"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:224"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:236"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:242"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:247"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:253"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:264"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:263"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:270"><nobr><span class="ft4">) = w</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:304"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:310"><nobr><span class="ft13">3</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:303"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:316"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:322"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:335"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:341"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:346"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:351"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:362"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:362"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:368"><nobr><span class="ft4">) = 0.</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:94"><nobr><span class="ft4">The problem of solving inconsistency in "classical" data</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:81"><nobr><span class="ft9">integration systems has been traditionally faced by pro-<br>viding a semantics in terms of the repairs of the global<br>databases that the mapping forces to be in the semantic<br>of the system [4, 7, 6]. Repairs are obtained by means of<br>addition and deletion of tuples according to some minimality<br>criterion.</span></nobr></DIV>
<DIV style="position:absolute;top:358;left:94"><nobr><span class="ft4">We next propose a generalization of these approaches to</span></nobr></DIV>
<DIV style="position:absolute;top:374;left:81"><nobr><span class="ft9">the P2P framework, which takes into account peers prefer-<br>ences. To this aim, we focus on finding the proper set of facts<br>at the sources that imply as a consequence a global database<br>satisfying all integrity constraints. Basically, such a way of<br>proceeding allows us to easily take into account information<br>on preferences when trying to solve inconsistency, since re-<br>pairing is performed by directly focusing on those sources,<br>whose integration has caused inconsistency.</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:81"><nobr><span class="ft4">Definition 5 (Repair) Let</span></nobr></DIV>
<DIV style="position:absolute;top:512;left:259"><nobr><span class="ft4">P be a P2P system, p a peer,</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:81"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:108"><nobr><span class="ft4">D and D two source databases. We say that D is p-</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:81"><nobr><span class="ft4">minimal if</span></nobr></DIV>
<DIV style="position:absolute;top:543;left:148"><nobr><span class="ft4">D |= P, and there exists no source database D</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:81"><nobr><span class="ft4">such that w</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:152"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:152"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:182"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:187"><nobr><span class="ft4">D ) &lt; w</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:240"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:240"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:270"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:275"><nobr><span class="ft4">D ) and D |= P.</span></nobr></DIV>
<DIV style="position:absolute;top:581;left:94"><nobr><span class="ft4">Then,</span></nobr></DIV>
<DIV style="position:absolute;top:578;left:134"><nobr><span class="ft4">D is a repair for P w.r.t. D if D is p-minimal for</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:81"><nobr><span class="ft4">each peer p.</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:623;left:81"><nobr><span class="ft4">Example 1 (contd.) It is easy to see that</span></nobr></DIV>
<DIV style="position:absolute;top:620;left:361"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:621;left:372"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:372"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:623;left:378"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:620;left:389"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:621;left:400"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:400"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:623;left:406"><nobr><span class="ft4">, and</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:91"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:639;left:103"><nobr><span class="ft4">satisfy</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:147"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:158"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:639;left:169"><nobr><span class="ft4">and they are both p</span></nobr></DIV>
<DIV style="position:absolute;top:641;left:292"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:639;left:298"><nobr><span class="ft4">-minimal. Indeed, peer</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:81"><nobr><span class="ft4">p</span></nobr></DIV>
<DIV style="position:absolute;top:657;left:88"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:102"><nobr><span class="ft4">has no preferences among the three databases, since</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:91"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:97"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:91"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:104"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:110"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:122"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:128"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:133"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:138"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:149"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:149"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:156"><nobr><span class="ft4">) = w</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:190"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:195"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:189"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:202"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:208"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:221"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:227"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:232"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:237"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:248"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:248"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:254"><nobr><span class="ft4">) = w</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:289"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:294"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:288"><nobr><span class="ft11">(P</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:301"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:307"><nobr><span class="ft11">,D</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:320"><nobr><span class="ft13">r</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:325"><nobr><span class="ft11">)</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:330"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:336"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:347"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:347"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:353"><nobr><span class="ft4">) = 0.</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:81"><nobr><span class="ft4">Moreover,</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:146"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:686;left:157"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:691;left:157"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:168"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:196"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:686;left:207"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:691;left:206"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:218"><nobr><span class="ft4">are equally preferred by p</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:376"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:383"><nobr><span class="ft4">, whereas</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:81"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:701;left:92"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:91"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:102"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:129"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:701;left:140"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:140"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:151"><nobr><span class="ft4">are equally preferred by p</span></nobr></DIV>
<DIV style="position:absolute;top:706;left:307"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:313"><nobr><span class="ft4">. Therefore, all peers</span></nobr></DIV>
<DIV style="position:absolute;top:720;left:81"><nobr><span class="ft4">agree on</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:136"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:717;left:147"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:147"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:720;left:154"><nobr><span class="ft4">, which is thus a repair for</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:320"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:717;left:331"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:720;left:342"><nobr><span class="ft4">w.r.t.</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:381"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:717;left:391"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:720;left:397"><nobr><span class="ft4">. How-</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:81"><nobr><span class="ft4">ever, neither</span></nobr></DIV>
<DIV style="position:absolute;top:732;left:163"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:174"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:739;left:174"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:186"><nobr><span class="ft4">is p</span></nobr></DIV>
<DIV style="position:absolute;top:738;left:208"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:214"><nobr><span class="ft4">-minimal, nor</span></nobr></DIV>
<DIV style="position:absolute;top:732;left:303"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:314"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:739;left:313"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:326"><nobr><span class="ft4">is p</span></nobr></DIV>
<DIV style="position:absolute;top:738;left:348"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:354"><nobr><span class="ft4">-minimal, and</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:81"><nobr><span class="ft4">thus they are not repairs.</span></nobr></DIV>
<DIV style="position:absolute;top:748;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:777;left:94"><nobr><span class="ft4">We next define the semantics of a P2P system, in terms</span></nobr></DIV>
<DIV style="position:absolute;top:793;left:81"><nobr><span class="ft4">of models for those sources on which all the peers agree.</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:81"><nobr><span class="ft4">Definition 6 (Agreement) Let</span></nobr></DIV>
<DIV style="position:absolute;top:822;left:289"><nobr><span class="ft4">P = P, I, N , map be a</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:81"><nobr><span class="ft4">P2P system, and</span></nobr></DIV>
<DIV style="position:absolute;top:837;left:186"><nobr><span class="ft4">D be an instance for P. The agreement for</span></nobr></DIV>
<DIV style="position:absolute;top:853;left:81"><nobr><span class="ft12">P w.r.t. D is the set of all of its models w.r.t. some repair,<br>and will be denoted by Agr (</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:253"><nobr><span class="ft4">P, D).</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:81"><nobr><span class="ft4">Example 1 (contd.)</span></nobr></DIV>
<DIV style="position:absolute;top:895;left:222"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:233"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:902;left:232"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:247"><nobr><span class="ft4">is p-minimal, for each peer p,</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:81"><nobr><span class="ft4">and it is easy to see that the set Agr (</span></nobr></DIV>
<DIV style="position:absolute;top:911;left:358"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:369"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:375"><nobr><span class="ft4">, D</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:392"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:399"><nobr><span class="ft4">) con-</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:81"><nobr><span class="ft4">tains all databases belonging to some model for</span></nobr></DIV>
<DIV style="position:absolute;top:927;left:422"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:928;left:433"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:81"><nobr><span class="ft4">w.r.t.</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:140"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:151"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:151"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:158"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:188"><nobr><span class="ft4">In particular,</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:289"><nobr><span class="ft4">it contains the super-</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:81"><nobr><span class="ft4">sets</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:115"><nobr><span class="ft4">(satisfying</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:189"><nobr><span class="ft4">the constraints)</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:304"><nobr><span class="ft4">of</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:327"><nobr><span class="ft4">the database</span></nobr></DIV>
<DIV style="position:absolute;top:958;left:424"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:433"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:965;left:433"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:81"><nobr><span class="ft4">such that</span></nobr></DIV>
<DIV style="position:absolute;top:974;left:150"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:159"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:159"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:166"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:178"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:184"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:974;left:222"><nobr><span class="ft4">{secretary (Albert, Bill)}, B</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:388"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:387"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:394"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:406"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:413"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:81"><nobr><span class="ft4">{financial(Mary, Tom)} and B</span></nobr></DIV>
<DIV style="position:absolute;top:990;left:270"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:996;left:270"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:277"><nobr><span class="ft4">(p</span></nobr></DIV>
<DIV style="position:absolute;top:995;left:289"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:295"><nobr><span class="ft4">) =</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:329"><nobr><span class="ft4">{boss(Albert, Bill),</span></nobr></DIV>
<DIV style="position:absolute;top:1009;left:81"><nobr><span class="ft9">boss (Mary, Tom), employee(Mary, D1)}. Moreover, no other<br>global database is in Agr (</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:238"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:248"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:255"><nobr><span class="ft4">, D</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:272"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:278"><nobr><span class="ft4">).</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:94"><nobr><span class="ft4">We can finally characterize the answer to a user query in</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:81"><nobr><span class="ft4">terms of the repairs for the system.</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft4">Definition 7 Let</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:589"><nobr><span class="ft4">P = P, I, N , map be a P2P system, let</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:475"><nobr><span class="ft15">D be a source database for it, and let Q be a query over<br>the schema of a peer p. Then, the answer to Q is the eval-<br>uation of the query over all the possible agreed databases:<br>ans(Q, p, P, D) =</span></nobr></DIV>
<DIV style="position:absolute;top:156;left:596"><nobr><span class="ft11">B Agr(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:151;left:666"><nobr><span class="ft4">Q</span></nobr></DIV>
<DIV style="position:absolute;top:145;left:677"><nobr><span class="ft11">B(p)</span></nobr></DIV>
<DIV style="position:absolute;top:156;left:677"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:151;left:699"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:489"><nobr><span class="ft4">For instance, in our running example, the answer to the</span></nobr></DIV>
<DIV style="position:absolute;top:195;left:475"><nobr><span class="ft4">user query</span></nobr></DIV>
<DIV style="position:absolute;top:192;left:543"><nobr><span class="ft4">{X | boss(X, Y )} posed over peer p</span></nobr></DIV>
<DIV style="position:absolute;top:197;left:755"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:195;left:761"><nobr><span class="ft4">, which asks</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:475"><nobr><span class="ft4">for all employees that have a boss, is</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:721"><nobr><span class="ft4">{ Albert , Mary },</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:475"><nobr><span class="ft9">since this query is evaluated over the supersets of the<br>database</span></nobr></DIV>
<DIV style="position:absolute;top:239;left:533"><nobr><span class="ft4">B</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:542"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:245;left:542"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:242;left:553"><nobr><span class="ft4">retrieved from</span></nobr></DIV>
<DIV style="position:absolute;top:239;left:643"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:654"><nobr><span class="ft11">r</span></nobr></DIV>
<DIV style="position:absolute;top:245;left:654"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:242;left:665"><nobr><span class="ft4">only.</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:489"><nobr><span class="ft4">We conclude the section by noticing that Agr (</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:762"><nobr><span class="ft4">P, D) is just</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:475"><nobr><span class="ft9">a formal characterization of the semantics of a P2P system.<br>Usually, we are not interested in computing such a set; and,<br>in fact, for practical applications, suitable techniques and<br>optimization algorithms should be investigated to handle<br>inconsistency at query time (in the spirit of, e.g., [10]).</span></nobr></DIV>
<DIV style="position:absolute;top:360;left:475"><nobr><span class="ft3"><b>4.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:360;left:515"><nobr><span class="ft3"><b>The Price of Autonomy</b></span></nobr></DIV>
<DIV style="position:absolute;top:383;left:489"><nobr><span class="ft4">Given the framework presented so far, we are in the po-</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:475"><nobr><span class="ft9">sition of studying the effects of having autonomous peers<br>repairing their source databases according to their own pref-<br>erences. We next show that, in some cases, peers might not<br>find an agreement on the way the repair has to be carried<br>out. This is a somehow expected consequence of having self-<br>ish interested peers in the absence of a global coordination.</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:475"><nobr><span class="ft4">Proposition 8</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:576"><nobr><span class="ft4">There exists a P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:506;left:742"><nobr><span class="ft4">P and a source</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:475"><nobr><span class="ft4">database</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:530"><nobr><span class="ft4">D such that there is no agreement, i.e., Agr(P , D)</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:475"><nobr><span class="ft4">is empty.</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:475"><nobr><span class="ft4">Proof</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:526"><nobr><span class="ft4">[Sketch].</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:617"><nobr><span class="ft4">Consider the P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:798"><nobr><span class="ft4">P =</span></nobr></DIV>
<DIV style="position:absolute;top:583;left:481"><nobr><span class="ft4">P , I , N , map , where P consists of the peers challenger</span></nobr></DIV>
<DIV style="position:absolute;top:599;left:475"><nobr><span class="ft9">(short: c) and duplicator (short: d), that are mutually con-<br>nected, i.e.,</span></nobr></DIV>
<DIV style="position:absolute;top:611;left:549"><nobr><span class="ft4">N (c) = {d} and N (d) = {c}.</span></nobr></DIV>
<DIV style="position:absolute;top:630;left:489"><nobr><span class="ft4">Peer c is such that I (c) = G</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:659"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:630;left:664"><nobr><span class="ft4">, S</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:680"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:630;left:686"><nobr><span class="ft4">, M</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:710"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:630;left:721"><nobr><span class="ft4">, where the schema</span></nobr></DIV>
<DIV style="position:absolute;top:643;left:475"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:652;left:483"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:646;left:493"><nobr><span class="ft4">consists of predicates r</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:628"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:646;left:633"><nobr><span class="ft4">(X) and mr</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:705"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:646;left:711"><nobr><span class="ft4">(X) with constraints</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:475"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:482"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:487"><nobr><span class="ft4">(X)  r</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:531"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:537"><nobr><span class="ft4">(Y )  X = Y and r</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:656"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:662"><nobr><span class="ft4">(X)  mr</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:718"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:724"><nobr><span class="ft4">(Y )  X = Y ; the</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:475"><nobr><span class="ft4">source schema consists of the relation symbol s</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:768"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:774"><nobr><span class="ft4">; and</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:812"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:828"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:693;left:475"><nobr><span class="ft4">contains only the assertion</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:641"><nobr><span class="ft4">{X | s</span></nobr></DIV>
<DIV style="position:absolute;top:698;left:679"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:693;left:685"><nobr><span class="ft4">(X)}</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:736"><nobr><span class="ft4">{X | r</span></nobr></DIV>
<DIV style="position:absolute;top:698;left:773"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:693;left:779"><nobr><span class="ft4">(X)}.</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:489"><nobr><span class="ft4">Peer d is such that I (d) = G</span></nobr></DIV>
<DIV style="position:absolute;top:715;left:659"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:665"><nobr><span class="ft4">, S</span></nobr></DIV>
<DIV style="position:absolute;top:715;left:681"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:687"><nobr><span class="ft4">, M</span></nobr></DIV>
<DIV style="position:absolute;top:715;left:710"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:722"><nobr><span class="ft4">, where the schema</span></nobr></DIV>
<DIV style="position:absolute;top:721;left:475"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:731;left:483"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:493"><nobr><span class="ft4">consists of predicates r</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:628"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:635"><nobr><span class="ft4">(X) and mr</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:705"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:711"><nobr><span class="ft4">(X) with constraints</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:475"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:482"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:488"><nobr><span class="ft4">(X)  r</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:531"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:537"><nobr><span class="ft4">(Y )  X = Y and r</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:657"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:663"><nobr><span class="ft4">(X)  mr</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:718"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:724"><nobr><span class="ft4">(Y )  X = Y ; the</span></nobr></DIV>
<DIV style="position:absolute;top:756;left:475"><nobr><span class="ft4">source schema consists of the relation symbol s</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:767"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:756;left:773"><nobr><span class="ft4">; and</span></nobr></DIV>
<DIV style="position:absolute;top:753;left:811"><nobr><span class="ft4">M</span></nobr></DIV>
<DIV style="position:absolute;top:762;left:827"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:475"><nobr><span class="ft4">contains only the assertion</span></nobr></DIV>
<DIV style="position:absolute;top:768;left:641"><nobr><span class="ft4">{X | s</span></nobr></DIV>
<DIV style="position:absolute;top:776;left:679"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:685"><nobr><span class="ft4">(X)}</span></nobr></DIV>
<DIV style="position:absolute;top:768;left:737"><nobr><span class="ft4">{X | r</span></nobr></DIV>
<DIV style="position:absolute;top:776;left:773"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:780"><nobr><span class="ft4">(X)}.</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:489"><nobr><span class="ft4">Finally, map(c) contains the assertion {X | r</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:772"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:778"><nobr><span class="ft4">(X))}</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:475"><nobr><span class="ft4">{X | mr</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:530"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:535"><nobr><span class="ft4">(X)}, while map(d) contains the assertion {X |</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:475"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:482"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:488"><nobr><span class="ft4">(X))}</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:545"><nobr><span class="ft4">{X | mr</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:594"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:601"><nobr><span class="ft4">(X)}.</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:489"><nobr><span class="ft4">Let</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:516"><nobr><span class="ft4">D be a source database for P such that D(c) =</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:475"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:855;left:489"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:494"><nobr><span class="ft4">(0), s</span></nobr></DIV>
<DIV style="position:absolute;top:855;left:525"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:530"><nobr><span class="ft4">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:548"><nobr><span class="ft4">} and D(d) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:855;left:661"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:667"><nobr><span class="ft4">(0), s</span></nobr></DIV>
<DIV style="position:absolute;top:855;left:698"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:704"><nobr><span class="ft4">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:722"><nobr><span class="ft4">}. We build four</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:475"><nobr><span class="ft4">source databases, say</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:619"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:630"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:636"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:648"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:659"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:665"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:678"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:689"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:703"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:733"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:743"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:750"><nobr><span class="ft4">, that satisfy</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:475"><nobr><span class="ft4">P. They are such that: D</span></nobr></DIV>
<DIV style="position:absolute;top:885;left:650"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:657"><nobr><span class="ft4">(c) = {}, D</span></nobr></DIV>
<DIV style="position:absolute;top:885;left:735"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:742"><nobr><span class="ft4">(d) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:886;left:799"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:806"><nobr><span class="ft4">(0)</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:823"><nobr><span class="ft4">};</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:475"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:486"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:492"><nobr><span class="ft4">(c) = {}, D</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:561"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:567"><nobr><span class="ft4">(d) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:902;left:618"><nobr><span class="ft11">d</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:624"><nobr><span class="ft4">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:642"><nobr><span class="ft4">}; D</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:668"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:674"><nobr><span class="ft4">(c) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:902;left:723"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:729"><nobr><span class="ft4">(0)</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:747"><nobr><span class="ft4">}, D</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:773"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:779"><nobr><span class="ft4">(d) = {};</span></nobr></DIV>
<DIV style="position:absolute;top:910;left:475"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:916;left:486"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:492"><nobr><span class="ft4">(c) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:918;left:547"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:553"><nobr><span class="ft4">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:910;left:571"><nobr><span class="ft4">}, D</span></nobr></DIV>
<DIV style="position:absolute;top:916;left:599"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:605"><nobr><span class="ft4">(d) = {}. Notice that all the other</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:475"><nobr><span class="ft4">databases satisfying</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:606"><nobr><span class="ft4">P are proper subsets of these ones.</span></nobr></DIV>
<DIV style="position:absolute;top:944;left:475"><nobr><span class="ft9">Then, by assuming that each peer wants to minimize the<br>number of deletions in</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:620"><nobr><span class="ft4">D, there exists no source database</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:475"><nobr><span class="ft4">satisfying</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:537"><nobr><span class="ft4">P that is both c-minimal and d-minimal.</span></nobr></DIV>
<DIV style="position:absolute;top:1007;left:475"><nobr><span class="ft3"><b>5.</b></span></nobr></DIV>
<DIV style="position:absolute;top:1007;left:506"><nobr><span class="ft16"><b>THE COMPLEXITY OF QUERY<br>ANSWERING</b></span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:489"><nobr><span class="ft4">In the light of Proposition 8, it is particulary relevant to</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:475"><nobr><span class="ft4">investigate the complexity of dealing with peer agreements</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">40</span></nobr></DIV>
</DIV>
<!-- Page 6 -->
<a name="6"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft17{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143006.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft9">and query answering in such P2P data integration systems.<br>In this section, we first present some basic problems arising<br>in the proposed framework, and subsequently analyze their<br>computational complexity. This analysis is a fundamental<br>premise to devise effective and optimized implementations.</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:81"><nobr><span class="ft3"><b>5.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:173;left:121"><nobr><span class="ft3"><b>Problems</b></span></nobr></DIV>
<DIV style="position:absolute;top:196;left:94"><nobr><span class="ft4">Given a P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:219"><nobr><span class="ft4">P and a source database D for P, we</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:81"><nobr><span class="ft4">consider the following problems:</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:101"><nobr><span class="ft4">· RepairChecking: given a source instance D , is D a</span></nobr></DIV>
<DIV style="position:absolute;top:252;left:114"><nobr><span class="ft4">repair for</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:175"><nobr><span class="ft4">P w.r.t. D?</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:101"><nobr><span class="ft17">· AgreementExistence: is Agr(P, D) = ?<br>· AnyAgreementComputation: compute a database B in</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:114"><nobr><span class="ft4">the agreement Agr (</span></nobr></DIV>
<DIV style="position:absolute;top:307;left:233"><nobr><span class="ft4">P, D), if any.</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:101"><nobr><span class="ft4">· QueryOutputTuple: given a query Q over a peer</span></nobr></DIV>
<DIV style="position:absolute;top:349;left:114"><nobr><span class="ft4">schema</span></nobr></DIV>
<DIV style="position:absolute;top:345;left:162"><nobr><span class="ft4">G</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:171"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:349;left:182"><nobr><span class="ft4">and a tuple t, is t  ans(Q, p, P, D)?</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:94"><nobr><span class="ft4">Intuitively,</span></nobr></DIV>
<DIV style="position:absolute;top:374;left:182"><nobr><span class="ft4">RepairChecking</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:299"><nobr><span class="ft4">is</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:327"><nobr><span class="ft4">the</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:365"><nobr><span class="ft4">very</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:409"><nobr><span class="ft4">basic</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:81"><nobr><span class="ft4">problem</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:143"><nobr><span class="ft4">of</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:167"><nobr><span class="ft4">assessing</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:233"><nobr><span class="ft4">whether</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:294"><nobr><span class="ft4">a</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:314"><nobr><span class="ft4">source</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:365"><nobr><span class="ft4">instance</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:427"><nobr><span class="ft4">at</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:81"><nobr><span class="ft4">hand</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:123"><nobr><span class="ft4">satisfies</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:181"><nobr><span class="ft4">the</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:213"><nobr><span class="ft4">data</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:252"><nobr><span class="ft4">integration</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:330"><nobr><span class="ft4">system.</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:404"><nobr><span class="ft4">Then,</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:81"><nobr><span class="ft12">AgreementExistence (and its corresponding computa-<br>tional version</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:168"><nobr><span class="ft4">AnyAgreementComputation) asks for singling</span></nobr></DIV>
<DIV style="position:absolute;top:455;left:81"><nobr><span class="ft9">out scenarios where some agrement can be in fact com-<br>puted. Finally,</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:180"><nobr><span class="ft4">QueryOutputTuple represents the problem</span></nobr></DIV>
<DIV style="position:absolute;top:487;left:81"><nobr><span class="ft9">characterizing the intrinsic complexity of a query answering<br>in the proposed framework; indeed, it is the problem of<br>deciding the membership of a given tuple in the result of<br>query evaluation.</span></nobr></DIV>
<DIV style="position:absolute;top:558;left:81"><nobr><span class="ft3"><b>5.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:558;left:121"><nobr><span class="ft3"><b>Results</b></span></nobr></DIV>
<DIV style="position:absolute;top:581;left:94"><nobr><span class="ft4">Our first result is that checking whether all the peers are</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:81"><nobr><span class="ft9">satisfied by a given source database is a difficult task that<br>is unlikely to be feasible in polynomial time.</span></nobr></DIV>
<DIV style="position:absolute;top:645;left:81"><nobr><span class="ft4">Theorem 9</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:163"><nobr><span class="ft4">RepairChecking is co-NP-complete. Hardness</span></nobr></DIV>
<DIV style="position:absolute;top:661;left:81"><nobr><span class="ft4">holds even for cardinality-based weighting functions.</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:81"><nobr><span class="ft4">Proof [Sketch].</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:199"><nobr><span class="ft4">Membership. Consider the complemen-</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:81"><nobr><span class="ft9">tary problem of deciding whether there exists a peer p<br>such that</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:146"><nobr><span class="ft4">D is not p-minimal. This problem is feasible</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:81"><nobr><span class="ft4">in NP by guessing a source database</span></nobr></DIV>
<DIV style="position:absolute;top:732;left:318"><nobr><span class="ft4">D and checking in</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:81"><nobr><span class="ft4">that 1.</span></nobr></DIV>
<DIV style="position:absolute;top:748;left:134"><nobr><span class="ft4">D |= P , and 2. there exists a peer p such that</span></nobr></DIV>
<DIV style="position:absolute;top:767;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:763;left:91"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:91"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:767;left:121"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:763;left:126"><nobr><span class="ft4">D ) &lt; w</span></nobr></DIV>
<DIV style="position:absolute;top:763;left:183"><nobr><span class="ft11">p</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:183"><nobr><span class="ft11">(P,D)</span></nobr></DIV>
<DIV style="position:absolute;top:767;left:213"><nobr><span class="ft4">(</span></nobr></DIV>
<DIV style="position:absolute;top:763;left:219"><nobr><span class="ft4">D ). In particular, 1. is feasible in</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:81"><nobr><span class="ft9">polynomial time because of Theorem 4, and 2. is feasible in<br>polynomial time because our weighting functions are poly-<br>nomially computable.</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:94"><nobr><span class="ft4">Hardness. Recall that deciding whether a Boolean for-</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:81"><nobr><span class="ft4">mula in conjunctive normal form  = C</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:319"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:327"><nobr><span class="ft4"> . . .  C</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:377"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:391"><nobr><span class="ft4">over the</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:81"><nobr><span class="ft4">variables X</span></nobr></DIV>
<DIV style="position:absolute;top:865;left:149"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:155"><nobr><span class="ft4">, . . . , X</span></nobr></DIV>
<DIV style="position:absolute;top:867;left:197"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:208"><nobr><span class="ft4">is not satisfiable, i.e., deciding whether</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:81"><nobr><span class="ft9">there exists no truth assignments to the variables making<br>each clause C</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:163"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:173"><nobr><span class="ft4">true, is a co-NP-hard problem.</span></nobr></DIV>
<DIV style="position:absolute;top:910;left:94"><nobr><span class="ft4">We built a P2P system</span></nobr></DIV>
<DIV style="position:absolute;top:906;left:237"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:248"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:910;left:260"><nobr><span class="ft4">such that:</span></nobr></DIV>
<DIV style="position:absolute;top:906;left:326"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:337"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:910;left:349"><nobr><span class="ft4">contains a peer</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:81"><nobr><span class="ft4">x</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:89"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:99"><nobr><span class="ft4">for each variable X</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:218"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:223"><nobr><span class="ft4">, a peer c</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:283"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:295"><nobr><span class="ft4">for each clause C</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:401"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:407"><nobr><span class="ft4">, and</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:81"><nobr><span class="ft4">the distinguished peer e. The source schema of x</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:374"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:382"><nobr><span class="ft4">(resp. c</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:428"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:434"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:81"><nobr><span class="ft4">consists of the unary relation s</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:273"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:280"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:291"><nobr><span class="ft4">(resp. s</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:340"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:345"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:352"><nobr><span class="ft4">), whereas the</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:81"><nobr><span class="ft4">global schema consists of the unary relation r</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:356"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:978;left:363"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:373"><nobr><span class="ft4">(resp. r</span></nobr></DIV>
<DIV style="position:absolute;top:977;left:419"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:978;left:424"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:430"><nobr><span class="ft4">).</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:81"><nobr><span class="ft4">The source schema of e consists of the unary relations s</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:408"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:417"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:81"><nobr><span class="ft4">s</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:87"><nobr><span class="ft11">a</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:94"><nobr><span class="ft4">, whereas its global schema consists of the unary relations</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:81"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:87"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:98"><nobr><span class="ft4">and r</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:132"><nobr><span class="ft11">a</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:139"><nobr><span class="ft4">. For each source relation, say s , P() contains</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:81"><nobr><span class="ft4">a local mapping assertion of the form</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:314"><nobr><span class="ft4">{X | s (X)}</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:412"><nobr><span class="ft4">{X |</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:81"><nobr><span class="ft4">r (X)}. Each global relation of the form r</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:351"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:358"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:369"><nobr><span class="ft4">is equipped</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:81"><nobr><span class="ft4">with the constraint r</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:209"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:1072;left:216"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:221"><nobr><span class="ft4">(X</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:238"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:244"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:253"><nobr><span class="ft4"> r</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:272"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:1072;left:278"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:284"><nobr><span class="ft4">(X</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:300"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:307"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:317"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:344"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:355"><nobr><span class="ft4">= X</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:382"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:389"><nobr><span class="ft4">, stating</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft9">that each relation must contain one atom at most. Each<br>global relation of the form r</span></nobr></DIV>
<DIV style="position:absolute;top:107;left:655"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:108;left:660"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:672"><nobr><span class="ft4">is equipped with the con-</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:475"><nobr><span class="ft4">straint r</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:527"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:532"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:538"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:557"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:561"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:571"><nobr><span class="ft4"> r</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:590"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:595"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:601"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:623"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:627"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:639"><nobr><span class="ft4">, where  is the empty dis-</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:475"><nobr><span class="ft4">junction, stating that for each variable x</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:726"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:730"><nobr><span class="ft4">, r</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:746"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:751"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:762"><nobr><span class="ft4">cannot con-</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:475"><nobr><span class="ft4">tain both tx</span></nobr></DIV>
<DIV style="position:absolute;top:154;left:551"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:561"><nobr><span class="ft4">and fx</span></nobr></DIV>
<DIV style="position:absolute;top:154;left:604"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:614"><nobr><span class="ft4">at the same time. Moreover, peer e</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:475"><nobr><span class="ft4">has also the constraint r</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:623"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:629"><nobr><span class="ft4">(X</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:645"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:652"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:660"><nobr><span class="ft4"> r</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:679"><nobr><span class="ft11">a</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:685"><nobr><span class="ft4">(X</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:702"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:708"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:718"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:744"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:754"><nobr><span class="ft4">= X</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:780"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:786"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:489"><nobr><span class="ft4">Consider the source database</span></nobr></DIV>
<DIV style="position:absolute;top:177;left:687"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:698"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:180;left:716"><nobr><span class="ft4">for</span></nobr></DIV>
<DIV style="position:absolute;top:177;left:741"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:752"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:180;left:769"><nobr><span class="ft4">such that:</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:475"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:191;left:486"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:196;left:495"><nobr><span class="ft4">(x</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:508"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:513"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:532"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:557"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:570"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:576"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:582"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:600"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:604"><nobr><span class="ft4">), s</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:622"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:629"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:634"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:656"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:660"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:666"><nobr><span class="ft4">}; for each x</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:762"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:777"><nobr><span class="ft4">occurring</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:475"><nobr><span class="ft4">in c</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:503"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:509"><nobr><span class="ft4">,</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:525"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:207;left:536"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:212;left:545"><nobr><span class="ft4">(c</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:556"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:562"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:582"><nobr><span class="ft4">=</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:606"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:620"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:218;left:625"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:631"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:649"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:654"><nobr><span class="ft4">), s</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:672"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:218;left:677"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:683"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:705"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:709"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:715"><nobr><span class="ft4">}; and D</span></nobr></DIV>
<DIV style="position:absolute;top:207;left:783"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:212;left:792"><nobr><span class="ft4">(e) =</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:475"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:489"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:495"><nobr><span class="ft4">(t), s</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:523"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:529"><nobr><span class="ft4">(f), s</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:561"><nobr><span class="ft11">a</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:567"><nobr><span class="ft4">(t)}. Notice that due to the constraints is-</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:475"><nobr><span class="ft4">sued over peers schemas, any source database</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:779"><nobr><span class="ft4">D , with</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:475"><nobr><span class="ft4">D |= P</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:526"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:259;left:535"><nobr><span class="ft4">, is such that</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:625"><nobr><span class="ft4">|D (x</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:657"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:662"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:255;left:667"><nobr><span class="ft4">|  1, for each x</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:775"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:779"><nobr><span class="ft4">. There-</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:475"><nobr><span class="ft4">fore, the restriction of</span></nobr></DIV>
<DIV style="position:absolute;top:271;left:616"><nobr><span class="ft4">D to the peers of the form x</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:798"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:808"><nobr><span class="ft4">is in</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:475"><nobr><span class="ft9">one-to-one correspondence with a truth-value assignment for<br>, denoted by µ(D ). Intuitively, the atom s</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:754"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:761"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:306;left:766"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:784"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:306;left:789"><nobr><span class="ft4">) (resp.</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:475"><nobr><span class="ft4">s</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:482"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:488"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:493"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:515"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:519"><nobr><span class="ft4">)) means that variable X</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:669"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:678"><nobr><span class="ft4">is set to true (resp. false),</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:475"><nobr><span class="ft4">whereas the atom s</span></nobr></DIV>
<DIV style="position:absolute;top:342;left:592"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:343;left:597"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:604"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:342;left:622"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:627"><nobr><span class="ft4">) means that the clause C</span></nobr></DIV>
<DIV style="position:absolute;top:342;left:782"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:792"><nobr><span class="ft4">is true,</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:475"><nobr><span class="ft4">witnessed by the assignment for the variable X</span></nobr></DIV>
<DIV style="position:absolute;top:358;left:767"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:777"><nobr><span class="ft4">occurring</span></nobr></DIV>
<DIV style="position:absolute;top:369;left:475"><nobr><span class="ft4">in c</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:497"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:369;left:503"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:385;left:489"><nobr><span class="ft4">Finally, the peers mapping assertions in</span></nobr></DIV>
<DIV style="position:absolute;top:381;left:760"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:771"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:385;left:788"><nobr><span class="ft4">are de-</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:475"><nobr><span class="ft4">fined as follows.</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:596"><nobr><span class="ft4">For each variable X</span></nobr></DIV>
<DIV style="position:absolute;top:405;left:727"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:740"><nobr><span class="ft4">occurring posi-</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:475"><nobr><span class="ft4">tively (resp.</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:565"><nobr><span class="ft4">negatively) in the clause C</span></nobr></DIV>
<DIV style="position:absolute;top:420;left:738"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:752"><nobr><span class="ft4">there are ex-</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:475"><nobr><span class="ft4">actly two mappings of the form</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:666"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:680"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:686"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:691"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:710"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:714"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:719"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:748"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:761"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:766"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:772"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:791"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:795"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:801"><nobr><span class="ft4">} and</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:475"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:488"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:495"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:500"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:521"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:526"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:532"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:567"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:580"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:585"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:591"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:613"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:617"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:623"><nobr><span class="ft4">} (resp. {r</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:696"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:702"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:707"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:729"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:734"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:739"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:774"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:787"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:792"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:799"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:817"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:822"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:827"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:475"><nobr><span class="ft4">and</span></nobr></DIV>
<DIV style="position:absolute;top:459;left:505"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:518"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:524"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:529"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:548"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:552"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:459;left:558"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:459;left:594"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:607"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:612"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:618"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:640"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:645"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:459;left:650"><nobr><span class="ft4">}); moreover, for each clause</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:475"><nobr><span class="ft4">C</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:485"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:495"><nobr><span class="ft4">containing variables X</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:631"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:635"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:642"><nobr><span class="ft4">, ..., X</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:677"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:485;left:682"><nobr><span class="ft13">k</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:689"><nobr><span class="ft4">, there exists a mapping</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:475"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:488"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:500;left:493"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:500"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:521"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:500;left:526"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:532"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:541"><nobr><span class="ft4"> · · ·  r</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:591"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:500;left:596"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:602"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:624"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:500;left:628"><nobr><span class="ft13">k</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:635"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:641"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:669"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:682"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:688"><nobr><span class="ft4">(f)}.</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:489"><nobr><span class="ft4">Figure 2 shows on the upper part the dependency graph</span></nobr></DIV>
<DIV style="position:absolute;top:526;left:475"><nobr><span class="ft4">G(</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:491"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:502"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:526;left:511"><nobr><span class="ft4">) for the formula  = (X</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:662"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:671"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:695"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:526;left:701"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:709"><nobr><span class="ft4"> (X</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:739"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:526;left:745"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:753"><nobr><span class="ft4"> (X</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:782"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:792"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:815"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:825"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:538;left:475"><nobr><span class="ft4">¬X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:496"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:502"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:510"><nobr><span class="ft4"> (X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:540"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:546"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:554"><nobr><span class="ft4"> (¬X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:593"><nobr><span class="ft11">5</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:602"><nobr><span class="ft4"> ¬X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:635"><nobr><span class="ft11">6</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:644"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:668"><nobr><span class="ft11">7</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:674"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:683"><nobr><span class="ft4"> (X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:712"><nobr><span class="ft11">4</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:721"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:744"><nobr><span class="ft11">6</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:754"><nobr><span class="ft4"> X</span></nobr></DIV>
<DIV style="position:absolute;top:544;left:777"><nobr><span class="ft11">8</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:784"><nobr><span class="ft4">).</span></nobr></DIV>
<DIV style="position:absolute;top:557;left:489"><nobr><span class="ft4">Assume that each peer wants to minimize the number of</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:475"><nobr><span class="ft4">deletions in</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:552"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:563"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:573;left:572"><nobr><span class="ft4">. Then, given a source database</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:781"><nobr><span class="ft4">D mini-</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:475"><nobr><span class="ft4">mal w.r.t. each peer in</span></nobr></DIV>
<DIV style="position:absolute;top:585;left:629"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:640"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:588;left:655"><nobr><span class="ft4">but e, we can show that the</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:475"><nobr><span class="ft9">above mappings encode an evaluation of the assignment<br>µ(D ). In particular, it is easy to see that µ(D ) is a satisfy-<br>ing assignment for  if and only if</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:690"><nobr><span class="ft4">D (e) contains the facts</span></nobr></DIV>
<DIV style="position:absolute;top:648;left:475"><nobr><span class="ft4">{s</span></nobr></DIV>
<DIV style="position:absolute;top:656;left:489"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:495"><nobr><span class="ft4">(t), s</span></nobr></DIV>
<DIV style="position:absolute;top:656;left:523"><nobr><span class="ft11">a</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:530"><nobr><span class="ft4">(t)}, i.e., one fact is deleted from the source of e</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:475"><nobr><span class="ft4">only. Assume, now, that</span></nobr></DIV>
<DIV style="position:absolute;top:664;left:633"><nobr><span class="ft4">D is such that D (e) = {s</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:798"><nobr><span class="ft11">e</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:804"><nobr><span class="ft4">(f)},</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:475"><nobr><span class="ft9">i.e., two facts are deleted from the source of e. Then, D is<br>also e-minimal if and only if  is not satisfiable.</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:489"><nobr><span class="ft4">Given the above complexity result, one can easily see that</span></nobr></DIV>
<DIV style="position:absolute;top:726;left:475"><nobr><span class="ft12">AnyAgreementComputation is feasible in the functional ver-<br>sion of </span></nobr></DIV>
<DIV style="position:absolute;top:743;left:531"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:749;left:531"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:540"><nobr><span class="ft4">. Indeed, we can guess in NP a source instance</span></nobr></DIV>
<DIV style="position:absolute;top:758;left:475"><nobr><span class="ft12">D, build in polynomial time a model B for P w.r.t. D (by<br>construction in Theorem 4), and check in co-NP that</span></nobr></DIV>
<DIV style="position:absolute;top:773;left:808"><nobr><span class="ft4">D is</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:475"><nobr><span class="ft4">minimal for each peer.</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:489"><nobr><span class="ft4">Actually, we can do much better. In fact, we next show</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:475"><nobr><span class="ft9">that the problem is complete for the polynomial time closure<br>of NP, and thus remains at the first level of the polynomial<br>hierarchy.</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:475"><nobr><span class="ft4">Theorem 10</span></nobr></DIV>
<DIV style="position:absolute;top:879;left:565"><nobr><span class="ft4">AnyAgreementComputation</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:754"><nobr><span class="ft4">is</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:790"><nobr><span class="ft4">FPNP-</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:475"><nobr><span class="ft4">complete.</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:558"><nobr><span class="ft4">Hardness</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:625"><nobr><span class="ft4">holds even for cardinality-based</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:475"><nobr><span class="ft4">weighting functions.</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:475"><nobr><span class="ft9">Proof [Sketch]. Membership. The problem can be solved<br>by processing peers in a sequential manner. For each peer in<br>P, we can find the minimum value of the associated prefer-<br>ence function by means of a binary search, in which at each<br>step we guess in NP a database instance and verify that<br>such a preference holds. After having collected the mini-<br>mum values for all peers, we conclude with a final guess to<br>get a repair</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:552"><nobr><span class="ft4">D, and a subsequent check that actually each</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:475"><nobr><span class="ft4">peer gets its minimum possible value for</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:724"><nobr><span class="ft4">P w.r.t. D.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">41</span></nobr></DIV>
</DIV>
<!-- Page 7 -->
<a name="7"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft18{font-size:6px;line-height:10px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="143007.png" alt="background image">
<DIV style="position:absolute;top:484;left:81"><nobr><span class="ft9">Figure 2: Constructions in Proofs of Complexity Re-<br>sults.</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:94"><nobr><span class="ft4">Finally, a model for</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:214"><nobr><span class="ft4">P w.r.t. D can be build in polynomial</span></nobr></DIV>
<DIV style="position:absolute;top:557;left:81"><nobr><span class="ft4">time (again, by construction in Theorem 4).</span></nobr></DIV>
<DIV style="position:absolute;top:572;left:94"><nobr><span class="ft4">Hardness. Let  be a boolean formula in conjunctive nor-</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:81"><nobr><span class="ft4">mal form  = C</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:179"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:585;left:188"><nobr><span class="ft4"> . . .  C</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:242"><nobr><span class="ft11">m</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:257"><nobr><span class="ft4">over the variables X</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:379"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:386"><nobr><span class="ft4">, . . . , X</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:428"><nobr><span class="ft11">n</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:436"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:81"><nobr><span class="ft4">Assume that each clause, say C</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:271"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:276"><nobr><span class="ft4">, is equipped with a weight</span></nobr></DIV>
<DIV style="position:absolute;top:616;left:81"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:624;left:88"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:619;left:102"><nobr><span class="ft4">(natural number).</span></nobr></DIV>
<DIV style="position:absolute;top:619;left:231"><nobr><span class="ft4">Let  be an assignment for the</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:81"><nobr><span class="ft4">variables in .</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:187"><nobr><span class="ft4">Its weight is the sum of the weights of</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:81"><nobr><span class="ft4">all the clauses satisfied in .</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:282"><nobr><span class="ft4">The problem of comput-</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:81"><nobr><span class="ft9">ing the maximum weight over any truth assignment, called<br>MAX - WEIGHT - SAT, is FPNP-complete.</span></nobr></DIV>
<DIV style="position:absolute;top:701;left:94"><nobr><span class="ft4">Consider again the construction in Theorem 9, and mod-</span></nobr></DIV>
<DIV style="position:absolute;top:717;left:81"><nobr><span class="ft4">ify</span></nobr></DIV>
<DIV style="position:absolute;top:713;left:104"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:712;left:115"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:717;left:132"><nobr><span class="ft4">as follows.</span></nobr></DIV>
<DIV style="position:absolute;top:717;left:215"><nobr><span class="ft4">The source schema of peer e con-</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:81"><nobr><span class="ft4">sists of the relation s</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:220"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:229"><nobr><span class="ft4">, whereas its global schema con-</span></nobr></DIV>
<DIV style="position:absolute;top:748;left:81"><nobr><span class="ft4">sists of the relations r</span></nobr></DIV>
<DIV style="position:absolute;top:753;left:228"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:748;left:245"><nobr><span class="ft4">and r</span></nobr></DIV>
<DIV style="position:absolute;top:753;left:282"><nobr><span class="ft11">v</span></nobr></DIV>
<DIV style="position:absolute;top:748;left:288"><nobr><span class="ft4">, and of the constraint</span></nobr></DIV>
<DIV style="position:absolute;top:764;left:81"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:769;left:87"><nobr><span class="ft11">v</span></nobr></DIV>
<DIV style="position:absolute;top:764;left:94"><nobr><span class="ft4">(X)  r</span></nobr></DIV>
<DIV style="position:absolute;top:769;left:139"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:764;left:148"><nobr><span class="ft4">(X, Y ) . The local mappings of e is {X, Y |</span></nobr></DIV>
<DIV style="position:absolute;top:780;left:81"><nobr><span class="ft4">s</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:87"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:780;left:96"><nobr><span class="ft4">(X, Y )}</span></nobr></DIV>
<DIV style="position:absolute;top:776;left:165"><nobr><span class="ft4">{X, Y | r</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:219"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:780;left:228"><nobr><span class="ft4">(X, Y )}. Moreover, for each clause</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:81"><nobr><span class="ft4">c</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:87"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:97"><nobr><span class="ft4">over variables X</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:195"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:801;left:199"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:206"><nobr><span class="ft4">, ..., X</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:241"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:801;left:245"><nobr><span class="ft13">k</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:253"><nobr><span class="ft4">, map(e) contains the assertion</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:81"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:94"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:817;left:99"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:105"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:127"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:131"><nobr><span class="ft13">1</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:138"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:146"><nobr><span class="ft4"> · · ·  r</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:197"><nobr><span class="ft11">c</span></nobr></DIV>
<DIV style="position:absolute;top:817;left:202"><nobr><span class="ft13">j</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:208"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:230"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:817;left:234"><nobr><span class="ft13">k</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:242"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:247"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:276"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:289"><nobr><span class="ft11">v</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:296"><nobr><span class="ft4">(fc</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:316"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:321"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:327"><nobr><span class="ft4">}. Let ¯</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:370"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:806;left:380"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:811;left:394"><nobr><span class="ft4">be such</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:81"><nobr><span class="ft4">a modified P2P system. Notice that G( ¯</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:324"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:335"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:829;left:343"><nobr><span class="ft4">) coincides with</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:81"><nobr><span class="ft4">G(</span></nobr></DIV>
<DIV style="position:absolute;top:842;left:97"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:108"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:845;left:116"><nobr><span class="ft4">) (see again Figure 2).</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:94"><nobr><span class="ft4">Consider now the database instance ¯</span></nobr></DIV>
<DIV style="position:absolute;top:857;left:317"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:856;left:328"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:861;left:342"><nobr><span class="ft4">for ¯</span></nobr></DIV>
<DIV style="position:absolute;top:857;left:363"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:856;left:374"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:861;left:387"><nobr><span class="ft4">obtained</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:81"><nobr><span class="ft4">by modifying</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:173"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:871;left:184"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:876;left:202"><nobr><span class="ft4">such that ¯</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:271"><nobr><span class="ft4">D</span></nobr></DIV>
<DIV style="position:absolute;top:871;left:282"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:876;left:291"><nobr><span class="ft4">(e) contains the atoms</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:81"><nobr><span class="ft4">s</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:87"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:96"><nobr><span class="ft4">(fc</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:116"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:122"><nobr><span class="ft4">, 1), s</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:154"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:163"><nobr><span class="ft4">(fc</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:183"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:189"><nobr><span class="ft4">, 2), ...s</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:233"><nobr><span class="ft11">w</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:242"><nobr><span class="ft4">(fc</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:262"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:268"><nobr><span class="ft4">, w</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:281"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:287"><nobr><span class="ft4">) for each clause c</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:394"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:400"><nobr><span class="ft4">. Intu-</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:81"><nobr><span class="ft4">itively, peer e stores w</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:213"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:224"><nobr><span class="ft4">distinct atoms for each clause c</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:413"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:419"><nobr><span class="ft4">.</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:94"><nobr><span class="ft4">Let</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:118"><nobr><span class="ft4">D be a source instance that satisfies ¯</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:346"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:919;left:357"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:923;left:365"><nobr><span class="ft4">. As in The-</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:81"><nobr><span class="ft4">orem 9, the restriction of</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:235"><nobr><span class="ft4">D over the variables is in one-to-</span></nobr></DIV>
<DIV style="position:absolute;top:955;left:81"><nobr><span class="ft9">one correspondence with a truth assignment for , denoted<br>by µ(D ). Then, it is easy to see that peer e must delete<br>in</span></nobr></DIV>
<DIV style="position:absolute;top:983;left:98"><nobr><span class="ft4">D all the w</span></nobr></DIV>
<DIV style="position:absolute;top:991;left:176"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:986;left:188"><nobr><span class="ft4">distinct atoms corresponding to a clause</span></nobr></DIV>
<DIV style="position:absolute;top:1002;left:81"><nobr><span class="ft4">C</span></nobr></DIV>
<DIV style="position:absolute;top:1006;left:91"><nobr><span class="ft11">j</span></nobr></DIV>
<DIV style="position:absolute;top:1002;left:102"><nobr><span class="ft4">that is not satisfied by the assignment µ(D ). There-</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:81"><nobr><span class="ft4">fore,</span></nobr></DIV>
<DIV style="position:absolute;top:1014;left:113"><nobr><span class="ft4">|D (e)| =</span></nobr></DIV>
<DIV style="position:absolute;top:1025;left:192"><nobr><span class="ft11">i|C</span></nobr></DIV>
<DIV style="position:absolute;top:1026;left:205"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:215"><nobr><span class="ft4">is false in</span></nobr></DIV>
<DIV style="position:absolute;top:1025;left:276"><nobr><span class="ft11">µ(D )</span></nobr></DIV>
<DIV style="position:absolute;top:1014;left:311"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:318"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:322"><nobr><span class="ft4">. Hence, the result</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:81"><nobr><span class="ft9">easily follows, since computing the source instance that is e-<br>minimal, say</span></nobr></DIV>
<DIV style="position:absolute;top:1047;left:163"><nobr><span class="ft4">D, determines the maximum weight over any</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:81"><nobr><span class="ft4">assignment for  as (</span></nobr></DIV>
<DIV style="position:absolute;top:1074;left:225"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:232"><nobr><span class="ft4">w</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:239"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:243"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:252"><nobr><span class="ft4">- |D(e)|.</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:429"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:489"><nobr><span class="ft4">We next focus on the</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:616"><nobr><span class="ft4">AgreementExistence problem. Note</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:475"><nobr><span class="ft4">that membership of this problem in </span></nobr></DIV>
<DIV style="position:absolute;top:97;left:712"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:712"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:726"><nobr><span class="ft4">is easy to proven,</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:475"><nobr><span class="ft9">after the above theorem. However, the reduction for the<br>hardness part we shall exploit here is rather different.</span></nobr></DIV>
<DIV style="position:absolute;top:171;left:475"><nobr><span class="ft4">Theorem 11</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:565"><nobr><span class="ft4">AgreementExistence is </span></nobr></DIV>
<DIV style="position:absolute;top:166;left:724"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:724"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:171;left:732"><nobr><span class="ft4">-complete. Hard-</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:475"><nobr><span class="ft4">ness holds even for cardinality-based weighting functions.</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:475"><nobr><span class="ft14">Proof [Sketch]. Membership is shown with the same line<br>of reasoning of Theorem 10. For the hardness, consider again<br>MAX - WEIGHT - SAT, and the </span></nobr></DIV>
<DIV style="position:absolute;top:245;left:658"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:658"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:667"><nobr><span class="ft4">-complete problem of decid-</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:475"><nobr><span class="ft4">ing whether it has a unique solution.</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:489"><nobr><span class="ft4">Let ¯</span></nobr></DIV>
<DIV style="position:absolute;top:276;left:514"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:525"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:279;left:538"><nobr><span class="ft4">be the P2P system built in Theorem 10, and let</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:478"><nobr><span class="ft4">¯</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:475"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:490"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:297;left:505"><nobr><span class="ft4">be a copy of it, obtained by replacing each element</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:475"><nobr><span class="ft4">(both relations and peers) r in ¯</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:660"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:308;left:671"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:313;left:683"><nobr><span class="ft4">by r . Then, consider the</span></nobr></DIV>
<DIV style="position:absolute;top:331;left:475"><nobr><span class="ft4">system ~</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:522"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:533"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:331;left:548"><nobr><span class="ft4">obtained as the union of ¯</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:706"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:716"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:331;left:725"><nobr><span class="ft4">, ¯</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:735"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:750"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:331;left:764"><nobr><span class="ft4">and a fresh</span></nobr></DIV>
<DIV style="position:absolute;top:349;left:475"><nobr><span class="ft4">peer u. Figure 2 shows the dependency graph G( ~</span></nobr></DIV>
<DIV style="position:absolute;top:345;left:773"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:788"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:349;left:796"><nobr><span class="ft4">).</span></nobr></DIV>
<DIV style="position:absolute;top:365;left:489"><nobr><span class="ft4">The local schema of u is empty, while its global schema</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:475"><nobr><span class="ft4">consists of the unary relation r</span></nobr></DIV>
<DIV style="position:absolute;top:385;left:690"><nobr><span class="ft11">u</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:707"><nobr><span class="ft4">with the constraint</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:487"><nobr><span class="ft18">n<br>i=1</span></nobr></DIV>
<DIV style="position:absolute;top:396;left:508"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:514"><nobr><span class="ft11">u</span></nobr></DIV>
<DIV style="position:absolute;top:396;left:521"><nobr><span class="ft4">(bad</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:547"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:396;left:552"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:562"><nobr><span class="ft4">. The mapping assertions are as follows.</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:475"><nobr><span class="ft4">For each variable X</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:603"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:616"><nobr><span class="ft4">in , map(u) contains {r</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:780"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:786"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:791"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:416;left:810"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:814"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:825"><nobr><span class="ft4"></span></nobr></DIV>
<DIV style="position:absolute;top:427;left:475"><nobr><span class="ft4">r</span></nobr></DIV>
<DIV style="position:absolute;top:433;left:486"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:492"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:498"><nobr><span class="ft4">(tx</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:516"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:521"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:526"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:568"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:581"><nobr><span class="ft11">u</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:589"><nobr><span class="ft4">(bad</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:615"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:619"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:625"><nobr><span class="ft4">} and {r</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:684"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:433;left:691"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:696"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:717"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:722"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:733"><nobr><span class="ft4"> r</span></nobr></DIV>
<DIV style="position:absolute;top:433;left:759"><nobr><span class="ft11">x</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:766"><nobr><span class="ft13">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:771"><nobr><span class="ft4">(fx</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:792"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:797"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:802"><nobr><span class="ft4">}</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:475"><nobr><span class="ft4">{r</span></nobr></DIV>
<DIV style="position:absolute;top:450;left:488"><nobr><span class="ft11">u</span></nobr></DIV>
<DIV style="position:absolute;top:445;left:496"><nobr><span class="ft4">(bad</span></nobr></DIV>
<DIV style="position:absolute;top:450;left:522"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:445;left:526"><nobr><span class="ft4">)</span></nobr></DIV>
<DIV style="position:absolute;top:442;left:532"><nobr><span class="ft4">}. It is worthwhile noting that, for the sake of</span></nobr></DIV>
<DIV style="position:absolute;top:461;left:475"><nobr><span class="ft9">simplicity, the mapping assertions are slightly more general<br>than those allowed in the usual definition of P2P systems,<br>since they involve joins among different peers. However, this<br>is only a syntactical facility, as such a mapping can be easily<br>simulated by introducing a suitable dummy peer.</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:489"><nobr><span class="ft4">The idea of the reduction is that, if the same assignment</span></nobr></DIV>
<DIV style="position:absolute;top:555;left:475"><nobr><span class="ft15">that maximizes the weight of the satisfied clauses is selected<br>for both ¯</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:528"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:539"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:573;left:551"><nobr><span class="ft4">and ¯</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:578"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:592"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:573;left:601"><nobr><span class="ft4">, then r</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:646"><nobr><span class="ft11">u</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:653"><nobr><span class="ft4">(bad</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:679"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:684"><nobr><span class="ft4">) is pushed to u (for each</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:475"><nobr><span class="ft15">i), thereby violating the constraint. Thus, there is a (non-<br>empty) agreement in ~</span></nobr></DIV>
<DIV style="position:absolute;top:602;left:604"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:601;left:615"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:606;left:627"><nobr><span class="ft4">if and only if there are at least two</span></nobr></DIV>
<DIV style="position:absolute;top:621;left:475"><nobr><span class="ft4">such assignments.</span></nobr></DIV>
<DIV style="position:absolute;top:618;left:824"><nobr><span class="ft4">P</span></nobr></DIV>
<DIV style="position:absolute;top:641;left:489"><nobr><span class="ft4">We conclude our investigation by observing that query</span></nobr></DIV>
<DIV style="position:absolute;top:657;left:475"><nobr><span class="ft4">answering is at least as hard as</span></nobr></DIV>
<DIV style="position:absolute;top:654;left:676"><nobr><span class="ft4">AgreementExistence. In-</span></nobr></DIV>
<DIV style="position:absolute;top:673;left:475"><nobr><span class="ft9">deed, intuitively, if peers are not able to find an agreement<br>in an inconsistent P2P system, then the answer to any given<br>query will be empty. Moreover, membership can be proven<br>by the same line of reasoning of Theorem 10, and we thus<br>get the following result.</span></nobr></DIV>
<DIV style="position:absolute;top:773;left:475"><nobr><span class="ft4">Theorem 12</span></nobr></DIV>
<DIV style="position:absolute;top:770;left:565"><nobr><span class="ft4">QueryOutputTuple is </span></nobr></DIV>
<DIV style="position:absolute;top:768;left:716"><nobr><span class="ft11">P</span></nobr></DIV>
<DIV style="position:absolute;top:776;left:716"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:773;left:723"><nobr><span class="ft4">-complete.</span></nobr></DIV>
<DIV style="position:absolute;top:773;left:799"><nobr><span class="ft4">Hard-</span></nobr></DIV>
<DIV style="position:absolute;top:789;left:475"><nobr><span class="ft4">ness holds even for cardinality-based weighting functions.</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:475"><nobr><span class="ft3"><b>6.</b></span></nobr></DIV>
<DIV style="position:absolute;top:824;left:506"><nobr><span class="ft3"><b>CONCLUSIONS</b></span></nobr></DIV>
<DIV style="position:absolute;top:847;left:489"><nobr><span class="ft4">In this paper, we investigated some important theoreti-</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:475"><nobr><span class="ft9">cal issues in P2P data integration systems. Specifically, we<br>introduced a setting in which peers take into account their<br>own preferences over data sources, in order to integrate data<br>if some inconsistency arise. This seems a natural setting for<br>such kind of systems, which has not been previously investi-<br>gated in the literature. It turns out that there are scenarios<br>where peers do not find any agreement on the way the repair<br>should be carried out, and where some kind of centralized<br>coordination is required.</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:489"><nobr><span class="ft4">Actually, our results show that this coordination comes</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:475"><nobr><span class="ft9">with a cost and some basic problems are unlikely to be<br>tractable. However, the complexity of the problems studied<br>in this paper are only mildly harder than the corresponding<br>problems in traditional data integration systems.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">42</span></nobr></DIV>
</DIV>
<!-- Page 8 -->
<a name="8"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="143008.png" alt="background image">
<DIV style="position:absolute;top:86;left:94"><nobr><span class="ft4">This is an important feature of our approach, that paves</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft9">the way for possible easy implementations, based on avail-<br>able systems.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:94"><nobr><span class="ft4">In particular, the prototypical implementation appears vi-</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:81"><nobr><span class="ft9">able with minor efforts if done on top of integration systems<br>that exploit a declarative approach to data integration (e.g.,<br>[18], where logic programs serve as executable logic specifi-<br>cations for the repair computation). Indeed, our complexity<br>results show that logic engines able to express all problems<br>in the second level of the polynomial hierarchy, such as the<br>DLV system [19], suffices for managing the framework, once<br>we provide appropriate logic specifications.</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:94"><nobr><span class="ft4">A number of interesting research questions arise from this</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:81"><nobr><span class="ft4">work.</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:126"><nobr><span class="ft4">First, it is natural to ask whether the framework</span></nobr></DIV>
<DIV style="position:absolute;top:306;left:81"><nobr><span class="ft9">can be extended to the presence of existentially quantified<br>constraints. This can be easily done for some special syn-<br>tactic fragments, such as for non key-conflicting schemas,<br>i.e., global schemas enriched with inclusion dependencies<br>and keys, for which decidability in the context of data inte-<br>gration systems has been proven in [7]. To this aim, one has<br>to modify the algorithm in [9] to propagate information in a<br>P2P system by accounting for mapping assertion as well as<br>for inclusion dependencies, and eventually check that after<br>such propagation no key has been violated.</span></nobr></DIV>
<DIV style="position:absolute;top:463;left:94"><nobr><span class="ft4">We conclude by noticing that an avenue of further research</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:81"><nobr><span class="ft9">is to consider more sophisticated peer-agreement semantics,<br>besides the Pareto-like approach described here.</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:396"><nobr><span class="ft4">For in-</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:81"><nobr><span class="ft9">stance, we may think of some applications where peers may<br>form cooperating groups, or do not cooperate at all. An-<br>other line of research may lead to enrich the setting by fur-<br>ther kinds of peer preferences criteria, by replacing or com-<br>plementing the weighting functions proposed in this paper.</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:81"><nobr><span class="ft3"><b>Acknowledgments</b></span></nobr></DIV>
<DIV style="position:absolute;top:629;left:81"><nobr><span class="ft9">The work was partially supported by the European Com-<br>mission under project IST-2001-33570 INFOMIX.</span></nobr></DIV>
<DIV style="position:absolute;top:661;left:94"><nobr><span class="ft4">Francesco Scarcello's work was also supported by ICAR-</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:81"><nobr><span class="ft4">CNR, Rende, Italy.</span></nobr></DIV>
<DIV style="position:absolute;top:708;left:81"><nobr><span class="ft3"><b>7.</b></span></nobr></DIV>
<DIV style="position:absolute;top:708;left:112"><nobr><span class="ft3"><b>REFERENCES</b></span></nobr></DIV>
<DIV style="position:absolute;top:728;left:88"><nobr><span class="ft4">[1] Serge Abiteboul, Richard Hull, and Victor Vianu.</span></nobr></DIV>
<DIV style="position:absolute;top:744;left:109"><nobr><span class="ft9">Foundations of Databases. Addison Wesley Publ. Co.,<br>Reading, Massachussetts, 1995.</span></nobr></DIV>
<DIV style="position:absolute;top:777;left:88"><nobr><span class="ft4">[2] Marcelo Arenas, Leopoldo E. Bertossi, and Jan</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:109"><nobr><span class="ft9">Chomicki. Consistent query answers in inconsistent<br>databases. In Proc. of PODS'99, pages 68­79, 1999.</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:88"><nobr><span class="ft4">[3] P. Bernstein, F. Giunchiglia, A. Kementsietsidis,</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:109"><nobr><span class="ft9">J. Mylopoulos, L. Serafini, and I. Zaihrayeu. Data<br>management for peer-to-peer computing: A vision. In<br>Workshop on the Web and Databases, WebDB, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:890;left:88"><nobr><span class="ft4">[4] Leopoldo Bertossi, Jan Chomicki, Alvaro Cortes, and</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:109"><nobr><span class="ft9">Claudio Gutierrez. Consistent answers from integrated<br>data sources. In Proc. of FQAS'02, pages 71­85, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:938;left:88"><nobr><span class="ft4">[5] Leopoldo E. Bertossi and Loreto Bravo. Query</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:109"><nobr><span class="ft9">answering in peer-to-peer data exchange systems. In<br>Proc. of EDBT Workshops 2004, pages 476­485, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:987;left:88"><nobr><span class="ft4">[6] Loreto Bravo and Leopoldo Bertossi. Logic</span></nobr></DIV>
<DIV style="position:absolute;top:1002;left:109"><nobr><span class="ft9">programming for consistently querying data<br>integration systems. In Proc. of IJCAI'03, pages<br>10­15, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:88"><nobr><span class="ft4">[7] Andrea Cal`i, Domenico Lembo, and Riccardo Rosati.</span></nobr></DIV>
<DIV style="position:absolute;top:1067;left:109"><nobr><span class="ft4">On the decidability and complexity of query</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:503"><nobr><span class="ft9">answering over inconsistent and incomplete databases.<br>In Proc. of PODS'03, pages 260­271, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:119;left:482"><nobr><span class="ft4">[8] Andrea Cal`i, Domenico Lembo, and Riccardo Rosati.</span></nobr></DIV>
<DIV style="position:absolute;top:135;left:503"><nobr><span class="ft9">Query rewriting and answering under constraints in<br>data integration systems. In Proc. of IJCAI'03, pages<br>16­21, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:482"><nobr><span class="ft4">[9] Diego Calvanese, Giuseppe De Giacomo, Maurizio</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:503"><nobr><span class="ft9">Lenzerini, and Riccardo Rosati. Logical foundations of<br>peer-to-peer data integration. In Proc. of PODS'04,<br>pages 241­251, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:475"><nobr><span class="ft4">[10] Thomas Eiter, Michael Fink, Gianluigi Greco, and</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:503"><nobr><span class="ft9">Domenico Lembo. Efficient evaluation of logic<br>programs for querying data integration systems. In<br>Proc. of ICLP'03, pages 348­364, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:475"><nobr><span class="ft4">[11] Enrico Franconi, Gabriel Kuper, Andrei Lopatenko,</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:503"><nobr><span class="ft9">and Luciano Serafini. A robust logical and<br>computational characterisation of peer-to-peer<br>database systems. In Proc. of DBISP2P'03, pages<br>64­76, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:475"><nobr><span class="ft4">[12] Enrico Franconi, Gabriel Kuper, Andrei Lopatenko,</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:503"><nobr><span class="ft9">and Ilya Zaihrayeu. A distributed algorithm for robust<br>data sharing and updates in p2p database networks.<br>In Proc. of P2P&amp;DB'04, pages 446­455, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:456;left:475"><nobr><span class="ft4">[13] Enrico Franconi, Gabriel Kuper, Andrei Lopatenko,</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:503"><nobr><span class="ft9">and Ilya Zaihrayeu. Queries and updates in the codb<br>peer to peer database system. In Proc. of VLDB'04,<br>pages 1277­1280, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:475"><nobr><span class="ft4">[14] Gianluigi Greco, Sergio Greco, and Ester Zumpano. A</span></nobr></DIV>
<DIV style="position:absolute;top:536;left:503"><nobr><span class="ft9">logic programming approach to the integration,<br>repairing and querying of inconsistent databases. In<br>Proc. of ICLP'01, pages 348­364. Springer, 2001.</span></nobr></DIV>
<DIV style="position:absolute;top:585;left:475"><nobr><span class="ft4">[15] Gianluigi Greco and Domenico Lembo. Data</span></nobr></DIV>
<DIV style="position:absolute;top:600;left:503"><nobr><span class="ft9">integration with prefernces among sources. In Proc. of<br>ER'04, pages 231­244, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:633;left:475"><nobr><span class="ft4">[16] Alon Y. Halevy, Zachary G. Ives, Peter Mork, and</span></nobr></DIV>
<DIV style="position:absolute;top:649;left:503"><nobr><span class="ft9">Igor Tatarinov. Piazza: data management<br>infrastructure for semantic web applications. In Proc.<br>of WWW'03, pages 556­567, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:698;left:475"><nobr><span class="ft4">[17] Maurizio Lenzerini. Quality-aware peer-to-peer data</span></nobr></DIV>
<DIV style="position:absolute;top:713;left:503"><nobr><span class="ft4">integration. In Proc. of IQIS'04, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:475"><nobr><span class="ft4">[18] Nicola Leone, Thomas Eiter, Wolfgang Faber, Michael</span></nobr></DIV>
<DIV style="position:absolute;top:746;left:503"><nobr><span class="ft9">Fink, Georg Gottlob, Gianluigi Greco, Giovambattista<br>Ianni, Edyta Kalka, Domenico Lembo, Maurizio<br>Lenzerini, Vincenzino Lio, Bartosz Nowicki, Riccardo<br>Rosati, Marco Ruzzi, Witold Staniszkis, and Giorgio<br>Terracina. The INFOMIX system for advanced<br>integration of incomplete and inconsistent data. In<br>Proc. of SIGMOD'05, pages 915­917, 2005.</span></nobr></DIV>
<DIV style="position:absolute;top:857;left:475"><nobr><span class="ft4">[19] Nicola Leone, Gerald Pfeifer, Wolfgang Faber,</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:503"><nobr><span class="ft9">Thomas Eiter, Georg Gottlob, Simona Perri, and<br>Francesco Scarcello. The DLV System for Knowledge<br>Representation and Reasoning. ACM Transaction on<br>Cumputational Logic. To appear.</span></nobr></DIV>
<DIV style="position:absolute;top:937;left:475"><nobr><span class="ft4">[20] Luciano Serafini, Fausto Giunchiglia, John</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:503"><nobr><span class="ft9">Mylopoulos, and Philip A. Bernstein. Local relational<br>model: A logical formalization of database<br>coordination. In Fourth International and<br>Interdisciplinary Conference on Modeling and Using<br>Context, CONTEXT 2003, pages 286­299, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:475"><nobr><span class="ft4">[21] Igor Tatarinov and Alon Halevy. Efficient query</span></nobr></DIV>
<DIV style="position:absolute;top:1049;left:503"><nobr><span class="ft9">reformulation in peer data management systems. In<br>Proc. of SIGMOD'04, pages 539­550, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft8">43</span></nobr></DIV>
</DIV>
</BODY>
</HTML>
