<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>D:\Paper\HTML\163</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="generator" content="pdftohtml 0.35beta">
<META name="date" content="2005-10-21T19:38:00+00:00">
</HEAD>
<BODY bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft0{font-size:24px;font-family:Helvetica;color:#000000;}
	.ft1{font-size:15px;font-family:Helvetica;color:#000000;}
	.ft2{font-size:6px;font-family:Times;color:#000000;}
	.ft3{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft4{font-size:15px;font-family:Times;color:#000000;}
	.ft5{font-size:11px;font-family:Times;color:#000000;}
	.ft6{font-size:9px;font-family:Times;color:#000000;}
	.ft7{font-size:9px;font-family:Times;color:#000000;}
	.ft8{font-size:11px;font-family:Times;color:#000000;}
	.ft9{font-size:15px;font-family:Courier;color:#000000;}
	.ft10{font-size:11px;line-height:15px;font-family:Times;color:#000000;}
	.ft11{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163001.png" alt="background image">
<DIV style="position:absolute;top:114;left:228"><nobr><span class="ft0"><b>Ranking Flows from Sampled Traffic</b></span></nobr></DIV>
<DIV style="position:absolute;top:183;left:233"><nobr><span class="ft1">Chadi Barakat</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:346"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:216;left:217"><nobr><span class="ft3">INRIA - Plan `ete group</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:209"><nobr><span class="ft3">Sophia Antipolis, France</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:199"><nobr><span class="ft1">Chadi.Barakat@inria.fr</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:478"><nobr><span class="ft1">Gianluca Iannaccone, Christophe Diot</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:581"><nobr><span class="ft3">Intel Research</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:578"><nobr><span class="ft3">Cambridge, UK</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:497"><nobr><span class="ft1">Gianluca.Iannaccone@intel.com,</span></nobr></DIV>
<DIV style="position:absolute;top:271;left:522"><nobr><span class="ft1">Christophe.Diot@intel.com</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:83"><nobr><span class="ft4"><b>ABSTRACT</b></span></nobr></DIV>
<DIV style="position:absolute;top:348;left:83"><nobr><span class="ft10">Most of the theoretical work on sampling has addressed the<br>inversion of general traffic properties such as flow size dis-<br>tribution, average flow size, or total number of flows. In<br>this paper, we make a step towards understanding the im-<br>pact of packet sampling on individual flow properties. We<br>study how to detect and rank the largest flows on a link. To<br>this end, we develop an analytical model that we validate<br>on real traces from two networks. First we study a blind<br>ranking method where only the number of sampled packets<br>from each flow is known. Then, we propose a new method,<br>protocol-aware ranking, where we make use of the packet<br>sequence number (when available in transport header) to<br>infer the number of non-sampled packets from a flow, and<br>hence to improve the ranking. Surprisingly, our analytical<br>and experimental results indicate that a high sampling rate<br>(10% and even more depending on the number of top flows<br>to be ranked) is required for a correct blind ranking of the<br>largest flows. The sampling rate can be reduced by an order<br>of magnitude if one just aims at detecting these flows or by<br>using the protocol-aware method.</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:83"><nobr><span class="ft4"><b>Categories and Subject Descriptors</b></span></nobr></DIV>
<DIV style="position:absolute;top:711;left:83"><nobr><span class="ft10">C.4 [Computer Systems Organization]: PERFORMANCE<br>OF SYSTEMS--Measurement techniques</span></nobr></DIV>
<DIV style="position:absolute;top:768;left:83"><nobr><span class="ft4"><b>General Terms</b></span></nobr></DIV>
<DIV style="position:absolute;top:790;left:83"><nobr><span class="ft5">Measurement, Performance, Experimentation</span></nobr></DIV>
<DIV style="position:absolute;top:832;left:83"><nobr><span class="ft4"><b>Keywords</b></span></nobr></DIV>
<DIV style="position:absolute;top:855;left:83"><nobr><span class="ft10">Packet sampling, largest flow detection and ranking, perfor-<br>mance evaluation, validation with real traces</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:83"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:902;left:90"><nobr><span class="ft5">This work was done while the author was visiting Intel</span></nobr></DIV>
<DIV style="position:absolute;top:915;left:83"><nobr><span class="ft5">Research Cambridge.</span></nobr></DIV>
<DIV style="position:absolute;top:983;left:83"><nobr><span class="ft11">Permission to make digital or hard copies of all or part of this work for<br>personal or classroom use is granted without fee provided that copies are<br>not made or distributed for profit or commercial advantage and that copies<br>bear this notice and the full citation on the first page. To copy otherwise, to<br>republish, to post on servers or to redistribute to lists, requires prior specific<br>permission and/or a fee.<br><i>CoNEXT'05, </i>October 24­27, 2005, Toulouse, France.</span></nobr></DIV>
<DIV style="position:absolute;top:1073;left:83"><nobr><span class="ft6">Copyright 2005 ACM 1-59593-197-X/05/0010 ...</span></nobr></DIV>
<DIV style="position:absolute;top:1072;left:319"><nobr><span class="ft8">$</span></nobr></DIV>
<DIV style="position:absolute;top:1073;left:326"><nobr><span class="ft6">5.00.</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:477"><nobr><span class="ft4"><b>1.</b></span></nobr></DIV>
<DIV style="position:absolute;top:326;left:509"><nobr><span class="ft4"><b>INTRODUCTION</b></span></nobr></DIV>
<DIV style="position:absolute;top:346;left:491"><nobr><span class="ft5">The list of the top users or applications is one of the most</span></nobr></DIV>
<DIV style="position:absolute;top:362;left:477"><nobr><span class="ft5">useful statistics to be extracted from network traffic.</span></nobr></DIV>
<DIV style="position:absolute;top:378;left:491"><nobr><span class="ft5">Network operators use the knowledge of the most popular</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:477"><nobr><span class="ft10">destinations to identify emerging markets and applications<br>or to locate where to setup new Points of Presence. Con-<br>tent delivery networks use the popularity of sites to define<br>caching and replication strategies. In traffic engineering, the<br>identification of heavy hitters in the network can be used to<br>treat and route them differently across the network [20, 17,<br>10]. Keeping track of the network prefixes that generate<br>most traffic is also of great importance for anomaly detec-<br>tion. A variation in the pattern of the most common appli-<br>cations may be used as a warning sign and trigger careful<br>inspection of the packet streams.</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:491"><nobr><span class="ft5">However, the ability to identify the top users in a packet</span></nobr></DIV>
<DIV style="position:absolute;top:582;left:477"><nobr><span class="ft10">stream is limited by the network monitoring technology.<br>Capturing and processing all packets on high speed links still<br>remains a challenge for today's network equipment [16, 9].<br>In this context, a common solution is to sample the packet<br>stream to reduce the load on the monitoring system and to<br>simplify the task of sorting the list of items. The underlying<br>assumption in this approach is that the sampling process<br>does not alter the properties of the data distribution.</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:491"><nobr><span class="ft5">Sampled traffic data is then used to infer properties of the</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:477"><nobr><span class="ft10">original data (this operation is called inversion). The inver-<br>sion of sampled traffic is, however, an error-prone procedure<br>that often requires a deep study of the data distribution to<br>evaluate how the sampling rate impacts the accuracy of the<br>metric of interest. Although the inversion may be simple<br>for aggregate link statistics (e.g., to estimate the number<br>of packets transmitted on a link, it is usually sufficient to<br>multiply the number of sampled packets by the inverse of<br>the sampling rate), it is much harder for the properties of<br>individual connections or "flows" [9, 11, 8].</span></nobr></DIV>
<DIV style="position:absolute;top:880;left:491"><nobr><span class="ft5">For these reasons, in this paper, we address this simple,</span></nobr></DIV>
<DIV style="position:absolute;top:895;left:477"><nobr><span class="ft10">and so far unanswered, question: which sampling rate is<br>needed to correctly detect and rank the flows that carry the<br>most packets?</span></nobr></DIV>
<DIV style="position:absolute;top:942;left:491"><nobr><span class="ft5">We define the problem as follows. Consider a traffic mon-</span></nobr></DIV>
<DIV style="position:absolute;top:958;left:477"><nobr><span class="ft10">itor that samples packets independently of each other with<br>probability p (random sampling) and classifies them into<br>sampled flows. At the end of the measurement period, the<br>monitor processes the list of sampled flows, ranks them<br>based on their size in packets, and returns an ordered list of<br>the t largest flows.</span></nobr></DIV>
<DIV style="position:absolute;top:1052;left:491"><nobr><span class="ft5">We are interested in knowing (i) whether the ordered list</span></nobr></DIV>
<DIV style="position:absolute;top:1068;left:477"><nobr><span class="ft5">contains all the actual largest flows in the original packet</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:449"><nobr><span class="ft8">188</span></nobr></DIV>
</DIV>
<!-- Page 2 -->
<a name="2"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft12{font-size:5px;font-family:Times;color:#000000;}
	.ft13{font-size:16px;font-family:Courier;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163002.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft10">stream (detection), and (ii) if the items in the list appear in<br>the correct order (ranking).</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:96"><nobr><span class="ft5">We build an analytical model and define a performance</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:83"><nobr><span class="ft10">metric that evaluates the accuracy of identification and rank-<br>ing of the largest flows. We consider a flow to consist of a<br>single TCP connection. However, our results are general<br>and can be applied to alternative definitions of flow, as well.</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:96"><nobr><span class="ft10">We evaluate two approaches to sort the list of flows:<br>(i) Blind, where the sampled flows are ranked just based</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:83"><nobr><span class="ft10">on their sampled size. This method can be applied to any<br>definition of flow.</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:96"><nobr><span class="ft5">(ii) Protocol-aware, where we make use of additional in-</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:83"><nobr><span class="ft10">formation in the packet header (e.g., the sequence number<br>in TCP packets) to infer the number of non-sampled packets<br>between sampled ones. This method can only be applied to<br>flow definitions that preserve the protocol level details.</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:96"><nobr><span class="ft5">The contributions of this work are the following: (1) We</span></nobr></DIV>
<DIV style="position:absolute;top:357;left:83"><nobr><span class="ft10">perform an analytical study of the problem of ranking two<br>sampled flows and compute the probability that they are<br>misranked. We propose a Gaussian approximation to make<br>the problem numerically tractable. (2) We introduce the<br>protocol-aware ranking method that uses protocol level in-<br>formation to complement the flow statistics and render the<br>detection and ranking of the largest flows more accurate. (3)<br>Based on the model for the ranking of two flows, we propose<br>a general model to study the detection and ranking problem,<br>given a generic flow size distribution. We define a perfor-<br>mance metric and evaluate the impact of several metric's<br>parameter on the accuracy of the ranking. (4) We validate<br>our findings on measurement data using publicly-available<br>packet-level traces. Our results indicate that a surprisingly<br>high sampling rate is required to obtain a good accuracy<br>with the blind approach (10% and even more depending on<br>the number of flows of interest). As for the protocol-aware<br>approach, it allows to reduce the required sampling rate by<br>an order of magnitude compared to the blind approach.</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:96"><nobr><span class="ft5">The paper is structured as follows. Next, we discuss the</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:83"><nobr><span class="ft10">related literature. In Section 3 and 4, we present our model.<br>Section 5 analyzes the model numerically and Section 6 val-<br>idates it on real packet-level traces. Section 7 concludes the<br>paper and provides perspectives for our future research.</span></nobr></DIV>
<DIV style="position:absolute;top:752;left:83"><nobr><span class="ft4"><b>2.</b></span></nobr></DIV>
<DIV style="position:absolute;top:752;left:114"><nobr><span class="ft4"><b>RELATED WORK</b></span></nobr></DIV>
<DIV style="position:absolute;top:772;left:96"><nobr><span class="ft5">The inversion of sampled traffic has been extensively stud-</span></nobr></DIV>
<DIV style="position:absolute;top:788;left:83"><nobr><span class="ft10">ied in the literature. The main focus has been on the inver-<br>sion of aggregate flow properties such as flow size distribu-<br>tion [9, 11], average flow size or total number of flows [8] on<br>a given network link. Duffield et al. [8] study the problem of<br>flow splitting and propose estimators for the total number<br>of flows and for the average flow size in the original traffic<br>stream. [9, 11] study the inversion of the flow size distribu-<br>tion with two different methods. They both show that the<br>major difficulty comes from the number of flows that are not<br>sampled at all and that need to be estimated with an auxil-<br>iary method. As an auxiliary method, [8, 9] propose the use<br>of the SYN flag in the TCP header to mark the beginning of<br>a flow. [9] shows that periodic and random sampling provide<br>roughly the same result on high speed links, and so random<br>sampling can be used for mathematical analysis due to its<br>appealing features. [4] finds the sampling rate that assures<br>a bounded error on the estimation of the size of flows con-<br>tributing to more than some predefined percentage of the<br>traffic volume. [14] studies whether the number of sampled</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:477"><nobr><span class="ft10">packets is a good estimator for the detection of large flows<br>without considering its impact on the flow ranking.</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:491"><nobr><span class="ft5">Given the potential applications of finding the list of top</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:477"><nobr><span class="ft10">users, it does not come as a surprise that there has been a<br>significant effort in the research community to find ways to<br>track frequent items in a data stream [5, 7, 3, 10]. However,<br>this problem has usually been addressed from a memory re-<br>quirement standpoint. All the works in the literature assume<br>that if the algorithm and the memory size is well chosen, the<br>largest flows can be detected and ranked with a high preci-<br>sion. However, in the presence of packet sampling, even if<br>the methods rank correctly the set of sampled flows, there<br>is no guarantee that the sampled rank corresponds to the<br>original rank. The problem we address in this paper com-<br>plements these works as it focuses on the impact of sampling<br>on the flow ranking.</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:477"><nobr><span class="ft4"><b>3.</b></span></nobr></DIV>
<DIV style="position:absolute;top:361;left:509"><nobr><span class="ft4"><b>BASIC MODEL: RANKING TWO FLOWS</b></span></nobr></DIV>
<DIV style="position:absolute;top:381;left:491"><nobr><span class="ft5">In this section, we study the probability to misrank two</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:477"><nobr><span class="ft5">flows of original sizes S</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:614"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:625"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:659"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:669"><nobr><span class="ft5">in packets. This probability</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:477"><nobr><span class="ft10">is the basis for the general model for detecting and ranking<br>the largest flows that we will present later. Indeed, the<br>detection and ranking of the largest flows can be transformed<br>into a problem of ranking over a set of flow pairs.</span></nobr></DIV>
<DIV style="position:absolute;top:475;left:491"><nobr><span class="ft5">Without loss of generality, we assume S</span></nobr></DIV>
<DIV style="position:absolute;top:480;left:734"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:475;left:745"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:480;left:769"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:475;left:775"><nobr><span class="ft5">. We con-</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:477"><nobr><span class="ft5">sider a random sampling of rate p. Let s</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:737"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:749"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:784"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:796"><nobr><span class="ft5">denote</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:477"><nobr><span class="ft10">the sizes in packets of both flows after sampling. The two<br>sampled flows are misranked if (i) s</span></nobr></DIV>
<DIV style="position:absolute;top:527;left:700"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:712"><nobr><span class="ft5">is larger than s</span></nobr></DIV>
<DIV style="position:absolute;top:527;left:807"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:814"><nobr><span class="ft5">, or</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:477"><nobr><span class="ft10">(ii) both flows are not sampled, i.e., their sampled sizes<br>equal to zero. By combining (i) and (ii), one can see that<br>the necessary condition for a good ranking is to sample at<br>least one packet from the larger flow (i.e., the smaller of<br>the two flows can disappear after sampling). The prob-<br>ability to misrank the two flows can then be written as<br>P</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:486"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:497"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:510"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:517"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:531"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:537"><nobr><span class="ft5">) = P {s</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:589"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:599"><nobr><span class="ft5"> s</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:620"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:626"><nobr><span class="ft5">}. For the case S</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:736"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:748"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:637;left:773"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:779"><nobr><span class="ft5">, we con-</span></nobr></DIV>
<DIV style="position:absolute;top:648;left:477"><nobr><span class="ft5">sider the two flows as misranked if s</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:697"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:648;left:708"><nobr><span class="ft5">= s</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:729"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:648;left:735"><nobr><span class="ft5">, or if both flows</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:477"><nobr><span class="ft5">are not sampled at all, i.e. s</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:649"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:659"><nobr><span class="ft5">= s</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:680"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:690"><nobr><span class="ft5">= 0.</span></nobr></DIV>
<DIV style="position:absolute;top:679;left:491"><nobr><span class="ft5">We compute and study the misranking probability of two</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:477"><nobr><span class="ft10">flows of given sizes in the rest of this section. First, we con-<br>sider the blind ranking method where only the number of<br>sampled packets from a flow is known. For this method,<br>we express the misranking probability as a double sum of<br>binomials, then we present a Gaussian approximation to<br>make the problem tractable numerically. Second, we con-<br>sider the protocol-aware ranking method for which we cal-<br>culate a numerical-tractable closed-form expression of the<br>misraking probability. Note that the misranking probability<br>is a symmetric function, i.e., P</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:663"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:673"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:687"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:693"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:708"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:714"><nobr><span class="ft5">) = P</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:747"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:757"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:771"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:777"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:792"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:836;left:798"><nobr><span class="ft5">).</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:477"><nobr><span class="ft4"><b>3.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:863;left:518"><nobr><span class="ft4"><b>Blind ranking</b></span></nobr></DIV>
<DIV style="position:absolute;top:883;left:491"><nobr><span class="ft5">With this method, s</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:622"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:635"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:671"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:883;left:684"><nobr><span class="ft5">represent the number of</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:477"><nobr><span class="ft5">sampled packets from flows S</span></nobr></DIV>
<DIV style="position:absolute;top:904;left:656"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:667"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:904;left:703"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:899;left:709"><nobr><span class="ft5">. Under our assump-</span></nobr></DIV>
<DIV style="position:absolute;top:915;left:477"><nobr><span class="ft10">tions, these two variables are distributed according to a bi-<br>nomial distribution of probability p. Hence, we can write<br>for S</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:507"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:517"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:540"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:546"><nobr><span class="ft5">,</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:488"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:497"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:507"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:521"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:527"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:542"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:548"><nobr><span class="ft5">) = P {s</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:596"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:606"><nobr><span class="ft5"> s</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:627"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:633"><nobr><span class="ft5">} =</span></nobr></DIV>
<DIV style="position:absolute;top:970;left:662"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:669"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:659"><nobr><span class="ft2">i=0</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:681"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:687"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:693"><nobr><span class="ft5">(i, S</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:718"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:724"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:971;left:740"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:732"><nobr><span class="ft2">j=0</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:754"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:760"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:766"><nobr><span class="ft5">(j, S</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:792"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:984;left:798"><nobr><span class="ft5">). (1)</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:477"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:1029;left:483"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:490"><nobr><span class="ft5">(i, S) is the probability density function of a binomial dis-</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:477"><nobr><span class="ft10">tribution of probability p, i.e., the probability of obtaining i<br>successes out of S trials. We have b</span></nobr></DIV>
<DIV style="position:absolute;top:1060;left:689"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:695"><nobr><span class="ft5">(i, S) =</span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:751"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:752"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:764"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:771"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:776"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:815"><nobr><span class="ft2">S-i</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">for i = 0, 1, ..., S, and b</span></nobr></DIV>
<DIV style="position:absolute;top:1076;left:617"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:623"><nobr><span class="ft5">(i, S) = 0 for i &lt; 0 and i &gt; S. The</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">189</span></nobr></DIV>
</DIV>
<!-- Page 3 -->
<a name="3"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft14{font-size:14px;font-family:Times;color:#000000;}
	.ft15{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163003.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft10">probability to misrank two flows of equal sizes is given by<br>P {s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:107"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:117"><nobr><span class="ft5">= s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:138"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:148"><nobr><span class="ft5">or s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:172"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:182"><nobr><span class="ft5">= s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:203"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:213"><nobr><span class="ft5">= 0} = 1 - P {s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:308"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:318"><nobr><span class="ft5">= s</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:339"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:349"><nobr><span class="ft5">= 0}</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:83"><nobr><span class="ft5">= 1 -</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:136"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:124;left:142"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:131;left:136"><nobr><span class="ft2">i=1</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:157"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:162"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:162"><nobr><span class="ft2">p</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:169"><nobr><span class="ft5">(i, S</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:194"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:200"><nobr><span class="ft5">).</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:96"><nobr><span class="ft5">Unfortunately, the above expression for the misranking</span></nobr></DIV>
<DIV style="position:absolute;top:155;left:83"><nobr><span class="ft10">probability is numerically untractable since it involves two<br>sums of binomials. For large flows of order S packets, the<br>number of operations required to compute such a probability<br>is on the order of O(S</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:221"><nobr><span class="ft2">3</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:228"><nobr><span class="ft5">), assuming that the complexity of</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:83"><nobr><span class="ft10">the binomial computation is on the order of O(S). The<br>problem becomes much more complex if one has to sum<br>over all possible flow sizes (i.e., O(S</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:300"><nobr><span class="ft2">5</span></nobr></DIV>
<DIV style="position:absolute;top:249;left:306"><nobr><span class="ft5">)). For this reason, we</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:83"><nobr><span class="ft10">propose next a Gaussian approximation to the problem of<br>blind ranking that is accurate and easy to compute. We use<br>this approximation to study the ranking performance as a<br>function of the sampling rate and the flow sizes.</span></nobr></DIV>
<DIV style="position:absolute;top:340;left:87"><nobr><span class="ft14"><i>3.1.1</i></span></nobr></DIV>
<DIV style="position:absolute;top:340;left:136"><nobr><span class="ft14"><i>Gaussian approximation to blind ranking</i></span></nobr></DIV>
<DIV style="position:absolute;top:360;left:96"><nobr><span class="ft5">Consider a flow made of S packets and sampled at rate</span></nobr></DIV>
<DIV style="position:absolute;top:375;left:83"><nobr><span class="ft10">p. The sampled size follows a binomial distribution. How-<br>ever, it is well known that the binomial distribution can be<br>approximated by a Normal (or Gaussian) distribution when<br>p is small and when the product pS is on the order of one<br>(flows for which, on average, at least few packets are sam-<br>pled) [21, pages 108­109]. We assume that this is the case<br>for the largest flows, and we consider the sampled size of<br>a flow as distributed according to a Normal distribution of<br>average pS and of variance p(1 - p)S. Using this approxi-<br>mation, one can express the misranking probability for the<br>blind ranking problem in the following simple form.</span></nobr></DIV>
<DIV style="position:absolute;top:563;left:98"><nobr><span class="ft5">Proposition 1. For any two flows of sizes S</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:385"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:563;left:398"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:568;left:435"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:83"><nobr><span class="ft5">packets (S</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:144"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:154"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:177"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:184"><nobr><span class="ft5">), the Gaussian approximation gives,</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:109"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:118"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:128"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:142"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:148"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:163"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:169"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:195"><nobr><span class="ft15">1<br>2 erf c</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:285"><nobr><span class="ft5">|S</span></nobr></DIV>
<DIV style="position:absolute;top:614;left:297"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:307"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:614;left:329"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:335"><nobr><span class="ft5">|</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:259"><nobr><span class="ft5">2(1/p - 1)(S</span></nobr></DIV>
<DIV style="position:absolute;top:634;left:335"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:345"><nobr><span class="ft5">+ S</span></nobr></DIV>
<DIV style="position:absolute;top:634;left:367"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:373"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:394"><nobr><span class="ft5">,</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:424"><nobr><span class="ft5">(2)</span></nobr></DIV>
<DIV style="position:absolute;top:660;left:83"><nobr><span class="ft5">where erfc(x) = (</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:196"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:191"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:660;left:209"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:656;left:226"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:668;left:223"><nobr><span class="ft2">x</span></nobr></DIV>
<DIV style="position:absolute;top:660;left:240"><nobr><span class="ft5">e</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:246"><nobr><span class="ft2">-u</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:261"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:660;left:268"><nobr><span class="ft5">du is the complementary er-</span></nobr></DIV>
<DIV style="position:absolute;top:677;left:83"><nobr><span class="ft5">ror cumulative function.</span></nobr></DIV>
<DIV style="position:absolute;top:708;left:83"><nobr><span class="ft5">Proof: Consider two flows of sizes S</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:318"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:708;left:330"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:367"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:708;left:379"><nobr><span class="ft5">in packets</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:83"><nobr><span class="ft5">such that S</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:153"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:164"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:188"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:194"><nobr><span class="ft5">. Their sampled versions s</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:357"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:368"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:402"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:413"><nobr><span class="ft5">both</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:83"><nobr><span class="ft5">follow Normal distributions of averages pS</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:346"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:359"><nobr><span class="ft5">and pS</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:403"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:409"><nobr><span class="ft5">, and</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:83"><nobr><span class="ft5">of variances p(1 - p)S</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:217"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:228"><nobr><span class="ft5">and p(1 - p)S</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:313"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:319"><nobr><span class="ft5">. We know that the</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:83"><nobr><span class="ft10">sum of two Normal variables is a Normal variable. So the<br>difference s</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:152"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:162"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:183"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:194"><nobr><span class="ft5">follows a Normal distribution of average</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:83"><nobr><span class="ft5">p(S</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:103"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:112"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:134"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:140"><nobr><span class="ft5">) and of variance p(1 - p)(S</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:307"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:316"><nobr><span class="ft5">+ S</span></nobr></DIV>
<DIV style="position:absolute;top:808;left:338"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:344"><nobr><span class="ft5">). We have then</span></nobr></DIV>
<DIV style="position:absolute;top:818;left:83"><nobr><span class="ft5">this approximation for the misranking probability:</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:111"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:119"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:130"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:144"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:150"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:165"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:171"><nobr><span class="ft5">) = P {s</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:238"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:247"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:849;left:267"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:277"><nobr><span class="ft5"> 0}</span></nobr></DIV>
<DIV style="position:absolute;top:877;left:214"><nobr><span class="ft5">P V &gt;</span></nobr></DIV>
<DIV style="position:absolute;top:868;left:295"><nobr><span class="ft5">p(S</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:315"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:868;left:325"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:347"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:868;left:353"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:281"><nobr><span class="ft5">p(1 - p)(S</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:343"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:352"><nobr><span class="ft5">+ S</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:375"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:381"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:190"><nobr><span class="ft5">=</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:216"><nobr><span class="ft15">1<br>2 erfc</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:305"><nobr><span class="ft5">S</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:313"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:323"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:345"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:275"><nobr><span class="ft5">2(1/p - 1)(S</span></nobr></DIV>
<DIV style="position:absolute;top:940;left:351"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:361"><nobr><span class="ft5">+ S</span></nobr></DIV>
<DIV style="position:absolute;top:940;left:383"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:934;left:389"><nobr><span class="ft5">)</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:409"><nobr><span class="ft5">. (3)</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:83"><nobr><span class="ft10">V is a standard Normal random variable. Given the symme-<br>try of the misranking probability, one can take the absolute<br>value of S</span></nobr></DIV>
<DIV style="position:absolute;top:997;left:143"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:992;left:152"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:997;left:174"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:992;left:185"><nobr><span class="ft5">in (3) and get the expression stated in the</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:83"><nobr><span class="ft5">proposition, which is valid for all S</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:295"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:306"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:341"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:347"><nobr><span class="ft5">.</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:96"><nobr><span class="ft5">For S</span></nobr></DIV>
<DIV style="position:absolute;top:1029;left:130"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:141"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:1029;left:164"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:171"><nobr><span class="ft5">, one can safely approximate the misranking</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:83"><nobr><span class="ft10">probability to be equal to 1. This approximation is however<br>of little importance given the very low probability of having<br>two flows of equal sizes, especially when they are large.</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:477"><nobr><span class="ft4"><b>3.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:90;left:518"><nobr><span class="ft4"><b>Protocol-aware ranking</b></span></nobr></DIV>
<DIV style="position:absolute;top:110;left:491"><nobr><span class="ft5">Packets can carry in their transport header an increasing</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:477"><nobr><span class="ft10">sequence number. A typical example is the byte sequence<br>number in the TCP header. Another example could be the<br>sequence number in the header of the Real Time Protocol<br>(RTP) [19]. One can use this sequence number, when avail-<br>able, to infer the number of non-sampled packets (or bytes<br>in the case of TCP) between sampled ones, and hence to im-<br>prove the accuracy of ranking. The size of the sampled flow<br>in this case is no longer the number of packets collected, but<br>rather the number of packets that exist between the first and<br>last sampled packets from the flow. Although this solution<br>is limited to flows whose packet carry a sequence number, we<br>believe that the study of this ranking method is important<br>given the widespread use of the TCP protocol. Our objective<br>is to understand how the use of protocol-level information<br>can supplement the simple, and more general, blind method<br>and if it is worth the additional overhead it introduces (i.e.,<br>storing two sequence numbers per flow record).</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:491"><nobr><span class="ft5">In the following, we calculate the misranking probability</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:477"><nobr><span class="ft10">of two flows of given sizes when using the protocol-aware<br>method. This probability will be used later in the general<br>ranking problem. The main contribution of this section is a<br>closed-form expression for the misranking probability that<br>is numerically tractable, without the need for any approxi-<br>mation.</span></nobr></DIV>
<DIV style="position:absolute;top:502;left:491"><nobr><span class="ft5">Let S be the size of a flow in packets. Let s</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:788"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:502;left:793"><nobr><span class="ft5">, s</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:811"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:502;left:825"><nobr><span class="ft5">=</span></nobr></DIV>
<DIV style="position:absolute;top:518;left:477"><nobr><span class="ft10">1, 2, ..., S, denote the (packet) sequence number carried by<br>the first sampled packet, and let s</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:694"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:700"><nobr><span class="ft5">, s</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:717"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:729"><nobr><span class="ft5">= S, S - 1, ..., s</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:826"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:832"><nobr><span class="ft5">,</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:477"><nobr><span class="ft10">denote the sequence number carried by the last sampled<br>packet. Given s</span></nobr></DIV>
<DIV style="position:absolute;top:570;left:577"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:565;left:588"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:570;left:622"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:565;left:629"><nobr><span class="ft5">, one can estimate the size of the</span></nobr></DIV>
<DIV style="position:absolute;top:580;left:477"><nobr><span class="ft5">sampled flow in packets to s = s</span></nobr></DIV>
<DIV style="position:absolute;top:586;left:684"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:580;left:693"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:586;left:715"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:580;left:724"><nobr><span class="ft5">+ 1. The error in</span></nobr></DIV>
<DIV style="position:absolute;top:596;left:477"><nobr><span class="ft10">this estimation comes from the non-sampled packets that<br>are transmitted before s</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:628"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:612;left:640"><nobr><span class="ft5">and after s</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:709"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:612;left:715"><nobr><span class="ft5">. We give next the</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:477"><nobr><span class="ft10">distribution of s, which is needed for the computation of<br>the misranking probability, then we state our main result.<br>Before presenting the analysis, note that this new flow size<br>estimator only counts the packets that are transmitted with<br>distinct sequence numbers. In the case of TCP, this corre-<br>sponds to the number of bytes received at the application<br>layer, rather then the number of bytes carried over the net-<br>work. It is equivalent to assuming that the probability of<br>sampling a retransmitted (or duplicated) packet is negligi-<br>ble. This is a reasonable assumption if the loss rate is low.<br>We will address this aspect in more detail in Section 6.</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:491"><nobr><span class="ft5">Consider a flow of size S  2 in packets. Using the above</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:477"><nobr><span class="ft10">definition for s, the sampled flow has a size of i packets,<br>i  2, with probability:</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:513"><nobr><span class="ft5">P {s = i} =</span></nobr></DIV>
<DIV style="position:absolute;top:860;left:585"><nobr><span class="ft2">S-i+1</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:592"><nobr><span class="ft2">k=1</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:621"><nobr><span class="ft5">P {s</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:645"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:654"><nobr><span class="ft5">= k} P {s</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:710"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:720"><nobr><span class="ft5">= k + i - 1} .</span></nobr></DIV>
<DIV style="position:absolute;top:917;left:477"><nobr><span class="ft5">We have P {s</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:555"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:917;left:565"><nobr><span class="ft5">= k} = (1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:915;left:651"><nobr><span class="ft2">k-1</span></nobr></DIV>
<DIV style="position:absolute;top:917;left:672"><nobr><span class="ft5">p, and P {s</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:737"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:917;left:747"><nobr><span class="ft5">= k + i - 1} =</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:477"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:519"><nobr><span class="ft2">S-k-i+1</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:568"><nobr><span class="ft5">p. This gives</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:510"><nobr><span class="ft5">P {s = i} =</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:602"><nobr><span class="ft2">S-i+1</span></nobr></DIV>
<DIV style="position:absolute;top:994;left:609"><nobr><span class="ft2">k=1</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:636"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:677"><nobr><span class="ft2">k-1</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:698"><nobr><span class="ft5">p(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:747"><nobr><span class="ft2">S-k-i+1</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:796"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:1011;left:578"><nobr><span class="ft5">= p</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:609"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1011;left:615"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:657"><nobr><span class="ft2">S-i</span></nobr></DIV>
<DIV style="position:absolute;top:1011;left:677"><nobr><span class="ft5">(S - i + 1).</span></nobr></DIV>
<DIV style="position:absolute;top:1011;left:818"><nobr><span class="ft5">(4)</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:477"><nobr><span class="ft5">As for i = 0, we have P {s = 0} = (1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:1037;left:729"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:742"><nobr><span class="ft5">for S  1. And</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:477"><nobr><span class="ft5">for i = 1, we have P {s = 1} = p(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:719"><nobr><span class="ft2">S-1</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:741"><nobr><span class="ft5">S for S  1. It</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">is easy to prove that the cumulative distribution of s is the</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">190</span></nobr></DIV>
</DIV>
<!-- Page 4 -->
<a name="4"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1268" src="163004.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft5">following for all values of S:</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:90"><nobr><span class="ft5">P {s  i = 0} = p(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:112;left:235"><nobr><span class="ft2">S-i</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:256"><nobr><span class="ft5">(S - i + 1) + (1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:112;left:378"><nobr><span class="ft2">S-i+1</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:413"><nobr><span class="ft5">. (5)</span></nobr></DIV>
<DIV style="position:absolute;top:140;left:83"><nobr><span class="ft10">We come now to the misranking probability, which we recall<br>is a symmetric function. For S</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:268"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:156;left:278"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:301"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:156;left:307"><nobr><span class="ft5">, we have</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:89"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:98"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:109"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:122"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:129"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:143"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:149"><nobr><span class="ft5">) = P {s</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:197"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:207"><nobr><span class="ft5"> s</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:228"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:234"><nobr><span class="ft5">} =</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:263"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:184;left:270"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:214;left:261"><nobr><span class="ft2">i=0</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:282"><nobr><span class="ft5">P {s</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:306"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:316"><nobr><span class="ft5">= i}</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:352"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:214;left:345"><nobr><span class="ft2">j=0</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:367"><nobr><span class="ft5">P {s</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:391"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:401"><nobr><span class="ft5">= j} .</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:424"><nobr><span class="ft5">(6)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:83"><nobr><span class="ft5">And for S</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:143"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:153"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:176"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:182"><nobr><span class="ft5">, we have</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:161"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:169"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:180"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:194"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:200"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:215"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:221"><nobr><span class="ft5">) = 1 -</span></nobr></DIV>
<DIV style="position:absolute;top:265;left:272"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:279"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:298;left:270"><nobr><span class="ft2">i=1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:291"><nobr><span class="ft5">P {s</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:315"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:325"><nobr><span class="ft5">= i}</span></nobr></DIV>
<DIV style="position:absolute;top:276;left:351"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:359"><nobr><span class="ft5">.</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:424"><nobr><span class="ft5">(7)</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:96"><nobr><span class="ft5">Our main result is the following.</span></nobr></DIV>
<DIV style="position:absolute;top:346;left:98"><nobr><span class="ft5">Proposition 2. For S</span></nobr></DIV>
<DIV style="position:absolute;top:351;left:238"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:346;left:248"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:351;left:271"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:346;left:277"><nobr><span class="ft5">, the misranking probability</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:83"><nobr><span class="ft5">is equal to</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:83"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:91"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:102"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:116"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:122"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:137"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:143"><nobr><span class="ft5">) = (1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:227"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:387;left:234"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:241"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:282"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:387;left:289"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:162"><nobr><span class="ft5">+ p(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:234"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:241"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:247"><nobr><span class="ft2">-1</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:262"><nobr><span class="ft5">S</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:270"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:276"><nobr><span class="ft5">[p(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:329"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:336"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:341"><nobr><span class="ft2">-1</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:356"><nobr><span class="ft5">S</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:365"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:374"><nobr><span class="ft5">+ (1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:429"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:436"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:443"><nobr><span class="ft5">]</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:162"><nobr><span class="ft5">+ p</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:193"><nobr><span class="ft2">3</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:201"><nobr><span class="ft5"></span></nobr></DIV>
<DIV style="position:absolute;top:427;left:209"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:215"><nobr><span class="ft5">F (1 - p, 1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:237"><nobr><span class="ft5">xy</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:309"><nobr><span class="ft5">+ p</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:330"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:338"><nobr><span class="ft5">F (1 - p, 1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:379"><nobr><span class="ft5">x</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:437"><nobr><span class="ft5">,</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:83"><nobr><span class="ft5">where</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:116"><nobr><span class="ft5">F (x, y) = xy</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:211"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:218"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:224"><nobr><span class="ft2">-S</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:239"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:245"><nobr><span class="ft2">+1</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:263"><nobr><span class="ft5">+ ... + x</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:313"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:320"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:326"><nobr><span class="ft2">-1</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:340"><nobr><span class="ft5">y</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:348"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:355"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:360"><nobr><span class="ft2">-1</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:172"><nobr><span class="ft5">= xy</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:211"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:218"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:224"><nobr><span class="ft2">-S</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:239"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:245"><nobr><span class="ft2">+1</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:260"><nobr><span class="ft5">(1 - (xy)</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:315"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:322"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:327"><nobr><span class="ft2">-1</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:342"><nobr><span class="ft5">)/(1 - xy).</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:83"><nobr><span class="ft5">For S</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:117"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:127"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:150"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:160"><nobr><span class="ft5">= S, the misranking probability is equal to</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:90"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:580;left:99"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:110"><nobr><span class="ft5">(S, S) = 1 - p</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:193"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:200"><nobr><span class="ft5">(1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:241"><nobr><span class="ft2">2(S-1)</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:277"><nobr><span class="ft5">S</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:286"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:296"><nobr><span class="ft5">- p</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:317"><nobr><span class="ft2">4</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:325"><nobr><span class="ft5"></span></nobr></DIV>
<DIV style="position:absolute;top:565;left:333"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:339"><nobr><span class="ft5">G(1 - p, 1 - p)</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:361"><nobr><span class="ft5">xy</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:430"><nobr><span class="ft5">,</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:83"><nobr><span class="ft5">where</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:86"><nobr><span class="ft5">G(x, y) = xy + x</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:187"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:193"><nobr><span class="ft5">y</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:200"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:210"><nobr><span class="ft5">+ x</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:231"><nobr><span class="ft2">S-1</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:253"><nobr><span class="ft5">y</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:261"><nobr><span class="ft2">S-1</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:287"><nobr><span class="ft5">= (xy - (xy)</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:364"><nobr><span class="ft2">S</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:372"><nobr><span class="ft5">)/(1 - xy).</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:83"><nobr><span class="ft10">Proof: One can validate the results by plugging (4) and (5)<br>into (6) and (7).</span></nobr></DIV>
<DIV style="position:absolute;top:693;left:96"><nobr><span class="ft5">Note that the main gain of writing the misraking proba-</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:83"><nobr><span class="ft10">bility in such a condensed form is a complexity that drops<br>from O(S</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:142"><nobr><span class="ft2">3</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:149"><nobr><span class="ft5">) in (6) to O(S) in our final result. This gain</span></nobr></DIV>
<DIV style="position:absolute;top:740;left:83"><nobr><span class="ft10">comes from the closed-form expression for the cumulative<br>distribution in (5), and from introducing the two functions<br>F (x, y) and G(x, y). These two latter functions transform<br>two series whose complexity is O(S</span></nobr></DIV>
<DIV style="position:absolute;top:786;left:295"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:301"><nobr><span class="ft5">) into a closed-form ex-</span></nobr></DIV>
<DIV style="position:absolute;top:803;left:83"><nobr><span class="ft5">pression whose complexity is O(S).</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:96"><nobr><span class="ft5">We solve the derivatives in the above equations using the</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:83"><nobr><span class="ft10">symbolic toolbox of matlab, which gives explicit expressions<br>for the misranking probability. These expressions are simple<br>to compute, but span on multiple lines, so we omit them for<br>lack of space.</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:83"><nobr><span class="ft4"><b>3.3</b></span></nobr></DIV>
<DIV style="position:absolute;top:909;left:123"><nobr><span class="ft4"><b>Analysis of the misranking probability</b></span></nobr></DIV>
<DIV style="position:absolute;top:941;left:87"><nobr><span class="ft14"><i>3.3.1</i></span></nobr></DIV>
<DIV style="position:absolute;top:941;left:136"><nobr><span class="ft14"><i>The blind case</i></span></nobr></DIV>
<DIV style="position:absolute;top:961;left:96"><nobr><span class="ft5">We use the Gaussian approximation to study how the mis-</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:83"><nobr><span class="ft10">ranking probability varies with the sampling rate and with<br>the sizes of both flows, in particular their difference. The<br>study of the impact of the flow sizes is important to under-<br>stand the relation between flow size distribution and ranking<br>of the largest flows.</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:96"><nobr><span class="ft5">The misranking probability is a decreasing function of the</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:83"><nobr><span class="ft5">sampling rate. It moves to zero when p moves to 1 and to 0.5</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:477"><nobr><span class="ft5">when p approaches zero</span></nobr></DIV>
<DIV style="position:absolute;top:88;left:622"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:628"><nobr><span class="ft5">. Therefore, there exists one sam-</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:477"><nobr><span class="ft10">pling rate that leads to some desired misranking probability,<br>and any lower sampling rate results in larger error.</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:491"><nobr><span class="ft5">We study now how the misranking probability varies with</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:477"><nobr><span class="ft5">the sizes of both flows. Take S</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:678"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:691"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:718"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:728"><nobr><span class="ft5">- k, k a positive</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:477"><nobr><span class="ft10">integer. From (2) and for fixed k, the misranking probability<br>increases with S</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:573"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:184;left:583"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:617"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:184;left:627"><nobr><span class="ft5">(erfc(x) is an increasing function in</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:477"><nobr><span class="ft10">x). This indicates that it is more difficult to rank correctly<br>two flows different by k packets as their sizes increase in<br>absolute terms. The result is different if we take the size of<br>one flow equal to  &lt; 1 times the size of the second, i.e.,<br>S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:486"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:497"><nobr><span class="ft5">= S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:530"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:536"><nobr><span class="ft5">. Here, (S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:600"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:609"><nobr><span class="ft5">- S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:632"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:638"><nobr><span class="ft5">)/S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:671"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:680"><nobr><span class="ft5">+ S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:702"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:714"><nobr><span class="ft5">is equal to S</span></nobr></DIV>
<DIV style="position:absolute;top:268;left:803"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:809"><nobr><span class="ft5">(1 -</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:477"><nobr><span class="ft5">)/1 + , which increases with S</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:686"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:692"><nobr><span class="ft5">. Hence, the misranking</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:477"><nobr><span class="ft5">probability given in (2) decreases when S</span></nobr></DIV>
<DIV style="position:absolute;top:299;left:736"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:749"><nobr><span class="ft5">increases. We</span></nobr></DIV>
<DIV style="position:absolute;top:310;left:477"><nobr><span class="ft10">conclude that, when the two flow sizes maintain the same<br>proportion, it is easier to obtain a correct ranking when they<br>are large in absolute terms.</span></nobr></DIV>
<DIV style="position:absolute;top:357;left:491"><nobr><span class="ft5">We can now generalize the result above. One may think</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:477"><nobr><span class="ft10">that the larger the flows, the better the ranking of their<br>sampled versions. Our last two examples indicate that this<br>is not always the case. The ranking accuracy depends on<br>the relative difference of the flow sizes. In general, to have<br>a better ranking, the difference between the two flow sizes<br>must increase with the flow sizes and the increase must be<br>larger than a certain threshold. This threshold is given by<br>(2): the difference must increase at least as the square root<br>of the flow sizes. This is an interesting finding. In the con-<br>text of the general ranking problem, it can be interpreted<br>as follows. Suppose that the flow size has a cumulative dis-<br>tribution function y = F (x). As we move to the tail of the<br>distribution</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:548"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:561;left:554"><nobr><span class="ft5">, the size of the flows to be ranked increases.</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:477"><nobr><span class="ft10">The ranking performance improves if the difference between<br>flow sizes increases faster than x. This is equivalent to<br>saying that dx/dy should increase with x faster than x.<br>All common distributions satisfy this condition, at least at<br>their tails. For example, with the exponential distribution<br>we have dx/dy  e</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:601"><nobr><span class="ft2">x</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:620"><nobr><span class="ft5">(1/ is the average), while for the</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:477"><nobr><span class="ft5">Pareto distribution we have dx/dy  x</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:712"><nobr><span class="ft2">+1</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:737"><nobr><span class="ft5">( is the shape).</span></nobr></DIV>
<DIV style="position:absolute;top:701;left:481"><nobr><span class="ft14"><i>3.3.2</i></span></nobr></DIV>
<DIV style="position:absolute;top:701;left:531"><nobr><span class="ft14"><i>The protocol-aware case</i></span></nobr></DIV>
<DIV style="position:absolute;top:720;left:491"><nobr><span class="ft5">The first difference with the blind case is in the estimation</span></nobr></DIV>
<DIV style="position:absolute;top:736;left:477"><nobr><span class="ft5">error (S - s = s</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:572"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:736;left:579"><nobr><span class="ft5">- 1 + S - s</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:645"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:736;left:651"><nobr><span class="ft5">), which can be safely assumed</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:477"><nobr><span class="ft10">to be independent of the flow size for large flows (only de-<br>pendent on p). This means that if two large flows keep the<br>same distance between them while their sizes increase, their<br>ranking maintains the same accuracy. Their ranking im-<br>proves if the difference between their sizes increases as well,<br>and it deteriorates if the difference between their sizes de-<br>creases. So in contrast to the blind case, the threshold for<br>the ranking here to improve is that the larger flow should<br>have its size increasing a little faster than the smaller one. In<br>the context of the general ranking problem where flow sizes<br>are distributed according to a cumulative distribution func-<br>tion y = F (x), and when the top flows become larger, the<br>protocol-aware ranking improves if the derivative dx/dy in-<br>creases with x. This is equivalent to saying that the function<br>F (x) should be concave, which is satisfied by most common<br>distributions at their tail. For blind ranking, concavity was</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:478"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1015;left:484"><nobr><span class="ft5">The Gaussian approximation does not account for the case</span></nobr></DIV>
<DIV style="position:absolute;top:1028;left:477"><nobr><span class="ft5">p = 0 where the misranking probability should be equal to</span></nobr></DIV>
<DIV style="position:absolute;top:1042;left:477"><nobr><span class="ft5">1 based on our definition.</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:478"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:484"><nobr><span class="ft5">Because we are more and more focusing on large flows or</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">because the number of available flows for ranking increases.</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">191</span></nobr></DIV>
</DIV>
<!-- Page 5 -->
<a name="5"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft16{font-size:15px;line-height:20px;font-family:Times;color:#000000;}
	.ft17{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft18{font-size:15px;line-height:17px;font-family:Times;color:#000000;}
	.ft19{font-size:6px;line-height:10px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163005.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft10">not enough to obtain a better ranking; the derivative dx/dy<br>had to increase faster than x. So in conclusion, the condi-<br>tion to have a better ranking when we move to the tail of the<br>flow size distribution is less strict with the protocol-aware<br>method, which is an indication of its good performance.</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:96"><nobr><span class="ft5">The second difference with the blind case is in the rela-</span></nobr></DIV>
<DIV style="position:absolute;top:184;left:83"><nobr><span class="ft10">tion between the ranking accuracy and the sampling rate.<br>Consider two large flows of sizes S</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:292"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:303"><nobr><span class="ft5">and S</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:339"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:350"><nobr><span class="ft5">in packets, and</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:83"><nobr><span class="ft5">let s</span></nobr></DIV>
<DIV style="position:absolute;top:221;left:109"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:121"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:221;left:154"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:166"><nobr><span class="ft5">denote their sampled sizes. The coefficient of</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:83"><nobr><span class="ft5">variation of the difference s</span></nobr></DIV>
<DIV style="position:absolute;top:237;left:253"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:263"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:237;left:284"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:296"><nobr><span class="ft5">is an indication on how</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:83"><nobr><span class="ft10">well the ranking performs (a small coefficient of variation<br>results in better ranking</span></nobr></DIV>
<DIV style="position:absolute;top:261;left:230"><nobr><span class="ft2">3</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:236"><nobr><span class="ft5">). It is easy to prove that this co-</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:83"><nobr><span class="ft10">efficient of variation scales as 1/p for protocol-aware ranking<br>and as 1/p for blind ranking. This is again an important<br>finding. It tells that when the sampling rate is very small,<br>blind ranking could (asymptotically) perform better than<br>protocol-aware ranking. Our numerical and experimental<br>results will confirm this finding.</span></nobr></DIV>
<DIV style="position:absolute;top:394;left:83"><nobr><span class="ft4"><b>4.</b></span></nobr></DIV>
<DIV style="position:absolute;top:394;left:114"><nobr><span class="ft16"><b>GENERAL MODEL: DETECTING AND<br>RANKING THE LARGEST FLOWS</b></span></nobr></DIV>
<DIV style="position:absolute;top:435;left:96"><nobr><span class="ft5">We generalize the previous model from the ranking of</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:83"><nobr><span class="ft10">two flows to the detection and ranking of the top t flows,<br>t = 1, 2, . . . , N . The misranking probability P</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:357"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:367"><nobr><span class="ft5">(S</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:381"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:387"><nobr><span class="ft5">, S</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:402"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:408"><nobr><span class="ft5">) pre-</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:83"><nobr><span class="ft10">viously calculated is the basis for this generalization. Let<br>N  t denote the total number of flows available in the mea-<br>surement period before sampling. We want the sampled list<br>of top t flows to match the list of top t flows in the original<br>traffic. Two criteria are considered to decide whether this<br>match is accurate. First, we require the two lists to be iden-<br>tical. This corresponds to the ranking problem. The second,<br>less constrained, criterion requires the two lists to contain<br>the same flows regardless of their relative order within the<br>list. This corresponds to the detection problem. For both<br>problems, the quality of the result is expressed as a function<br>of the sampling rate p, the flow size distribution, the number<br>of flows to rank t, and the total number of flows N .</span></nobr></DIV>
<DIV style="position:absolute;top:699;left:83"><nobr><span class="ft4"><b>4.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:699;left:123"><nobr><span class="ft4"><b>Performance metric</b></span></nobr></DIV>
<DIV style="position:absolute;top:719;left:96"><nobr><span class="ft5">In order to evaluate the accuracy of detection and rank-</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:83"><nobr><span class="ft10">ing, we need to define a performance metric that is easy<br>to compute and that focuses on the largest flows. A flow<br>at the top of the list can be misranked with a neighboring<br>large flow or a distant small flow. We want our metric to<br>differentiate between these two cases and to penalize more<br>the latter one; a top-10 flow replaced by the 100-th flow in<br>the sampled top list is worse than the top-10 flow being re-<br>placed by the 11-th flow. We also want our metric to be zero<br>when the detection and ranking of the top flows are correct.</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:96"><nobr><span class="ft5">We introduce our performance metric using the ranking</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:83"><nobr><span class="ft10">problem. The performance metric for the detection prob-<br>lem is a straightforward extension. Let's form all flow pairs<br>where the first element of a pair is a flow in the top t and<br>the second element is anywhere in the sorted list of the<br>N original flows. The number of these pairs is equal to<br>N - 1 + N - 2 + · · · + N - t = (2N - t - 1)t/2. We then count<br>the pairs in this set that are misranked after sampling and<br>we take the sum as our metric for ranking accuracy. This</span></nobr></DIV>
<DIV style="position:absolute;top:1025;left:83"><nobr><span class="ft2">3</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:90"><nobr><span class="ft5">For S</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:123"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:135"><nobr><span class="ft5">&lt; S</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:159"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:165"><nobr><span class="ft5">, we are interested in P {s</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:324"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:334"><nobr><span class="ft5"> s</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:355"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:361"><nobr><span class="ft5">}. According</span></nobr></DIV>
<DIV style="position:absolute;top:1041;left:83"><nobr><span class="ft17">to Tchebychev inequality, this probability can be supposed<br>to behave like VAR[s</span></nobr></DIV>
<DIV style="position:absolute;top:1062;left:208"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:216"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:1062;left:235"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:241"><nobr><span class="ft5">]/E [s</span></nobr></DIV>
<DIV style="position:absolute;top:1062;left:274"><nobr><span class="ft2">1</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:283"><nobr><span class="ft5">- s</span></nobr></DIV>
<DIV style="position:absolute;top:1062;left:303"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:309"><nobr><span class="ft5">]</span></nobr></DIV>
<DIV style="position:absolute;top:1054;left:313"><nobr><span class="ft2">2</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:319"><nobr><span class="ft5">, which is the square</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:83"><nobr><span class="ft5">of the coefficient of variation.</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:477"><nobr><span class="ft10">sum indicates how good the ranking is at the top of the list.<br>It is equal to zero when the ranking is correct. When the<br>ranking is not correct, it takes a value proportional to the<br>original rank of the flows that have taken a slot in the top-t<br>list. For example, if the top flow is replaced by its immediate<br>successor in the list, the metric will return a ranking error<br>of 1. Instead, if the same flow is replaced by a distant flow,<br>say the 100-th, the metric will return an error of 99. Also,<br>note that our metric does not account for any misranking of<br>flows outside the list of top t flows. For any two flows n and<br>m, such that n &gt; m &gt; t, the fact that n takes the position<br>of m does not add anything to our performance metric since<br>our metric requires at least one element of a flow pair to be<br>in the original list of top t flows.</span></nobr></DIV>
<DIV style="position:absolute;top:310;left:491"><nobr><span class="ft5">In the detection problem, we are no longer interested in</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:477"><nobr><span class="ft10">comparing flow pairs whose both elements are in the top t<br>list. We are only interested in the ranking between flows<br>in the top t list and those outside the list. Therefore, our<br>detection metric is defined as the number of misranked flow<br>pairs, where the first element of a pair is in the list of top t<br>flows and the second element is outside this list (non top t).</span></nobr></DIV>
<DIV style="position:absolute;top:420;left:491"><nobr><span class="ft5">The above metrics return one value for each realization</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:477"><nobr><span class="ft10">of flow sizes and of sampled packets. Given that we want<br>to account for all realizations, we define the performance<br>metrics as the number of misranked flow pairs averaged over<br>all possible values of flow sizes in the original list of N flows<br>and over all sampling runs. We deem the ranking/detection<br>as acceptable when our metric takes a value below one (i.e.,<br>on average less than one flow pair is misranked).</span></nobr></DIV>
<DIV style="position:absolute;top:545;left:491"><nobr><span class="ft5">In addition to the above, our metrics have the advantage</span></nobr></DIV>
<DIV style="position:absolute;top:561;left:477"><nobr><span class="ft10">of being easily and exactly calculable. Performance metrics<br>based on probabilities (e.g.,[12]) require lot of assumptions<br>that make them only suitable for computing bounds, but<br>not exact values.</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:477"><nobr><span class="ft4"><b>4.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:635;left:518"><nobr><span class="ft18"><b>Computation of the performance metric<br>for the ranking problem</b></span></nobr></DIV>
<DIV style="position:absolute;top:672;left:491"><nobr><span class="ft5">Consider a flow of i packets belonging to the list of top t</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:477"><nobr><span class="ft10">flows in the original traffic (before sampling). First, we com-<br>pute the probability that this flow is misranked with another<br>flow of general size and general position. Denote this prob-<br>ability by P</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:549"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:564"><nobr><span class="ft5">(i), where m stands for misranking and t for</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:477"><nobr><span class="ft5">top. Then, we average over all values of i to get ¯</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:769"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:756;left:778"><nobr><span class="ft2">mt4</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:799"><nobr><span class="ft5">. This</span></nobr></DIV>
<DIV style="position:absolute;top:767;left:477"><nobr><span class="ft10">latter function gives us the probability that, on average, the<br>top t-th flow is misranked with another flow. Thus, our per-<br>formance metric, which is defined as the average number of<br>misranked flow pairs where at least one element of a pair<br>is in the top t, is equal to (2N - t - 1)t ¯</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:730"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:739"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:754"><nobr><span class="ft5">/2. Next, we</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:477"><nobr><span class="ft5">compute the value of ¯</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:609"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:617"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:632"><nobr><span class="ft5">.</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:491"><nobr><span class="ft5">Let p</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:524"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:535"><nobr><span class="ft5">denote the probability that the size of a general</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:477"><nobr><span class="ft5">flow is equal to i packets, and P</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:673"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:682"><nobr><span class="ft5">denote the flow size com-</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:477"><nobr><span class="ft5">plementary cumulative distribution, i.e., P</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:734"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:743"><nobr><span class="ft5">=</span></nobr></DIV>
<DIV style="position:absolute;top:890;left:772"><nobr><span class="ft19"><br>j=i</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:793"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:800"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:805"><nobr><span class="ft5">. For</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:477"><nobr><span class="ft10">a large number of flows N and a high degree of multiplexing,<br>we consider safe to assume that flow sizes are independent<br>of each other (see [2] for a study of the flow size correlation<br>on a OC-12 IP backbone link). A flow of size i belongs to<br>the list of top t flows if the number of flows in the original<br>total list, with a size larger than i, is less or equal than t - 1.<br>Since each flow can be larger than i with probability P</span></nobr></DIV>
<DIV style="position:absolute;top:1007;left:810"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:1002;left:820"><nobr><span class="ft5">in-</span></nobr></DIV>
<DIV style="position:absolute;top:1018;left:477"><nobr><span class="ft10">dependently of the other flows, we can write the probability<br>that a flow of size i belongs to the list of the top t flows</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:478"><nobr><span class="ft2">4</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:484"><nobr><span class="ft5">Note that the distribution of the size of a flow at the top</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">of the list is different from that of a generic flow.</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">192</span></nobr></DIV>
</DIV>
<!-- Page 6 -->
<a name="6"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft20{font-size:9px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163006.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft5">as P</span></nobr></DIV>
<DIV style="position:absolute;top:95;left:111"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:116"><nobr><span class="ft5">(i, t, N ) =</span></nobr></DIV>
<DIV style="position:absolute;top:88;left:201"><nobr><span class="ft19">t-1<br>k=0</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:224"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:95;left:230"><nobr><span class="ft2">P</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:237"><nobr><span class="ft12">i</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:242"><nobr><span class="ft5">(k, N - 1), where b</span></nobr></DIV>
<DIV style="position:absolute;top:95;left:365"><nobr><span class="ft2">P</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:372"><nobr><span class="ft12">i</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:378"><nobr><span class="ft5">(k, N - 1)</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:83"><nobr><span class="ft10">is the probability to obtain k successes out of N - 1 tri-<br>als, P</span></nobr></DIV>
<DIV style="position:absolute;top:127;left:117"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:127"><nobr><span class="ft5">being the probability of a success. The probability</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:83"><nobr><span class="ft10">that the t-th largest flow has a size of i packets is equal<br>to P</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:109"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:114"><nobr><span class="ft5">(i) = p</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:155"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:160"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:168"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:173"><nobr><span class="ft5">(i, t, N )/ ¯</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:226"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:234"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:239"><nobr><span class="ft5">(t, N ). ¯</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:284"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:158;left:293"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:298"><nobr><span class="ft5">(t, N ) is the probability</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:83"><nobr><span class="ft10">that a flow of general size is among the top t in the original<br>total list, which is simply equal to t/N .</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:96"><nobr><span class="ft5">Using the above notation, one can write the misranking</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:83"><nobr><span class="ft10">probability between a top t flow of original size i packets<br>and any other flow as follows</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:92"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:101"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:116"><nobr><span class="ft5">(i) =</span></nobr></DIV>
<DIV style="position:absolute;top:261;left:177"><nobr><span class="ft5">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:151"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:284;left:160"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:165"><nobr><span class="ft5">(i, t, N )</span></nobr></DIV>
<DIV style="position:absolute;top:257;left:226"><nobr><span class="ft2">i-1</span></nobr></DIV>
<DIV style="position:absolute;top:289;left:226"><nobr><span class="ft2">j=1</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:248"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:255"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:261"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:269"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:274"><nobr><span class="ft5">(i, t, N - 1)P</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:352"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:363"><nobr><span class="ft5">(j, i)+</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:203"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:337;left:200"><nobr><span class="ft2">j=i</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:221"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:228"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:234"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:243"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:248"><nobr><span class="ft5">(i, t - 1, N - 1)P</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:349"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:360"><nobr><span class="ft5">(i, j) .</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:424"><nobr><span class="ft5">(8)</span></nobr></DIV>
<DIV style="position:absolute;top:358;left:83"><nobr><span class="ft10">In this expression, we sum over all possible original sizes<br>of the other flow (the variable j) and we separate the case<br>when this other flow is smaller than i from the case when it<br>is larger than i</span></nobr></DIV>
<DIV style="position:absolute;top:403;left:179"><nobr><span class="ft2">5</span></nobr></DIV>
<DIV style="position:absolute;top:405;left:185"><nobr><span class="ft5">. P</span></nobr></DIV>
<DIV style="position:absolute;top:410;left:205"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:405;left:216"><nobr><span class="ft5">(i, j) is the misranking probability of</span></nobr></DIV>
<DIV style="position:absolute;top:420;left:83"><nobr><span class="ft10">two flows of sizes i and j packets, which we calculated in the<br>previous section for the two ranking methods. ¯</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:371"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:441;left:380"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:400"><nobr><span class="ft5">is then</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:83"><nobr><span class="ft5">equal to</span></nobr></DIV>
<DIV style="position:absolute;top:449;left:151"><nobr><span class="ft19"><br>i=1</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:172"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:180"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:185"><nobr><span class="ft5">(i)P</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:210"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:452;left:225"><nobr><span class="ft5">(i).</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:96"><nobr><span class="ft5">For protocol-aware ranking, P</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:285"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:296"><nobr><span class="ft5">(i, j) is given explicitly</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:83"><nobr><span class="ft10">in Proposition 2 and can be easily computed. For blind<br>ranking, we use the Gaussian approximation summarized in<br>Proposition 2, which we recall holds when at least one of the<br>two flows to be compared is large.</span></nobr></DIV>
<DIV style="position:absolute;top:558;left:83"><nobr><span class="ft4"><b>4.3</b></span></nobr></DIV>
<DIV style="position:absolute;top:558;left:123"><nobr><span class="ft18"><b>Computation of the performance metric<br>for the detection problem</b></span></nobr></DIV>
<DIV style="position:absolute;top:593;left:96"><nobr><span class="ft5">Consider the probability that a flow among the top t is</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:83"><nobr><span class="ft5">swapped with a flow that does belong to the top t. Let</span></nobr></DIV>
<DIV style="position:absolute;top:618;left:86"><nobr><span class="ft5">¯</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:83"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:91"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:112"><nobr><span class="ft5">denote this probability. Following the same approach</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:83"><nobr><span class="ft5">described in Section 4, we can write</span></nobr></DIV>
<DIV style="position:absolute;top:673;left:144"><nobr><span class="ft20">¯</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:141"><nobr><span class="ft20">P</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:149"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:167"><nobr><span class="ft20">= 1</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:185"><nobr><span class="ft20">¯</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:182"><nobr><span class="ft20">P</span></nobr></DIV>
<DIV style="position:absolute;top:691;left:190"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:664;left:206"><nobr><span class="ft2"></span></nobr></DIV>
<DIV style="position:absolute;top:693;left:203"><nobr><span class="ft2">i=1</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:224"><nobr><span class="ft2">i-1</span></nobr></DIV>
<DIV style="position:absolute;top:693;left:223"><nobr><span class="ft2">j=1</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:244"><nobr><span class="ft20">p</span></nobr></DIV>
<DIV style="position:absolute;top:680;left:251"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:255"><nobr><span class="ft20">p</span></nobr></DIV>
<DIV style="position:absolute;top:680;left:262"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:268"><nobr><span class="ft20">P</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:276"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:284"><nobr><span class="ft20">(j, i, t, N )P</span></nobr></DIV>
<DIV style="position:absolute;top:680;left:344"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:355"><nobr><span class="ft20">(j, i).</span></nobr></DIV>
<DIV style="position:absolute;top:718;left:83"><nobr><span class="ft5">To get this expression for ¯</span></nobr></DIV>
<DIV style="position:absolute;top:718;left:252"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:261"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:718;left:275"><nobr><span class="ft5">, we sum over all possible</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:83"><nobr><span class="ft10">values for the size of the flow in the top t (index i) and<br>all possible values for the size of the other flow not among<br>the top t (index j). In this expression, p</span></nobr></DIV>
<DIV style="position:absolute;top:770;left:331"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:765;left:341"><nobr><span class="ft5">and p</span></nobr></DIV>
<DIV style="position:absolute;top:770;left:375"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:765;left:386"><nobr><span class="ft5">represent</span></nobr></DIV>
<DIV style="position:absolute;top:781;left:83"><nobr><span class="ft10">the probability that the size of a flow is equal to i or j<br>packets, respectively. P</span></nobr></DIV>
<DIV style="position:absolute;top:802;left:231"><nobr><span class="ft2">m</span></nobr></DIV>
<DIV style="position:absolute;top:796;left:241"><nobr><span class="ft5">(j, i) is the probability that two</span></nobr></DIV>
<DIV style="position:absolute;top:812;left:83"><nobr><span class="ft10">flows of sizes i and j are misranked ­ it is given by the<br>Gaussian approximation described in Proposition 1 for the<br>blind method and the result stated in Proposition 2 for the<br>protocol-aware method. P</span></nobr></DIV>
<DIV style="position:absolute;top:865;left:239"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:859;left:248"><nobr><span class="ft5">(j, i, t, N ) is the joint probability</span></nobr></DIV>
<DIV style="position:absolute;top:875;left:83"><nobr><span class="ft10">that a flow of size i belongs to the list of the top t flows while<br>another flow of size j does not belong to it (i.e., it is in the<br>bottom N - t flows). ¯</span></nobr></DIV>
<DIV style="position:absolute;top:906;left:214"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:223"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:906;left:236"><nobr><span class="ft5">is the joint probability that a flow</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:83"><nobr><span class="ft10">of any size belongs to the list of the top t flows while another<br>flow of any size does not belong to this list. It is equal to<br>t(N - t)/(N (N - 1)).</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:96"><nobr><span class="ft5">We now compute P</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:216"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:224"><nobr><span class="ft5">(j, i, t, N ) for j &lt; i, i.e., the proba-</span></nobr></DIV>
<DIV style="position:absolute;top:985;left:83"><nobr><span class="ft10">bility that flow i belongs to the top list while flow j does<br>not. The number of flows larger than i should be smaller<br>than t, while the number of flows larger than j should be<br>larger than t. The probability that a flow size is larger than</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:83"><nobr><span class="ft2">5</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:90"><nobr><span class="ft5">In the case j  i, at most t - 2 flows can be larger than i</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:83"><nobr><span class="ft5">packets if we want the flow of size i to be in the top t.</span></nobr></DIV>
<DIV style="position:absolute;top:87;left:502"><nobr><span class="ft20">Trace</span></nobr></DIV>
<DIV style="position:absolute;top:87;left:635"><nobr><span class="ft20">Jussieu</span></nobr></DIV>
<DIV style="position:absolute;top:87;left:741"><nobr><span class="ft20">Abilene</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:502"><nobr><span class="ft20">Link speed</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:613"><nobr><span class="ft20">GigE (1 Gbps)</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:712"><nobr><span class="ft20">OC-48 (2.5 Gbps)</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:502"><nobr><span class="ft20">Duration</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:634"><nobr><span class="ft20">2 hours</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:731"><nobr><span class="ft20">30 minutes</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:502"><nobr><span class="ft20">TCP connections</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:642"><nobr><span class="ft20">11M</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:749"><nobr><span class="ft20">15M</span></nobr></DIV>
<DIV style="position:absolute;top:143;left:502"><nobr><span class="ft20">Packets</span></nobr></DIV>
<DIV style="position:absolute;top:143;left:639"><nobr><span class="ft20">112M</span></nobr></DIV>
<DIV style="position:absolute;top:143;left:746"><nobr><span class="ft20">125M</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:546"><nobr><span class="ft5">Table 1: Summary of the traces</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:477"><nobr><span class="ft5">i is P</span></nobr></DIV>
<DIV style="position:absolute;top:221;left:508"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:517"><nobr><span class="ft5">=</span></nobr></DIV>
<DIV style="position:absolute;top:213;left:546"><nobr><span class="ft19"><br>k=i</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:568"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:221;left:574"><nobr><span class="ft2">k</span></nobr></DIV>
<DIV style="position:absolute;top:216;left:581"><nobr><span class="ft5">. The probability that it is larger than j is</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:477"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:237;left:486"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:496"><nobr><span class="ft5">=</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:526"><nobr><span class="ft19"><br>k=j</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:549"><nobr><span class="ft5">p</span></nobr></DIV>
<DIV style="position:absolute;top:237;left:556"><nobr><span class="ft2">k</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:563"><nobr><span class="ft5">. The probability that a flow size is between</span></nobr></DIV>
<DIV style="position:absolute;top:249;left:477"><nobr><span class="ft5">j and i given that it is smaller than i is (P</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:735"><nobr><span class="ft2">j</span></nobr></DIV>
<DIV style="position:absolute;top:249;left:744"><nobr><span class="ft5">- P</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:767"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:249;left:772"><nobr><span class="ft5">)/(1 - P</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:822"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:249;left:827"><nobr><span class="ft5">).</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:477"><nobr><span class="ft5">We call it P</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:549"><nobr><span class="ft2">j,i</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:562"><nobr><span class="ft5">. It follows that:</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:479"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:487"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:496"><nobr><span class="ft5">(j, i, t, N ) =</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:572"><nobr><span class="ft2">t-1</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:571"><nobr><span class="ft2">k=0</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:594"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:308;left:599"><nobr><span class="ft2">P</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:606"><nobr><span class="ft12">i</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:612"><nobr><span class="ft5">(k, N - 2)</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:678"><nobr><span class="ft2">N -k-2</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:675"><nobr><span class="ft2">l=t-k-1</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:722"><nobr><span class="ft5">b</span></nobr></DIV>
<DIV style="position:absolute;top:308;left:728"><nobr><span class="ft2">P</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:735"><nobr><span class="ft12">j,i</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:749"><nobr><span class="ft5">(l, N - k - 2).</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:477"><nobr><span class="ft10">The first sum accounts for the probability to see less than t<br>flows above i packets. The second sum accounts for the<br>probability to see more than t flows above j given that<br>k flows (k &lt; t) were already seen above i. For t = 1,<br>P</span></nobr></DIV>
<DIV style="position:absolute;top:410;left:486"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:494"><nobr><span class="ft5">(j, i, t, N ) is no other than P</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:668"><nobr><span class="ft2">t</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:673"><nobr><span class="ft5">(i, t, N - 1), and both ¯</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:812"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:410;left:821"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:419;left:477"><nobr><span class="ft5">and ¯</span></nobr></DIV>
<DIV style="position:absolute;top:419;left:504"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:425;left:512"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:419;left:531"><nobr><span class="ft5">are equal (i.e., the ranking and the detection prob-</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:477"><nobr><span class="ft5">lems are the same).</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:491"><nobr><span class="ft5">Once ¯</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:525"><nobr><span class="ft5">P</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:534"><nobr><span class="ft2">mt</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:552"><nobr><span class="ft5">is computed, we multiply it by the total number</span></nobr></DIV>
<DIV style="position:absolute;top:466;left:477"><nobr><span class="ft10">of flow pairs whose one element is in the top t and the other<br>one is not. This total number is equal to t(N -t). Our metric<br>for the detection problem is the result of this multiplication.<br>As for the ranking problem, we want this metric to be less<br>than one for the detection of the top t flows to be accurate.</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:477"><nobr><span class="ft4"><b>5.</b></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:509"><nobr><span class="ft4"><b>NUMERICAL RESULTS</b></span></nobr></DIV>
<DIV style="position:absolute;top:584;left:491"><nobr><span class="ft5">We analyze now the accuracy of identifying and ranking</span></nobr></DIV>
<DIV style="position:absolute;top:600;left:477"><nobr><span class="ft10">the largest flows in a packet stream for both the blind and<br>protocol-aware methods. Our metrics require the following<br>input: p</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:526"><nobr><span class="ft2">i</span></nobr></DIV>
<DIV style="position:absolute;top:631;left:531"><nobr><span class="ft5">, the flow size distribution and N , the total number</span></nobr></DIV>
<DIV style="position:absolute;top:647;left:477"><nobr><span class="ft5">of flows observed on the link during the measurement period.</span></nobr></DIV>
<DIV style="position:absolute;top:663;left:491"><nobr><span class="ft5">To derive realistic values for these two quantities, we con-</span></nobr></DIV>
<DIV style="position:absolute;top:678;left:477"><nobr><span class="ft10">sider two publicly available packet-level traces. The first<br>trace is Abilene-I collected by NLANR [15] on an OC-48<br>(2.5 Gbps) link on the Abilene Network [1]. The second<br>trace has been collected by the Metropolis project [13] on<br>a Gigabit Ethernet access link from the Jussieu University<br>campus in Paris to the Renater Network [18]. Table 1 sum-<br>marizes the characteristics of the two traces.</span></nobr></DIV>
<DIV style="position:absolute;top:788;left:491"><nobr><span class="ft5">We model the flow size distribution in the traces with</span></nobr></DIV>
<DIV style="position:absolute;top:804;left:477"><nobr><span class="ft10">Pareto. We opted for Pareto since it is known to be appro-<br>priate to model flow sizes in the Internet due to its heavy<br>tailed feature [6]. Note that it is not our goal to find an ac-<br>curate approximation of the distribution of flow sizes in our<br>traces, but rather to find a general, well-known, distribution<br>that approaches the actual flow size. In this section we an-<br>alyze a wide range of parameters while Section 6 focuses on<br>the performance we observe in the two packet-level traces.</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:491"><nobr><span class="ft5">The Pareto distribution is continuous with a complemen-</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:477"><nobr><span class="ft10">tary cumulative distribution function given by P {S &gt; x} =<br>(x/a)</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:510"><nobr><span class="ft2">-</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:526"><nobr><span class="ft5">.  &gt; 0 is a parameter describing the shape of the</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:477"><nobr><span class="ft10">distribution and a &gt; 0 is a parameter describing its scale.<br>The Pareto random variable takes values larger than a, and<br>has an average value equal to a/( - 1). The tail of the<br>Pareto distribution becomes heavier as  decreases.</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:491"><nobr><span class="ft5">We use our traces to derive an indicative value of the</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:477"><nobr><span class="ft10">shape parameter . To this end, we compute the empirical<br>complementary cumulative distribution of flow sizes and we</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">193</span></nobr></DIV>
</DIV>
<!-- Page 7 -->
<a name="7"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft21{font-size:3px;font-family:Helvetica;color:#000000;}
	.ft22{font-size:1px;font-family:Helvetica;color:#000000;}
	.ft23{font-size:2px;font-family:Helvetica;color:#000000;}
	.ft24{font-size:4px;font-family:Helvetica;color:#000000;}
	.ft25{font-size:3px;line-height:7px;font-family:Helvetica;color:#000000;}
	.ft26{font-size:4px;line-height:7px;font-family:Helvetica;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163007.png" alt="background image">
<DIV style="position:absolute;top:229;left:84"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:90"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:117"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:123"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:150"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:156"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:184"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:190"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:217"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:223"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:229;left:250"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:256"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:221;left:83"><nobr><span class="ft22">-8</span></nobr></DIV>
<DIV style="position:absolute;top:207;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:205;left:83"><nobr><span class="ft22">-7</span></nobr></DIV>
<DIV style="position:absolute;top:190;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:83"><nobr><span class="ft22">-6</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:83"><nobr><span class="ft22">-5</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:155;left:83"><nobr><span class="ft22">-4</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:83"><nobr><span class="ft22">-3</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:83"><nobr><span class="ft22">-2</span></nobr></DIV>
<DIV style="position:absolute;top:108;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:83"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:77"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:149"><nobr><span class="ft21">Flow size in Kbytes</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:74"><nobr><span class="ft21">Complementary CDF</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:207"><nobr><span class="ft25">Abilene trace<br>x</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:210"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:280"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:286"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:313"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:319"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:347"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:352"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:380"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:386"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:413"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:419"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:446"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:452"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:279"><nobr><span class="ft22">-7</span></nobr></DIV>
<DIV style="position:absolute;top:203;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:279"><nobr><span class="ft22">-6</span></nobr></DIV>
<DIV style="position:absolute;top:184;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:182;left:279"><nobr><span class="ft22">-5</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:163;left:279"><nobr><span class="ft22">-4</span></nobr></DIV>
<DIV style="position:absolute;top:147;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:145;left:279"><nobr><span class="ft22">-3</span></nobr></DIV>
<DIV style="position:absolute;top:128;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:126;left:279"><nobr><span class="ft22">-2</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:107;left:279"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:273"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:279"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:345"><nobr><span class="ft21">Flow size in Kbytes</span></nobr></DIV>
<DIV style="position:absolute;top:179;left:270"><nobr><span class="ft21">Complementary CDF</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:410"><nobr><span class="ft25">Jussieu trace<br>x</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:413"><nobr><span class="ft23">-1.5</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:118"><nobr><span class="ft5">Figure 1: Empirical flow size distribution</span></nobr></DIV>
<DIV style="position:absolute;top:303;left:83"><nobr><span class="ft10">plot it on a log-log scale. A heavy-tailed distribution of<br>shape parameter  decays linearly on a log-log scale at rate<br>-. The empirical distributions are shown in Figure 1. The<br>plots show that  equal to 2 suits the Abilene trace and <br>equal to 1.5 suits the Jussieu one. This means that the flow<br>size distribution has a heavier tail in the Jussieu trace.</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:96"><nobr><span class="ft5">Then, we compute the average flow size in packets to get</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:83"><nobr><span class="ft10">the starting point a for the Pareto distribution. As an av-<br>erage flow size we measure 5.76 Kbytes and 7.35 packets on<br>the Abilene trace, and 9.22 Kbytes and 9.9 packets on the<br>Jussieu trace. The total number of flows N is set by taking a<br>measurement interval equal to one minute, then multiplying<br>this interval by the average arrival rate of flows per second<br>on each trace. This gives N = 487 Kflows for the Abilene<br>trace and N = 103 Kflows for the Jussieu one.</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:96"><nobr><span class="ft5">In the rest of this section, all figures plot the ranking met-</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:83"><nobr><span class="ft10">ric versus the packet sampling rate p on a log-log scale. We<br>vary p from 0.1% to 50%. Each figure shows different lines<br>that correspond to different combinations of t, , and N .<br>We are interested in the regions where the value of the met-<br>ric is below one, indicating that the ranking is accurate on<br>average. To ease the interpretation of results in the figures,<br>we plot the horizontal line of ordinate 1.</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:83"><nobr><span class="ft4"><b>5.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:675;left:123"><nobr><span class="ft4"><b>Blind ranking</b></span></nobr></DIV>
<DIV style="position:absolute;top:706;left:87"><nobr><span class="ft14"><i>5.1.1</i></span></nobr></DIV>
<DIV style="position:absolute;top:706;left:136"><nobr><span class="ft14"><i>Impact of the number of flows of interest</i></span></nobr></DIV>
<DIV style="position:absolute;top:726;left:96"><nobr><span class="ft5">The first parameter we study is t, the number of largest</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:83"><nobr><span class="ft10">flows to rank. The purpose is to show how many flows can<br>be detected and ranked correctly for a given sampling rate.<br>We set , N , and the average flow size to the values de-<br>scribed before. The performance of blind ranking the top t<br>flows is shown in Figure 2 for both traces. We observe that<br>the larger the number of top flows of interest, the more dif-<br>ficult it is to detect and rank them correctly. In particular,<br>with a sampling rate on the order of 1%, it is possible to<br>rank at most the top one or two flows. As we focus at larger<br>values of t, the required sampling rate to get a correct rank-<br>ing increases well above 10%. Note that with a sampling<br>rate on the order of 0.1%, it is almost impossible to detect<br>even the largest flow. We also observe that the ranking on<br>the Jussieu trace behaves slightly better than that on the<br>Abilene trace. The Jussieu trace has a heavier tail for its<br>flow size distribution, and so the probability to get larger<br>flows at the top of the list is higher, which makes the rank-<br>ing more accurate. This will be made clear next as we will<br>study the impact of the shape parameter .</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:87"><nobr><span class="ft14"><i>5.1.2</i></span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:136"><nobr><span class="ft14"><i>Impact of the flow size distribution</i></span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:96"><nobr><span class="ft5">We consider the blind ranking of the top 10 flows varying</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:260;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:549"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:609"><nobr><span class="ft24">Abilene trace, N=487K, beta=2, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:765"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:474;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:471;left:549"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:366;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:606"><nobr><span class="ft24">Jussieu trace, N=103K, beta=1.5, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:765"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:477"><nobr><span class="ft10">Figure 2: Performance of blind ranking varying the<br>number t of top flows of interest</span></nobr></DIV>
<DIV style="position:absolute;top:591;left:477"><nobr><span class="ft10">the shape parameter for the Pareto distribution among five<br>distinct values: 3, 2.5, 2, 1.5 and 1.2. Note that for   2<br>the Pareto distribution is known to be heavy tailed (infinite<br>variance). The other parameters of the model (N and the<br>average flow size) are set as before. The values taken by our<br>metric are shown in Figure 3 for both traces. We can make<br>the following observations from the figure:</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:497"><nobr><span class="ft5">· Given a sampling rate, the ranking accuracy improves</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:511"><nobr><span class="ft10">as  becomes smaller, i.e., the tail of the flow size<br>distribution becomes heavier. Indeed, when the distri-<br>bution tail becomes heavier, the probability to obtain<br>larger flows at the top of the list increases, and since it<br>is simpler to blindly rank larger flows (for distributions<br>satisfying the square root condition, see Section 3.1.1),<br>the ranking becomes more accurate.</span></nobr></DIV>
<DIV style="position:absolute;top:850;left:497"><nobr><span class="ft5">· The ranking is never correct unless the sampling rate is</span></nobr></DIV>
<DIV style="position:absolute;top:866;left:511"><nobr><span class="ft10">very high. In our setting, one needs to sample at more<br>than 50% to obtain an average number of misranked<br>flow pairs below one for a value of  equal to 1.5 (i.e,<br>heavy tailed distribution), and at more than 10% for<br>a value of  equal to 1.2 (i.e., pronounced heavy tailed<br>distribution). For larger values of  (i.e., lighter tail),<br>the sampling rate needs to be as high as 100%.</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:481"><nobr><span class="ft14"><i>5.1.3</i></span></nobr></DIV>
<DIV style="position:absolute;top:988;left:531"><nobr><span class="ft14"><i>Impact of the total number of flows</i></span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:491"><nobr><span class="ft5">Another important parameter in the ranking problem is</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:477"><nobr><span class="ft10">N , the total number of flows available during the measure-<br>ment period. When N increases, the flows at the top of<br>the list should become larger, and therefore as we saw in<br>Section 3.1.1, the blind ranking accuracy should improve</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">194</span></nobr></DIV>
</DIV>
<!-- Page 8 -->
<a name="8"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1268" src="163008.png" alt="background image">
<DIV style="position:absolute;top:285;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:276;left:154"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:256;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:233;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:154"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:154"><nobr><span class="ft23">3</span></nobr></DIV>
<DIV style="position:absolute;top:166;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:163;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:143;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:154"><nobr><span class="ft23">5</span></nobr></DIV>
<DIV style="position:absolute;top:120;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:98;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:154"><nobr><span class="ft23">7</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:206"><nobr><span class="ft24">Abilene trace, N = 487K, t = 10 flows, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:359"><nobr><span class="ft26">beta=3<br>beta=2.5<br>beta=2<br>beta=1.5<br>beta=1.2</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:154"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:469;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:444;left:154"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:424;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:154"><nobr><span class="ft23">3</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:377;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:357;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:354;left:154"><nobr><span class="ft23">5</span></nobr></DIV>
<DIV style="position:absolute;top:334;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:332;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:154"><nobr><span class="ft23">7</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:206"><nobr><span class="ft24">Jussieu trace, N = 103K, t = 10 flows, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:359"><nobr><span class="ft26">beta=3<br>beta=2.5<br>beta=2<br>beta=1.5<br>beta=1.2</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:83"><nobr><span class="ft10">Figure 3: Performance of blind ranking varying the<br>shape parameter of the flow size distribution</span></nobr></DIV>
<DIV style="position:absolute;top:596;left:83"><nobr><span class="ft10">for flow size distributions satisfying the square root condi-<br>tion (in particular the Pareto distribution we are considering<br>here). N varies with the utilization of the monitored link ­<br>the higher the utilization, the larger the number of flows. N<br>can also vary with the duration of the measurement period<br>­ the longer we wait before ranking and reporting results,<br>the larger the number of flows.</span></nobr></DIV>
<DIV style="position:absolute;top:706;left:96"><nobr><span class="ft5">We study the impact of N on the blind ranking accu-</span></nobr></DIV>
<DIV style="position:absolute;top:721;left:83"><nobr><span class="ft10">racy. We take the same value of N used in the previous<br>sections and computed over one minute measurement pe-<br>riod (487 Kflows for the Abilene trace and 103 Kflows for<br>the Jussieu trace), then we multiply it by some constant<br>factor ranging from 0.5 (2 times fewer flows) to 5 (5 times<br>more flows). Results are shown in Figure 4. The lines in<br>the figures correspond to a factor value equal to: 0.5, 1,<br>2.5, and 5. In these figures, we consider the ranking of the<br>top 10 flows with the values of  and average flow size set<br>from the traces. Clearly, the ranking accuracy improves as<br>N increases. However, in our setting, this improvement is<br>still not enough to allow a perfect ranking. One can always<br>imagine increasing N (e.g., by increasing the measurement<br>period) until the top t flows are extremely large and hence,<br>perfectly detected and ranked.</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:83"><nobr><span class="ft4"><b>5.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:972;left:123"><nobr><span class="ft4"><b>Protocol-aware ranking</b></span></nobr></DIV>
<DIV style="position:absolute;top:992;left:96"><nobr><span class="ft5">Protocol-aware ranking takes advantage of the informa-</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:83"><nobr><span class="ft10">tion carried in the transport header of the sampled packets<br>to infer the number of non-sampled packets of a flow. We<br>use our model to check whether this improvement exists and<br>to evaluate it. Remember that we are always in the context<br>of low retransmission and duplication rates, which is neces-</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:276;left:549"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:252;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:250;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:549"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:175;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:549"><nobr><span class="ft23">3</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:147;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:124;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:549"><nobr><span class="ft23">5</span></nobr></DIV>
<DIV style="position:absolute;top:98;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:612"><nobr><span class="ft24">Abilene trace, beta=2, t = 10, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:755"><nobr><span class="ft26">N=244K<br>N=487K<br>N=1.2M<br>N=2.4M</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:549"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:466;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:549"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:389;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:549"><nobr><span class="ft23">3</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:335;left:549"><nobr><span class="ft23">5</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:610"><nobr><span class="ft24">Jussieu trace, beta = 2, t = 10, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:755"><nobr><span class="ft26">N=52K<br>N=103K<br>N=258K<br>N=515K</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:477"><nobr><span class="ft10">Figure 4: Performance of blind ranking varying the<br>total number of flows</span></nobr></DIV>
<DIV style="position:absolute;top:595;left:477"><nobr><span class="ft10">sary to remove the discrepancy between carried data volume<br>(throughput) and application data volume (goodput).</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:491"><nobr><span class="ft5">Using the previous values for N ,  and average flow size,</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:477"><nobr><span class="ft10">we reproduce Figure 2, but this time for the protocol-aware<br>case. This leads to Figure 5, which illustrates the impact of<br>the number of largest flows to rank. For lack of space, we<br>omit the other figures.</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:491"><nobr><span class="ft5">We compare this new figure to its counterpart in the blind</span></nobr></DIV>
<DIV style="position:absolute;top:720;left:477"><nobr><span class="ft5">case. We make the following two observations:</span></nobr></DIV>
<DIV style="position:absolute;top:736;left:491"><nobr><span class="ft5">(i) The protocol-aware method improves the accuracy of</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:477"><nobr><span class="ft10">the largest flows ranking by an order of magnitude for high<br>sampling rates (above 1%). For example, for the Abilene<br>trace, a sampling rate on the order of 50% was necessary to<br>detect and rank the largest 5 flows with the blind method.<br>Now, with the protocol-aware method, a sampling rate on<br>the order of 5% is sufficient. The same conclusion applies<br>to the Jussieu trace. A sampling rate on the order of 10%<br>is needed. With the protocol-aware method, it becomes on<br>the order of 1%.</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:491"><nobr><span class="ft5">(ii) The protocol-aware method does not improve the per-</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:477"><nobr><span class="ft10">formance when applied at low sampling rates (above 1%).<br>This can be clearly seen if we compare the plots between<br>both figures for sampling rates below 1%. This results con-<br>firms our observations in Section 3.3.2.</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:477"><nobr><span class="ft4"><b>5.3</b></span></nobr></DIV>
<DIV style="position:absolute;top:988;left:518"><nobr><span class="ft4"><b>Largest flows detection</b></span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:491"><nobr><span class="ft5">To illustrate the difference between ranking and detection,</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:477"><nobr><span class="ft10">we consider the same scenario as in Section 5.1.1. We plot<br>the detection metric as a function of the sampling rate for<br>different values of t (the number of top flows of interest) and<br>for both Abilene and Jussieu traces. This gives Figure 6 for</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">195</span></nobr></DIV>
</DIV>
<!-- Page 9 -->
<a name="9"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1268" src="163009.png" alt="background image">
<DIV style="position:absolute;top:285;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:260;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:154"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:200"><nobr><span class="ft24">Abilene trace, N=487K, beta=2, protocol-aware ranking</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:370"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:474;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:471;left:154"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:366;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:197"><nobr><span class="ft24">Jussieu trace, N=103K, beta=1.5, protocol-aware ranking</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:370"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:83"><nobr><span class="ft10">Figure 5: Performance of protocol-aware ranking<br>varying the number t of top flows of interest</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:83"><nobr><span class="ft10">blind ranking and Figure 7 for protocol-aware ranking. A<br>comparison between these results and their counterparts in<br>Figure 2 and 5, respectively, shows a significant improve-<br>ment in the detection case for both ranking methods. All<br>plots are shifted down by an order of magnitude. For ex-<br>ample, in the case of blind ranking, the required sampling<br>rate to correctly rank the top 5 flows was around 50% for<br>the Abilene trace and 10% for the Jussieu trace. Now, with<br>blind detection, it is around 10% and 3%, respectively. An-<br>other example is with the protocol-aware method where a<br>sampling rate around 10% was required to rank the largest<br>10 flows (Figure 5), whereas now, a sampling rate around<br>1% is sufficient to only detect them. The same gain can be<br>observed if we reconsider the other scenarios in Section 5.1<br>(not presented here for lack of space). Also, note how in<br>the detection case the protocol aware method allows a bet-<br>ter accuracy for high sampling rates when compared to the<br>blind method. For low sampling rates (e.g., below 1%), the<br>accuracy does not improve.</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:83"><nobr><span class="ft4"><b>6.</b></span></nobr></DIV>
<DIV style="position:absolute;top:909;left:114"><nobr><span class="ft4"><b>EXPERIMENTAL RESULTS</b></span></nobr></DIV>
<DIV style="position:absolute;top:929;left:96"><nobr><span class="ft5">In this section we present the results of running random</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:83"><nobr><span class="ft10">sampling experiments directly on the packet traces. We use<br>the traces described in Section 5 and compute the perfor-<br>mance metrics defined in Section 4.1.</span></nobr></DIV>
<DIV style="position:absolute;top:992;left:96"><nobr><span class="ft5">In our traces we consider only TCP packets. Since TCP</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:83"><nobr><span class="ft10">sequence numbers count bytes, we express the flow sizes in<br>bytes instead of packets throughout this section.</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:96"><nobr><span class="ft5">Our experiments are meant to address four major issues</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:83"><nobr><span class="ft10">that arise when we move from the analytical study to a real<br>network setting: (i) how to deal with invalid TCP sequence</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:260;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:549"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:606"><nobr><span class="ft24">Abilene trace, N=487K, beta=2, blind detection</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:765"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:549"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:556"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:635"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:642"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:719"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:726"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:474;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:471;left:549"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:549"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:549"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:366;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:549"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:542"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:549"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:635"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:538"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:603"><nobr><span class="ft24">Jussieu trace, N=103K, beta=1.5, blind detection</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:765"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:477"><nobr><span class="ft10">Figure 6: Only detecting the largest flows: Perfor-<br>mance of blind ranking varying the number t of top<br>flows of interest</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:477"><nobr><span class="ft10">numbers in the packet stream; (ii) the importance of flow<br>size distributions and duration of the measurement interval;<br>(iii) the impact of packet loss rates on individual flows ­<br>lost packets trigger retransmissions by the TCP senders; (iv)<br>the variability of the detection/ranking performance across<br>multiple bins and packet sampling patterns.</span></nobr></DIV>
<DIV style="position:absolute;top:719;left:477"><nobr><span class="ft4"><b>6.1</b></span></nobr></DIV>
<DIV style="position:absolute;top:719;left:518"><nobr><span class="ft18"><b>Implementation of protocol-aware<br>ranking</b></span></nobr></DIV>
<DIV style="position:absolute;top:757;left:491"><nobr><span class="ft5">The protocol-aware method depends on TCP sequence</span></nobr></DIV>
<DIV style="position:absolute;top:772;left:477"><nobr><span class="ft10">numbers to perform the ranking. For a given flow, it keeps<br>track of the lowest and highest sequence number observed<br>(taking care of packets that wrap around the sequence num-<br>ber space), s</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:554"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:564"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:825;left:598"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:819;left:608"><nobr><span class="ft5">respectively.</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:491"><nobr><span class="ft5">Note that an actual implementation of this method would</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:477"><nobr><span class="ft10">just require two 32 bit fields per flow to store the two se-<br>quence numbers.</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:491"><nobr><span class="ft5">At the end of the measurement period, we compute the</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:477"><nobr><span class="ft10">difference between the highest and lowest sequence numbers<br>for each sampled flow, and we use the obtained values to<br>rank flows. We then compare this ranking with the one<br>obtained by counting all the bytes each flow transmits in<br>the original non sampled traffic.</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:491"><nobr><span class="ft5">In order to discard invalid packets carrying incorrect se-</span></nobr></DIV>
<DIV style="position:absolute;top:992;left:477"><nobr><span class="ft10">quence numbers that would corrupt the ranking, we im-<br>plement a simple heuristic to update s</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:722"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:734"><nobr><span class="ft5">and s</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:769"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:1008;left:775"><nobr><span class="ft5">. A sam-</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:477"><nobr><span class="ft5">pled packet with sequence number S &gt; s</span></nobr></DIV>
<DIV style="position:absolute;top:1029;left:722"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:733"><nobr><span class="ft5">causes an update</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:477"><nobr><span class="ft5">s</span></nobr></DIV>
<DIV style="position:absolute;top:1044;left:484"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:494"><nobr><span class="ft5"> S if S - s</span></nobr></DIV>
<DIV style="position:absolute;top:1044;left:571"><nobr><span class="ft2">e</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:581"><nobr><span class="ft5">&lt; (  MTU)/p. The same rule applies to</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:477"><nobr><span class="ft5">the updates of s</span></nobr></DIV>
<DIV style="position:absolute;top:1060;left:574"><nobr><span class="ft2">b</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:580"><nobr><span class="ft5">. This way we set a limit on the maximum</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">distance in the sequence space between two sampled pack-</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">196</span></nobr></DIV>
</DIV>
<!-- Page 10 -->
<a name="10"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft27{font-size:3px;line-height:5px;font-family:Helvetica;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163010.png" alt="background image">
<DIV style="position:absolute;top:285;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:260;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:154"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:224;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:197"><nobr><span class="ft24">Abilene trace, N=487K, beta=2, protocol-aware detection</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:370"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:154"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:161"><nobr><span class="ft23">-1</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:240"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:247"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:499;left:325"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:332"><nobr><span class="ft23">1</span></nobr></DIV>
<DIV style="position:absolute;top:474;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:471;left:154"><nobr><span class="ft23">-2</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:154"><nobr><span class="ft23">0</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:154"><nobr><span class="ft23">2</span></nobr></DIV>
<DIV style="position:absolute;top:366;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:154"><nobr><span class="ft23">4</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:147"><nobr><span class="ft24">10</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:154"><nobr><span class="ft23">6</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:240"><nobr><span class="ft24">Packet sampling rate (%)</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:143"><nobr><span class="ft24">Average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:195"><nobr><span class="ft24">Jussieu trace, N=103K, beta=1.5, protocol-aware detection</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:370"><nobr><span class="ft26">t=25<br>t=10<br>t=5<br>t=2<br>t=1</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:83"><nobr><span class="ft10">Figure 7: Only detecting the largest flows: Perfor-<br>mance of protocol-aware ranking varying the num-<br>ber t of top flows of interest</span></nobr></DIV>
<DIV style="position:absolute;top:612;left:83"><nobr><span class="ft10">ets. This distance is inversely proportional to the sampling<br>rate and depends on the Maximum Transmission Unit.</span></nobr></DIV>
<DIV style="position:absolute;top:643;left:96"><nobr><span class="ft5">Furthermore, we use the parameter  that allows to make</span></nobr></DIV>
<DIV style="position:absolute;top:659;left:83"><nobr><span class="ft10">this threshold more or less "permissive" in order to account<br>for the randomness of the sampling process and for other<br>transport-layer events (e.g., packet retransmissions when the<br>TCP window is large). We have run several experiments<br>with different values of  and the results have shown little<br>sensitivity to values of  &gt; 10. All the results in this Section<br>are derived with  = 100.</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:83"><nobr><span class="ft4"><b>6.2</b></span></nobr></DIV>
<DIV style="position:absolute;top:784;left:123"><nobr><span class="ft4"><b>Flow size distribution and measurement</b></span></nobr></DIV>
<DIV style="position:absolute;top:799;left:123"><nobr><span class="ft4"><b>interval</b></span></nobr></DIV>
<DIV style="position:absolute;top:819;left:96"><nobr><span class="ft5">As shown in Figure 1, flow size distributions do not follow</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:83"><nobr><span class="ft10">a perfect Pareto. Furthermore, the measurement interval<br>itself plays a major role in shaping the distribution: it caps<br>the size of the largest flows, that is not unbounded but now<br>depends on the link speed. Indeed, network operators often<br>run measurements using a "binning" method, where packets<br>are sampled for a time interval, classified into flows, ranked,<br>and then reported. At the end of the interval, the memory is<br>cleared and the operation is repeated for the next measure-<br>ment interval. With this binning method, all flows active at<br>the end of the measurement interval are truncated, so that<br>not all sampled packets of the truncated flow are consid-<br>ered at the same time for the ranking. The truncation may,<br>therefore, penalize large flows and alter the tail of the flow<br>size distribution (where flows are of large size and probably<br>last longer than the measurement interval).</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:96"><nobr><span class="ft5">Each experiment consists of the following. We run ran-</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:546"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:552"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:632"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:638"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:717"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:723"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:277;left:546"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:546"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:546"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:546"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:546"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:546"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:124;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:546"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:98;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:546"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:291;left:634"><nobr><span class="ft24">packet sampling rate %</span></nobr></DIV>
<DIV style="position:absolute;top:241;left:536"><nobr><span class="ft24">average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:629"><nobr><span class="ft24">Jussieu trace, blind ranking</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:761"><nobr><span class="ft27">top 1<br>top 2<br>top 5<br>top 10<br>top 25</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:546"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:552"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:632"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:638"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:717"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:723"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:490;left:546"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:466;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:546"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:546"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:546"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:388;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:387;left:546"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:546"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:335;left:546"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:546"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:634"><nobr><span class="ft24">packet sampling rate %</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:536"><nobr><span class="ft24">average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:304;left:614"><nobr><span class="ft24">Jussieu trace, protocol-aware ranking</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:761"><nobr><span class="ft27">top 1<br>top 2<br>top 5<br>top 10<br>top 25</span></nobr></DIV>
<DIV style="position:absolute;top:530;left:477"><nobr><span class="ft10">Figure 8: Performance of blind and protocol-aware<br>ranking on Jussieu trace (60s measurement inter-<br>val).</span></nobr></DIV>
<DIV style="position:absolute;top:615;left:477"><nobr><span class="ft10">dom sampling on the packet traces and classify the sampled<br>packets into flows. At the end of each measurement interval<br>(set to 1 or 5 minutes), we collect the flows and rank them<br>by the number of bytes sampled for each flow. We compare<br>the ranking before and after sampling using our performance<br>metric (Section 4.1). For each sampling rate we conduct 15<br>runs and we calculate averages.</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:491"><nobr><span class="ft5">The results of the experiments confirm the numerical re-</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:477"><nobr><span class="ft10">sults of the previous section. In the interest of space, we<br>plot the results of two representative experiments on which<br>we make several observations. The difference between nu-<br>merical and experimental results, especially at low sampling<br>rates, is caused by the non perfect match of the empirical<br>flow size distribution with Pareto (Figure 1).</span></nobr></DIV>
<DIV style="position:absolute;top:835;left:491"><nobr><span class="ft5">Figure 8 shows the performance of ranking flows on the</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:477"><nobr><span class="ft10">Jussieu trace when the measurement bin is 60s. We consider<br>a wide range of sampling rates from 0.1% to 50% and study<br>the performance when ranking the top 1, 2, 5, 10 and 25<br>flows in the packet stream. The top graph in Figure 8 is de-<br>rived using the blind method while the bottom graph shows<br>the performance of the protocol-aware methods. These re-<br>sults are very similar to the numerical results. For sampling<br>rates above 1%, protocol-aware ranking gives approximately<br>an order of magnitude gain on the performance when com-<br>pared to blind ranking. When the sampling rate is lower<br>than 1%, however, the performance of the two methods is<br>similar. Overall, the blind method requires a sampling rate<br>of 10% to correctly identify the largest flow in the packet<br>stream. The same sampling rate allows to correctly rank<br>the largest 5 flows when using the protocol-aware method.</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">197</span></nobr></DIV>
</DIV>
<!-- Page 11 -->
<a name="11"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1268" src="163011.png" alt="background image">
<DIV style="position:absolute;top:90;left:83"><nobr><span class="ft4"><b>6.3</b></span></nobr></DIV>
<DIV style="position:absolute;top:90;left:123"><nobr><span class="ft4"><b>Impact of loss rate</b></span></nobr></DIV>
<DIV style="position:absolute;top:110;left:96"><nobr><span class="ft5">In the analysis of the protocol-aware method in Section 3.2,</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:83"><nobr><span class="ft10">we made the assumption of negligible number of retransmis-<br>sions for all the flows in the packet stream.</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:96"><nobr><span class="ft5">A retransmitted packet may cause inconsistency between</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:83"><nobr><span class="ft10">the blind and protocol-aware method depending on the lo-<br>cation of the monitoring point. Indeed, the blind method<br>counts the total number of bytes sent by the flow while the<br>protocol-aware method considers only the data sent by the<br>transport layer. Therefore, if the packet is lost before the<br>monitoring point, the blind and protocol-aware method will<br>have a consistent view of the number of bytes sent. Instead,<br>if the packet is lost after the monitoring point, the blind<br>method may count this packet twice.</span></nobr></DIV>
<DIV style="position:absolute;top:314;left:96"><nobr><span class="ft5">The impact of packet losses on the detection and ranking</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:83"><nobr><span class="ft10">of the largest flows depends on the metric used to estimate<br>the size of the flows. If flow sizes are estimated according to<br>the total number of bytes sent (i.e., the throughput), then<br>the protocol-aware method may incur in an underestimation<br>error that is independent of the sampling rate (it will occur<br>even if all packets are sampled!). On the other hand, if the<br>flow sizes are estimated according to the transport data sent<br>(i.e., the goodput), then the blind method may incur in an<br>overestimation error independently of the sampling rate.</span></nobr></DIV>
<DIV style="position:absolute;top:471;left:96"><nobr><span class="ft5">To illustrate the effect of packet loss rates, we plot in</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:83"><nobr><span class="ft10">Figure 9 the performance of detecting the largest flows in the<br>Abilene trace when the measurement bin is 5 minutes and<br>the flow sizes are measured using the total number of bytes<br>sent over the link. The top graph shows the performance<br>of the blind method, while the bottom graph presents the<br>results for the protocol-aware method.</span></nobr></DIV>
<DIV style="position:absolute;top:580;left:96"><nobr><span class="ft5">We can make the following observations:</span></nobr></DIV>
<DIV style="position:absolute;top:609;left:103"><nobr><span class="ft5">· The protocol-aware method keeps performing better</span></nobr></DIV>
<DIV style="position:absolute;top:624;left:116"><nobr><span class="ft10">than the blind method when the sampling rate is above<br>1%. At lower sampling rates, the blind method per-<br>forms better although it presents very large errors.</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:103"><nobr><span class="ft5">· For sampling rates above 2%, the curve relative to</span></nobr></DIV>
<DIV style="position:absolute;top:697;left:116"><nobr><span class="ft10">the detection of the top-25 flows in the protocol-aware<br>method flattens to a value around 70. This is due<br>to the presence of a few flows that experience a high<br>loss rate when compared to other flows. Increasing<br>the sampling rate does not help the protocol-aware<br>method in detecting the largest flows when the vol-<br>ume of bytes sent is used to define the flow size. How-<br>ever, the protocol-aware method can correctly detect<br>the top-25 flows when their size is defined in terms of<br>transport data (see Figure 10).</span></nobr></DIV>
<DIV style="position:absolute;top:867;left:96"><nobr><span class="ft5">In summary, the network operator has to choose the met-</span></nobr></DIV>
<DIV style="position:absolute;top:882;left:83"><nobr><span class="ft10">ric of interest that depends on the application. For exam-<br>ple, for anomaly detection or traffic engineering, a metric<br>that counts the number of bytes sent may be more appro-<br>priate. Instead, for dimensioning caches and proxies, the<br>metric that considers the size of the objects transferred may<br>be preferred. This latter metric suits more the protocol-<br>aware method.</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:83"><nobr><span class="ft4"><b>6.4</b></span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:123"><nobr><span class="ft4"><b>Variability of the results</b></span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:96"><nobr><span class="ft5">A last important aspect that we need to address is the</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:83"><nobr><span class="ft10">variability of the results across multiple measurement in-<br>tervals and different realizations of the sampling process.<br>Indeed, moving from one measurement interval to another,</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:546"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:552"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:632"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:638"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:717"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:723"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:277;left:546"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:546"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:546"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:546"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:546"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:546"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:124;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:546"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:98;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:546"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:291;left:634"><nobr><span class="ft24">packet sampling rate %</span></nobr></DIV>
<DIV style="position:absolute;top:241;left:536"><nobr><span class="ft24">average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:626"><nobr><span class="ft24">Abilene trace, blind detection</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:761"><nobr><span class="ft27">top 1<br>top 2<br>top 5<br>top 10<br>top 25</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:546"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:552"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:632"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:638"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:498;left:717"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:723"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:490;left:546"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:466;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:546"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:546"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:546"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:388;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:387;left:546"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:546"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:335;left:546"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:546"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:634"><nobr><span class="ft24">packet sampling rate %</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:536"><nobr><span class="ft24">average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:304;left:612"><nobr><span class="ft24">Abilene trace, protocol-aware detection</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:761"><nobr><span class="ft27">top 1<br>top 2<br>top 5<br>top 10<br>top 25</span></nobr></DIV>
<DIV style="position:absolute;top:530;left:477"><nobr><span class="ft10">Figure 9: Performance of blind (top) and protocol-<br>aware (bottom) detection on Abilene trace (300s<br>measurement interval).</span></nobr></DIV>
<DIV style="position:absolute;top:607;left:477"><nobr><span class="ft10">the composition of flows varies and with it the flow size dis-<br>tribution. Moreover, the sampling process may "get lucky"<br>in certain cases and provide good results. The opposite is<br>also possible.</span></nobr></DIV>
<DIV style="position:absolute;top:670;left:491"><nobr><span class="ft5">Figure 11 shows the average performance over 15 sam-</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:477"><nobr><span class="ft10">pling experiments of the detection of the top-10 flows in<br>the Abilene trace over the 5-minute measurement intervals.<br>The error bars indicate the standard deviation across the<br>15 experiments. As usual, the top graph refers to the blind<br>method, while the bottom graph presents the protocol-aware<br>method results.</span></nobr></DIV>
<DIV style="position:absolute;top:780;left:491"><nobr><span class="ft5">As we can see the average performance shows limited</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:477"><nobr><span class="ft10">variability. A sampling rate of 0.1% gives poor results for<br>all bins, while increasing the sampling rates consistently<br>helps. With a sampling rate of 10% the performance met-<br>ric (i.e., average number of misranked flow pairs) for the<br>blind method is always below 100 while the protocol-aware<br>method is always below 1.</span></nobr></DIV>
<DIV style="position:absolute;top:889;left:491"><nobr><span class="ft5">Looking at the standard deviation, we observe large val-</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:477"><nobr><span class="ft10">ues for the blind method and much smaller values for the<br>protocol-aware method. This indicates that the blind method<br>is more sensitive to the sampling process than the protocol-<br>aware method. The explanation is given in Section 3.3.2<br>where we showed that that the blind method presents a<br>larger error for large flow sizes (expect when the sampling<br>rate is very low).</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:477"><nobr><span class="ft4"><b>7.</b></span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:509"><nobr><span class="ft4"><b>CONCLUSIONS</b></span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:491"><nobr><span class="ft5">We study the problem of detection and ranking the largest</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:477"><nobr><span class="ft5">flows from a traffic sampled at the packet level. The study is</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">198</span></nobr></DIV>
</DIV>
<!-- Page 12 -->
<a name="12"></a>
<DIV style="position:relative;width:918;height:1268;">
<STYLE type="text/css">
<!--
	.ft28{font-size:8px;font-family:Times;color:#000000;}
	.ft29{font-size:8px;line-height:11px;font-family:Times;color:#000000;}
	.ft30{font-size:8px;line-height:13px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1268" src="163012.png" alt="background image">
<DIV style="position:absolute;top:285;left:152"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:157"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:238"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:243"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:323"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:329"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:277;left:151"><nobr><span class="ft22">-1</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:151"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:225;left:151"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:201;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:151"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:151"><nobr><span class="ft22">3</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:151"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:124;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:151"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:98;left:145"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:96;left:151"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:291;left:239"><nobr><span class="ft24">packet sampling rate %</span></nobr></DIV>
<DIV style="position:absolute;top:241;left:142"><nobr><span class="ft24">average number of misranked flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:221"><nobr><span class="ft24">Abilene trace, protocol-aware detect</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:366"><nobr><span class="ft27">top 1<br>top 2<br>top 5<br>top 10<br>top 25</span></nobr></DIV>
<DIV style="position:absolute;top:317;left:83"><nobr><span class="ft10">Figure 10: Performance of protocol-aware detection<br>on Abilene trace (300s measurement interval) when<br>using actual amount of data sent by the transport<br>layer application.</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:83"><nobr><span class="ft10">done with stochastic tools and real packet-level traces. We<br>find that the ranking accuracy is strongly dependent on the<br>sampling rate, the flow size distribution, the total number<br>of flows and the number of largest flows to be detected and<br>ranked. By changing all these parameters, we conclude that<br>ranking the largest flows requires a high sampling rate (10%<br>and even more). One can reduce the required sampling rate<br>by only detecting the largest flows without considering their<br>relative order.</span></nobr></DIV>
<DIV style="position:absolute;top:548;left:96"><nobr><span class="ft5">We also introduce a new method for flow ranking that</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:83"><nobr><span class="ft10">exploits the information carried in transport header. By<br>analysis and experimentation, we demonstrate that this new<br>technique allows to reduce the required sampling rate by an<br>order of magnitude.</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:96"><nobr><span class="ft5">We are currently exploring two possible future directions</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:83"><nobr><span class="ft10">for this work. First, we want to study the accuracy of the<br>ranking when the sampled traffic is fed into one of the mech-<br>anisms proposed in [10, 12] for sorting flows with reduced<br>memory requirements. Second, we are exploring the use of<br>adaptive schemes that set the sampling rate based on the<br>characteristics of the observed traffic.</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:83"><nobr><span class="ft4"><b>Acknowledgements</b></span></nobr></DIV>
<DIV style="position:absolute;top:778;left:83"><nobr><span class="ft10">We wish to thank NLANR [15], Abilene/Internet2 [1] and<br>the Metropolis project [13] for making available the packet<br>traces used in this work.</span></nobr></DIV>
<DIV style="position:absolute;top:843;left:83"><nobr><span class="ft4"><b>8.</b></span></nobr></DIV>
<DIV style="position:absolute;top:843;left:114"><nobr><span class="ft4"><b>REFERENCES</b></span></nobr></DIV>
<DIV style="position:absolute;top:862;left:91"><nobr><span class="ft28">[1] Abilene: Advanced networking for leading-edge research and</span></nobr></DIV>
<DIV style="position:absolute;top:874;left:111"><nobr><span class="ft28">education. http://abilene.internet2.edu.</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:91"><nobr><span class="ft28">[2] C. Barakat, P. Thiran, G. Iannaccone, C. Diot, and</span></nobr></DIV>
<DIV style="position:absolute;top:900;left:111"><nobr><span class="ft29">P. Owezarski. Modeling Internet backbone traffic at the flow<br>level. IEEE Transactions on Signal Processing (Special Issue<br>on Signal Processing in Networking), 51(8):2111­2124, Aug.<br>2003.</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:91"><nobr><span class="ft28">[3] M. Charikar, K. Chen, and M. Farach-Colton. Finding frequent</span></nobr></DIV>
<DIV style="position:absolute;top:961;left:111"><nobr><span class="ft28">items in data streams. In Proceedings of ICALP, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:974;left:91"><nobr><span class="ft28">[4] B. Y. Choi, J. Park, and Z. Zhang. Adaptive packet sampling</span></nobr></DIV>
<DIV style="position:absolute;top:986;left:111"><nobr><span class="ft29">for flow volume measurement. Technical Report TR-02-040,<br>University of Minnesota, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:1012;left:91"><nobr><span class="ft28">[5] G. Cormode and S. Muthukrishnan. What's hot and what's</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:111"><nobr><span class="ft29">not: Tracking most frequent items dynamically. In Proceedings<br>of ACM PODS, June 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:1049;left:91"><nobr><span class="ft28">[6] M. Crovella and A. Bestravos. Self-similarity in the World</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:111"><nobr><span class="ft29">Wide Web traffic: Evidence and possible causes. IEEE/ACM<br>Transactions on Networking, 5(6):835­846, Dec. 1997.</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:549"><nobr><span class="ft21">0</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:572"><nobr><span class="ft21">200</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:597"><nobr><span class="ft21">400</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:622"><nobr><span class="ft21">600</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:647"><nobr><span class="ft21">800</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:671"><nobr><span class="ft21">1000</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:696"><nobr><span class="ft21">1200</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:721"><nobr><span class="ft21">1400</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:746"><nobr><span class="ft21">1600</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:771"><nobr><span class="ft21">1800</span></nobr></DIV>
<DIV style="position:absolute;top:230;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:228;left:545"><nobr><span class="ft22">-2</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:545"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:185;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:545"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:162;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:161;left:545"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:140;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:545"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:545"><nobr><span class="ft22">8</span></nobr></DIV>
<DIV style="position:absolute;top:241;left:650"><nobr><span class="ft24">time (sec)</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:536"><nobr><span class="ft24">average number of swapped flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:110;left:632"><nobr><span class="ft24">Abilene trace, detection</span></nobr></DIV>
<DIV style="position:absolute;top:90;left:738"><nobr><span class="ft27">sampling 0.1%<br>sampling 1%<br>sampling 10%</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:549"><nobr><span class="ft21">0</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:572"><nobr><span class="ft21">200</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:597"><nobr><span class="ft21">400</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:622"><nobr><span class="ft21">600</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:647"><nobr><span class="ft21">800</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:671"><nobr><span class="ft21">1000</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:696"><nobr><span class="ft21">1200</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:721"><nobr><span class="ft21">1400</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:746"><nobr><span class="ft21">1600</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:771"><nobr><span class="ft21">1800</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:391;left:545"><nobr><span class="ft22">-2</span></nobr></DIV>
<DIV style="position:absolute;top:370;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:545"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:347;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:346;left:545"><nobr><span class="ft22">2</span></nobr></DIV>
<DIV style="position:absolute;top:325;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:545"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:302;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:300;left:545"><nobr><span class="ft22">6</span></nobr></DIV>
<DIV style="position:absolute;top:280;left:540"><nobr><span class="ft21">10</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:545"><nobr><span class="ft22">8</span></nobr></DIV>
<DIV style="position:absolute;top:403;left:650"><nobr><span class="ft24">time (sec)</span></nobr></DIV>
<DIV style="position:absolute;top:386;left:536"><nobr><span class="ft24">average number of swapped flow pairs</span></nobr></DIV>
<DIV style="position:absolute;top:273;left:632"><nobr><span class="ft24">Abilene trace, detection</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:738"><nobr><span class="ft27">sampling 0.1%<br>sampling 1%<br>sampling 10%</span></nobr></DIV>
<DIV style="position:absolute;top:429;left:477"><nobr><span class="ft10">Figure 11: Performance of blind (top) and protocol-<br>aware (bottom) detection over multiple 300s inter-<br>vals (Abilene trace). Vertical bars show the stan-<br>dard deviation over multiple experiments.</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:486"><nobr><span class="ft28">[7] E. Demaine, A. Lopez-Ortiz, and I. Munro. Frequency</span></nobr></DIV>
<DIV style="position:absolute;top:535;left:505"><nobr><span class="ft29">estimation of internet packet streams with limited space. In<br>Proceedings of 10th Annual European Symposium on<br>Algorithms, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:486"><nobr><span class="ft28">[8] N. G. Duffield, C. Lund, and M. Thorup. Properties and</span></nobr></DIV>
<DIV style="position:absolute;top:585;left:505"><nobr><span class="ft29">prediction of flow statistics from sampled packet streams. In<br>Proceedings of ACM Sigcomm Internet Measurement<br>Workshop, Nov. 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:486"><nobr><span class="ft28">[9] N. G. Duffield, C. Lund, and M. Thorup. Estimating flow</span></nobr></DIV>
<DIV style="position:absolute;top:634;left:505"><nobr><span class="ft29">distributions from sampled flow statistics. In Proceedings of<br>ACM Sigcomm, Aug. 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:659;left:480"><nobr><span class="ft28">[10] C. Estan and G. Varghese. New directions in traffic</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:505"><nobr><span class="ft29">measurement and accounting. In Proceedings of ACM<br>Sigcomm, Aug. 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:697;left:480"><nobr><span class="ft28">[11] N. Hohn and D. Veitch. Inverting sampled traffic. In</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:505"><nobr><span class="ft29">Proceedings of ACM Sigcomm Internet Measurement<br>Conference, Oct. 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:480"><nobr><span class="ft28">[12] J. Jedwab, P. Phaal, and B. Pinna. Traffic estimation for the</span></nobr></DIV>
<DIV style="position:absolute;top:746;left:505"><nobr><span class="ft29">largest sources on a network, using packet sampling with<br>limited storage. Technical Report HPL-92-35, HP<br>Laboratories, Mar. 1992.</span></nobr></DIV>
<DIV style="position:absolute;top:783;left:480"><nobr><span class="ft28">[13] Metropolis: METROlogie Pour l'Internet et ses services.</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:505"><nobr><span class="ft28">http://www.laas.fr/ owe/METROPOLIS/metropolis eng.html.</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:480"><nobr><span class="ft28">[14] T. Mori, M. Uchida, R. Kawahara, J. Pan, and S. Goto.</span></nobr></DIV>
<DIV style="position:absolute;top:821;left:505"><nobr><span class="ft29">Identifying elephant flows through periodically sampled<br>packets. In Proceedings of ACM Sigcomm Internet<br>Measurement Conference, Oct. 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:858;left:480"><nobr><span class="ft28">[15] NLANR: National Laboratory for Applied Network Research.</span></nobr></DIV>
<DIV style="position:absolute;top:870;left:505"><nobr><span class="ft28">http://www.nlanr.net.</span></nobr></DIV>
<DIV style="position:absolute;top:884;left:480"><nobr><span class="ft28">[16] Packet Sampling Working Group. Internet Engineering Task</span></nobr></DIV>
<DIV style="position:absolute;top:895;left:505"><nobr><span class="ft28">Force. http://www.ietf.org/html.charters/psamp-charter.html.</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:480"><nobr><span class="ft28">[17] K. Papagiannaki, N. Taft, and C. Diot. Impact of flow</span></nobr></DIV>
<DIV style="position:absolute;top:921;left:505"><nobr><span class="ft29">dynamics on traffic engineering design principles. In<br>Proceedings of IEEE Infocom, Hong Kong, China, Mar. 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:480"><nobr><span class="ft30">[18] Renater. http://www.renater.fr.<br>[19] H. Schulzrinne, S. Casner, R. Frederick, and V. Jacobson.</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:505"><nobr><span class="ft29">RTP: A transport protocol for real-time applications. RFC<br>1889, Jan. 1996.</span></nobr></DIV>
<DIV style="position:absolute;top:997;left:480"><nobr><span class="ft28">[20] A. Shaikh, J. Rexford, and K. G. Shin. Load-sensitive routing</span></nobr></DIV>
<DIV style="position:absolute;top:1009;left:505"><nobr><span class="ft29">of long-lived IP flows. In Proceedings of ACM Sigcomm, Sept.<br>1999.</span></nobr></DIV>
<DIV style="position:absolute;top:1034;left:480"><nobr><span class="ft28">[21] M. Spiegel. Theory and Problems of Probability and</span></nobr></DIV>
<DIV style="position:absolute;top:1046;left:505"><nobr><span class="ft28">Statistics. McGraw-Hill, 1992.</span></nobr></DIV>
<DIV style="position:absolute;top:1127;left:449"><nobr><span class="ft8">199</span></nobr></DIV>
</DIV>
</BODY>
</HTML>
