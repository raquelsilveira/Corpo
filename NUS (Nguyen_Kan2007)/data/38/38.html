<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>sasn30-roy.dvi</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="generator" content="pdftohtml 0.35beta">
<META name="date" content="2006-11-10T12:26:58+00:00">
</HEAD>
<BODY bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft0{font-size:24px;font-family:Times;color:#000000;}
	.ft1{font-size:15px;font-family:Times;color:#000000;}
	.ft2{font-size:12px;font-family:Times;color:#000000;}
	.ft3{font-size:11px;font-family:Times;color:#000000;}
	.ft4{font-size:9px;font-family:Times;color:#000000;}
	.ft5{font-size:16px;font-family:Courier;color:#000000;}
	.ft6{font-size:11px;font-family:Times;color:#000000;}
	.ft7{font-size:11px;line-height:15px;font-family:Times;color:#000000;}
	.ft8{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft9{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38001.png" alt="background image">
<DIV style="position:absolute;top:107;left:95"><nobr><span class="ft0"><b>Attack-Resilient Hierarchical Data Aggregation in Sensor</b></span></nobr></DIV>
<DIV style="position:absolute;top:137;left:397"><nobr><span class="ft0"><b>Networks</b></span></nobr></DIV>
<DIV style="position:absolute;top:204;left:177"><nobr><span class="ft1">Sankardas Roy</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:140"><nobr><span class="ft2">Center for Secure Information</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:209"><nobr><span class="ft2">Systems</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:154"><nobr><span class="ft2">George Mason University</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:172"><nobr><span class="ft1">sroy1@gmu.edu</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:402"><nobr><span class="ft1">Sanjeev Setia</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:375"><nobr><span class="ft2">Department of Computer</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:431"><nobr><span class="ft2">Science</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:373"><nobr><span class="ft2">George Mason University</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:383"><nobr><span class="ft1">setia@cs.gmu.edu</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:622"><nobr><span class="ft1">Sushil Jajodia</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:579"><nobr><span class="ft2">Center for Secure Information</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:648"><nobr><span class="ft2">Systems</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:593"><nobr><span class="ft2">George Mason University</span></nobr></DIV>
<DIV style="position:absolute;top:275;left:607"><nobr><span class="ft1">jajodia@gmu.edu</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:81"><nobr><span class="ft1">ABSTRACT</span></nobr></DIV>
<DIV style="position:absolute;top:340;left:81"><nobr><span class="ft7">In a large sensor network, in-network data aggregation, i.e., com-<br>bining partial results at intermediate nodes during message routing,<br>significantly reduces the amount of communication and hence the<br>energy consumed. Recently several researchers have proposed ro-<br>bust aggregation frameworks, which combine multi-path routing<br>schemes with duplicate-insensitive algorithms, to accurately com-<br>pute aggregates (e.g., Sum, Count, Average) in spite of message<br>losses resulting from node and transmission failures. However,<br>these aggregation frameworks have been designed without security<br>in mind. Given the lack of hardware support for tamper-resistance<br>and the unattended nature of sensor nodes, sensor networks are<br>highly vulnerable to node compromises. We show that even if a<br>few compromised nodes contribute false sub-aggregate values, this<br>results in large errors in the aggregate computed at the root of the<br>hierarchy. We present modifications to the aggregation algorithms<br>that guard against such attacks, i.e., we present algorithms for re-<br>silient hierarchical data aggregation despite the presence of com-<br>promised nodes in the aggregation hierarchy. We evaluate the per-<br>formance and costs of our approach via both analysis and simula-<br>tion. Our results show that our approach is scalable and efficient.</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:81"><nobr><span class="ft1">Categories and Subject Descriptors</span></nobr></DIV>
<DIV style="position:absolute;top:699;left:81"><nobr><span class="ft8">C.2.0 [Computer-Communication Networks]: General--Secu-<br>rity and protection</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:179"><nobr><span class="ft3">; C.2.1 [Computer-Communication Networks]:</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:81"><nobr><span class="ft8">Network Architecture and Design--Wireless communication; D.4.6<br>[Operating Systems]: Security and Protection--Cryptographic con-<br>trols</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:105"><nobr><span class="ft3">; K.6.5 [Management of Computing and Information Sys-</span></nobr></DIV>
<DIV style="position:absolute;top:778;left:81"><nobr><span class="ft3">tems</span></nobr></DIV>
<DIV style="position:absolute;top:777;left:108"><nobr><span class="ft3">]: Security and Protection</span></nobr></DIV>
<DIV style="position:absolute;top:813;left:81"><nobr><span class="ft1">General Terms</span></nobr></DIV>
<DIV style="position:absolute;top:837;left:81"><nobr><span class="ft3">Algorithms, Design, Security</span></nobr></DIV>
<DIV style="position:absolute;top:874;left:81"><nobr><span class="ft1">Keywords</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:81"><nobr><span class="ft7">Sensor Network Security, Data Aggregation, Hierarchical Aggre-<br>gation, Synopsis Diffusion, Attack-Resilient</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:81"><nobr><span class="ft9">Permission to make digital or hard copies of all or part of this work for<br>personal or classroom use is granted without fee provided that copies are<br>not made or distributed for profit or commercial advantage and that copies<br>bear this notice and the full citation on the first page. To copy otherwise, to<br>republish, to post on servers or to redistribute to lists, requires prior specific<br>permission and/or a fee.<br>SASN'06,</span></nobr></DIV>
<DIV style="position:absolute;top:1057;left:130"><nobr><span class="ft4">October 30, 2006, Alexandria, Virginia, USA.</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:81"><nobr><span class="ft4">Copyright 2006 ACM 1-59593-554-1/06/0010 ...</span></nobr></DIV>
<DIV style="position:absolute;top:1069;left:315"><nobr><span class="ft3">$</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:322"><nobr><span class="ft4">5.00.</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:475"><nobr><span class="ft1">1.</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:507"><nobr><span class="ft1">INTRODUCTION</span></nobr></DIV>
<DIV style="position:absolute;top:338;left:489"><nobr><span class="ft3">In large sensor networks, computing aggregates in-network, i.e.,</span></nobr></DIV>
<DIV style="position:absolute;top:354;left:475"><nobr><span class="ft7">combining partial results at intermediate nodes during message rout-<br>ing, significantly reduces the amount of communication and hence<br>the energy consumed [11, 23]. An approach used by several data<br>acquisition systems for sensor networks is to construct a spanning<br>tree rooted at the querying node, and then perform in-network ag-<br>gregation along the tree. Partial results propagate level-by-level up<br>the tree, with each node awaiting messages from all its children<br>before sending a new partial result to its parent.</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:489"><nobr><span class="ft3">Tree-based aggregation approaches, however, are not resilient to</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:475"><nobr><span class="ft7">communication losses resulting from node and transmission fail-<br>ures, which are relatively common in sensor networks [11, 22,<br>23]. Because each communication failure loses an entire subtree<br>of readings, a large fraction of sensor readings are potentially un-<br>accounted for at the querying node, leading to a significant error<br>in the query answer. To address this problem, researchers have<br>proposed the use of multi-path routing techniques for forwarding<br>sub-aggregates [11]. For aggregates such as Min and Max which<br>are duplicate-insensitive, this approach provides a fault-tolerant so-<br>lution. For duplicate-sensitive aggregates such as Count and Sum,<br>however, multi-path routing leads to double-counting of sensor read-<br>ings, resulting in an incorrect aggregate being computed.</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:489"><nobr><span class="ft3">Recently researchers [3, 12, 14] have presented clever algorithms</span></nobr></DIV>
<DIV style="position:absolute;top:699;left:475"><nobr><span class="ft8">to solve the double-counting problem associated with multi-path<br>approaches. A robust and scalable aggregation framework called<br>Synopsis Diffusion</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:577"><nobr><span class="ft3">has been proposed for computing duplicate- sen-</span></nobr></DIV>
<DIV style="position:absolute;top:746;left:475"><nobr><span class="ft7">sitive aggregates such as Count and Sum. There are two primary<br>elements of this approach - the use of a ring-based topology instead<br>of a tree-based topology for organizing the nodes in the aggrega-<br>tion hierarchy, and the use of duplicate-insensitive algorithms for<br>computing aggregates based on Flajolet and Martin's algorithm for<br>counting distinct elements in a multi-set [5].</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:489"><nobr><span class="ft3">As presented, the Synopsis Diffusion aggregation framework does</span></nobr></DIV>
<DIV style="position:absolute;top:856;left:475"><nobr><span class="ft7">not include any provisions for security. Although we can easily pre-<br>vent unauthorized nodes from launching attacks by augmenting the<br>aggregation framework with authentication and encryption proto-<br>cols [15, 24], compromised nodes present an entirely new set of se-<br>curity challenges. The lack of tamper-resistance and the unattended<br>nature of many networks renders sensor nodes highly vulnerable to<br>compromise. Standard authentication mechanisms cannot prevent<br>a compromised node from launching attacks since all its keys are<br>also compromised. In this paper, we present novel mechanisms for<br>making the synopsis diffusion aggregation framework resilient to<br>attacks launched by compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:1028;left:489"><nobr><span class="ft3">We present counter-measures against attacks in which a compro-</span></nobr></DIV>
<DIV style="position:absolute;top:1044;left:475"><nobr><span class="ft7">mised node attempts to change the aggregate value computed at the<br>root of the hierarchy. In particular, we focus on an attack in which</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">71</span></nobr></DIV>
</DIV>
<!-- Page 2 -->
<a name="2"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft10{font-size:6px;font-family:Times;color:#000000;}
	.ft11{font-size:8px;font-family:Times;color:#000000;}
	.ft12{font-size:15px;line-height:20px;font-family:Times;color:#000000;}
	.ft13{font-size:8px;line-height:9px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38002.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft7">a sensor node that is not a leaf node in the aggregation hierarchy<br>relays a false sub-aggregate value to its parents. We refer to this<br>attack as the falsified sub-aggregate attack.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:94"><nobr><span class="ft3">We show that if the synopsis diffusion approach is used to com-</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:81"><nobr><span class="ft7">pute aggregates such as Count and Sum, an adversary can use the<br>falsified sub-aggregate attack to cause the answer computed at the<br>base station in response to a query to differ from the true value by<br>an arbitrary amount. Moreover, we show that this attack can be<br>launched with a high rate of success, even if only one or a small<br>number of nodes are compromised.</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:94"><nobr><span class="ft3">We present an approach in which the synopsis diffusion aggre-</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:81"><nobr><span class="ft7">gation frameork is augmented with a set of countermeasures that<br>mitigate the effect of the falsified sub-aggregate attack. In our ap-<br>proach, a subset of the total number of nodes in the network include<br>an authentication code (MAC) along with their response to a query.<br>These MACs are propagated to the base station along with the par-<br>tial results that are computed at each level in the hierarchy. By ver-<br>ifying these MACs, the base station can estimate the accuracy of<br>the final aggregate value it computes, and can filter out the effect of<br>any false sub-aggregates contributed by compromised nodes. Thus,<br>our approach can be used in conjunction with synopsis diffusion to<br>compute basic aggregates such as Count and Sum despite the pres-<br>ence of compromised nodes in the aggregation hierarchy.</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:94"><nobr><span class="ft3">The communication overhead of our approach depends upon the</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:81"><nobr><span class="ft7">number of contributing nodes which send a MAC to the base sta-<br>tion. We evaluate the performance and costs of our approach via<br>both analysis and simulation. We show that our approach is scal-<br>able since the number of contributing nodes (and hence the average<br>communication overhead) do not increase with network size. To<br>further reduce the communication overhead, we describe a vari-<br>ation of our basic approach that trades communication costs for<br>latency.</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:81"><nobr><span class="ft1">2.</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:112"><nobr><span class="ft12">BACKGROUND: SYNOPSIS DIFFUSION<br>FOR ROBUST AGGREGATION</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:94"><nobr><span class="ft3">In this section, we provide a brief overview of the synopsis dif-</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:81"><nobr><span class="ft7">fusion approach for robust aggregation [3, 14]. Figure 1 illustrates<br>how the synopsis diffusion approach uses a rings topology for ag-<br>gregation.</span></nobr></DIV>
<DIV style="position:absolute;top:790;left:250"><nobr><span class="ft10">R0</span></nobr></DIV>
<DIV style="position:absolute;top:757;left:242"><nobr><span class="ft10">R1</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:236"><nobr><span class="ft10">R2</span></nobr></DIV>
<DIV style="position:absolute;top:804;left:263"><nobr><span class="ft10">q</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:265"><nobr><span class="ft10">C</span></nobr></DIV>
<DIV style="position:absolute;top:872;left:230"><nobr><span class="ft10">B</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:283"><nobr><span class="ft10">A</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:318"><nobr><span class="ft10">D</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:115"><nobr><span class="ft3">Figure 1: Synopsis Diffusion over a rings topology</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:94"><nobr><span class="ft3">In the query distribution phase, nodes form a set of rings around</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:81"><nobr><span class="ft7">the querying node q based on their distance in hops from q. During<br>the subsequent query aggregation period, starting in the outermost<br>ring each node generates a local synopsis s</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:315"><nobr><span class="ft3">= SG(v) where v is the</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:81"><nobr><span class="ft3">sensor reading relevant to the query, and broadcasts it. (SG</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:415"><nobr><span class="ft3">() is</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:81"><nobr><span class="ft3">the synopsis generation function.) A node in ring R</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:368"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:376"><nobr><span class="ft3">will receive</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:81"><nobr><span class="ft3">broadcasts from all the nodes in its range in ring R</span></nobr></DIV>
<DIV style="position:absolute;top:1071;left:354"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:1070;left:357"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:371"><nobr><span class="ft3">. It will then</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft7">combine its own local synopsis with the synopses received from its<br>children using a synopsis fusion function SF</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:716"><nobr><span class="ft3">(), and then broadcast</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:475"><nobr><span class="ft7">the updated synopsis. Thus, the fused synopses propagate level-<br>by-level until they reach the querying node, who first combines the<br>received synopses with its local synopsis using SF</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:747"><nobr><span class="ft3">() and then uses</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:475"><nobr><span class="ft3">the synopsis evaluation function SE</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:666"><nobr><span class="ft3">() to translate the final synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:475"><nobr><span class="ft3">to the answer to the query.</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:489"><nobr><span class="ft3">The functions SG</span></nobr></DIV>
<DIV style="position:absolute;top:195;left:584"><nobr><span class="ft3">(), SF(), and SE() depend upon the target ag-</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:475"><nobr><span class="ft7">gregation function, e.g. Count, Sum, etc. We now describe the<br>duplicate-insensitive synopsis diffusion algorithms for the Count<br>aggregate, i.e., the total number of nodes in the sensor network,<br>and the Sum aggregate, i.e., the sum of the sensor readings of the<br>nodes in the network. These algorithms are based on Flajolet and<br>Martin's well-known probablistic algorithm for counting the num-<br>ber of distinct elements in a multi-set[5].</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:475"><nobr><span class="ft1">2.1</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:516"><nobr><span class="ft1">COUNT</span></nobr></DIV>
<DIV style="position:absolute;top:351;left:489"><nobr><span class="ft3">In this algorithm, each node generates a local synopsis which is</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:475"><nobr><span class="ft3">a bit vector ls of length k</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:620"><nobr><span class="ft3">&gt; log n, where n is an upper bound on</span></nobr></DIV>
<DIV style="position:absolute;top:383;left:475"><nobr><span class="ft7">the nodes in the network. To generate its local synopsis, each node<br>executes the function CT</span></nobr></DIV>
<DIV style="position:absolute;top:398;left:611"><nobr><span class="ft3">(X, k) given below, where X is the node's</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:475"><nobr><span class="ft3">identifier and k is the length of ls in bits. CT</span></nobr></DIV>
<DIV style="position:absolute;top:414;left:722"><nobr><span class="ft3">() can be interpreted</span></nobr></DIV>
<DIV style="position:absolute;top:430;left:475"><nobr><span class="ft8">as a coin-tossing experiment (with a cryptographic hash function<br>h</span></nobr></DIV>
<DIV style="position:absolute;top:445;left:482"><nobr><span class="ft3">(), modeled as a random oracle whose output is 0 or 1, simulating</span></nobr></DIV>
<DIV style="position:absolute;top:461;left:475"><nobr><span class="ft7">a fair coin-toss), which returns the number of coin tosses until the<br>first heads occurs or k</span></nobr></DIV>
<DIV style="position:absolute;top:477;left:597"><nobr><span class="ft3">+ 1 if k tosses have occurred with no heads</span></nobr></DIV>
<DIV style="position:absolute;top:493;left:475"><nobr><span class="ft7">occurring. In the local synopsis ls of node X , a single bit i is set to<br>1, where i is the output of CT</span></nobr></DIV>
<DIV style="position:absolute;top:508;left:632"><nobr><span class="ft3">(X, k). Thus ls is a bitmap of the form</span></nobr></DIV>
<DIV style="position:absolute;top:524;left:475"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:482"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:521;left:485"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:524;left:499"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:524;left:526"><nobr><span class="ft3">with probability 2</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:623"><nobr><span class="ft11"><i>-i</i></span></nobr></DIV>
<DIV style="position:absolute;top:524;left:634"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:556;left:475"><nobr><span class="ft3">Algorithm 1 CT</span></nobr></DIV>
<DIV style="position:absolute;top:555;left:566"><nobr><span class="ft3">(X, k)</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:489"><nobr><span class="ft8">i=1;<br>while i</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:529"><nobr><span class="ft3">&lt; k + 1 AND h(X, i) = 0 do</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:502"><nobr><span class="ft3">i</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:509"><nobr><span class="ft3">= i + 1;</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:489"><nobr><span class="ft7">end while<br>return i;</span></nobr></DIV>
<DIV style="position:absolute;top:672;left:489"><nobr><span class="ft3">The synopsis fusion function SF</span></nobr></DIV>
<DIV style="position:absolute;top:672;left:663"><nobr><span class="ft3">() is simply the bitwise Boolean</span></nobr></DIV>
<DIV style="position:absolute;top:688;left:475"><nobr><span class="ft7">OR of the synopses being combined. Each node fuses its local<br>synopsis ls with the synopses it receives from its children by com-<br>puting the bit-wise OR of all the synopses. Let S denote the final<br>synopsis computed by the querying node by combining all the syn-<br>opses received from its children and its local synopsis. We observe<br>that S will be a bitmap of length k of the form 1</span></nobr></DIV>
<DIV style="position:absolute;top:764;left:725"><nobr><span class="ft11"><i>r</i></span></nobr></DIV>
<DIV style="position:absolute;top:764;left:730"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:767;left:744"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:767;left:768"><nobr><span class="ft3">. The query-</span></nobr></DIV>
<DIV style="position:absolute;top:782;left:475"><nobr><span class="ft7">ing node can estimate Count from S via the synopsis evaluation<br>function SE</span></nobr></DIV>
<DIV style="position:absolute;top:798;left:540"><nobr><span class="ft3">(): if r is the lowest-order bit in S that is 0, the count</span></nobr></DIV>
<DIV style="position:absolute;top:814;left:475"><nobr><span class="ft3">of nodes in the network is 2</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:630"><nobr><span class="ft11"><i>r</i></span></nobr></DIV>
<DIV style="position:absolute;top:811;left:634"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:813;left:648"><nobr><span class="ft3">/0.7735. The synopsis evaluation</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:475"><nobr><span class="ft3">function SE</span></nobr></DIV>
<DIV style="position:absolute;top:829;left:539"><nobr><span class="ft3">() is based on Property 2 below. Intuitively, the number</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:475"><nobr><span class="ft3">of sensor nodes is proportional to 2</span></nobr></DIV>
<DIV style="position:absolute;top:843;left:662"><nobr><span class="ft11"><i>r</i></span></nobr></DIV>
<DIV style="position:absolute;top:842;left:667"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:845;left:684"><nobr><span class="ft3">since no node has set the rth</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:475"><nobr><span class="ft3">bit while computing CT</span></nobr></DIV>
<DIV style="position:absolute;top:860;left:605"><nobr><span class="ft3">(X, k).</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:489"><nobr><span class="ft3">We now present a few important properties of the final synopsis S</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:475"><nobr><span class="ft7">computed at the querying node that have been derived in [5, 3], and<br>that we will find useful in the rest of this paper. Let S</span></nobr></DIV>
<DIV style="position:absolute;top:907;left:767"><nobr><span class="ft3">[i], 1  i  k</span></nobr></DIV>
<DIV style="position:absolute;top:923;left:475"><nobr><span class="ft8">denote the ith bit of S, where bits are numbered starting at the left.<br>Property 1</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:541"><nobr><span class="ft3">For i</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:570"><nobr><span class="ft3">&lt; log</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:601"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:940;left:609"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:617"><nobr><span class="ft3">-2log</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:655"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:939;left:663"><nobr><span class="ft3">log</span></nobr></DIV>
<DIV style="position:absolute;top:945;left:680"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:940;left:687"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:694"><nobr><span class="ft3">, S</span></nobr></DIV>
<DIV style="position:absolute;top:939;left:708"><nobr><span class="ft3">[i] = 1 with probability</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:475"><nobr><span class="ft3"> 1. For i </span></nobr></DIV>
<DIV style="position:absolute;top:953;left:547"><nobr><span class="ft13"><i>3<br>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:956;left:555"><nobr><span class="ft3">log</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:572"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:957;left:580"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:587"><nobr><span class="ft3">, S</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:600"><nobr><span class="ft3">[i] = 0 with probability  1.</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:489"><nobr><span class="ft3">This result implies that for a network of n nodes, we expect that</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:475"><nobr><span class="ft3">S</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:487"><nobr><span class="ft3">has an initial prefix of all ones and a suffix of all zeros, while</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:475"><nobr><span class="ft3">only the bits around S</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:591"><nobr><span class="ft3">[log</span></nobr></DIV>
<DIV style="position:absolute;top:1009;left:612"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:620"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:626"><nobr><span class="ft3">] exhibit much variation. This provides</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:475"><nobr><span class="ft7">an estimate of the number of bits, k, required for a node's local<br>synopsis. In practice, k</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:604"><nobr><span class="ft3">= log</span></nobr></DIV>
<DIV style="position:absolute;top:1040;left:635"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:642"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:651"><nobr><span class="ft3">+ 4 bits are sufficient to represent</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:475"><nobr><span class="ft3">S</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:485"><nobr><span class="ft3">with high probability [5]. This result also indicates that the length</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:475"><nobr><span class="ft3">of the prefix of all ones in S can be used to estimate n. Let r</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:823"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">72</span></nobr></DIV>
</DIV>
<!-- Page 3 -->
<a name="3"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft14{font-size:5px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38003.png" alt="background image">
<DIV style="position:absolute;top:86;left:84"><nobr><span class="ft3">min</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:108"><nobr><span class="ft3">{i|S[i] = 0}, i.e., r is the location of the leftmost zero in S.</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft3">Then R</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:123"><nobr><span class="ft3">= r -1 is a random variable representing the length of the</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:81"><nobr><span class="ft8">prefix of all ones in the sketch. The following results hold for R.<br>Property 2</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:147"><nobr><span class="ft3">The expected value of R, E</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:297"><nobr><span class="ft3">(R)  log</span></nobr></DIV>
<DIV style="position:absolute;top:139;left:350"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:133;left:358"><nobr><span class="ft3">(n) where the</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:81"><nobr><span class="ft3">constant</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:129"><nobr><span class="ft3"> is approximately 0.7735.</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:94"><nobr><span class="ft3">This result implies that R can be used for an unbiased estimator</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:81"><nobr><span class="ft3">of log</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:112"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:180;left:120"><nobr><span class="ft3">(n), and it is the basis for the synopsis evaluation function</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:81"><nobr><span class="ft3">SE</span></nobr></DIV>
<DIV style="position:absolute;top:195;left:97"><nobr><span class="ft3">() which estimates n as 2</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:232"><nobr><span class="ft11"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:195;left:239"><nobr><span class="ft3">/.</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:81"><nobr><span class="ft3">Property 3</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:145"><nobr><span class="ft3">The variance of R, denoted as</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:308"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:209;left:316"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:218;left:316"><nobr><span class="ft11"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:222;left:323"><nobr><span class="ft14"><i>n</i></span></nobr></DIV>
<DIV style="position:absolute;top:211;left:328"><nobr><span class="ft3">, satisfies</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:178"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:237;left:186"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:246;left:186"><nobr><span class="ft11"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:250;left:192"><nobr><span class="ft14"><i>n</i></span></nobr></DIV>
<DIV style="position:absolute;top:240;left:200"><nobr><span class="ft3">= </span></nobr></DIV>
<DIV style="position:absolute;top:237;left:222"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:246;left:222"><nobr><span class="ft11"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:249;left:228"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:240;left:237"><nobr><span class="ft3">+ Q(log</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:281"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:241;left:289"><nobr><span class="ft3">n</span></nobr></DIV>
<DIV style="position:absolute;top:240;left:296"><nobr><span class="ft3">) + o(1),</span></nobr></DIV>
<DIV style="position:absolute;top:265;left:81"><nobr><span class="ft3">where constant</span></nobr></DIV>
<DIV style="position:absolute;top:265;left:165"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:270;left:173"><nobr><span class="ft11"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:273;left:179"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:265;left:189"><nobr><span class="ft3">is approximately 1</span></nobr></DIV>
<DIV style="position:absolute;top:265;left:289"><nobr><span class="ft3">.1213 and Q(x) is a periodic</span></nobr></DIV>
<DIV style="position:absolute;top:281;left:81"><nobr><span class="ft3">function with mean value 0 and period 1.</span></nobr></DIV>
<DIV style="position:absolute;top:296;left:94"><nobr><span class="ft3">This property implies that the standard deviation of R is approx-</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:81"><nobr><span class="ft3">imately 1</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:132"><nobr><span class="ft3">.1213, i.e., the estimates of n derived from R will often</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:81"><nobr><span class="ft7">be off by a factor of two or more in either direction. To reduce<br>the standard deviation of R, Flajolet et al [5] proposed an algorithm<br>named PCSA, where m synopses are computed in parallel and the<br>new estimator ( ¯</span></nobr></DIV>
<DIV style="position:absolute;top:375;left:165"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:375;left:173"><nobr><span class="ft3">) is the average of all individual R's of these syn-</span></nobr></DIV>
<DIV style="position:absolute;top:390;left:81"><nobr><span class="ft3">opses. For PCSA, the standard error in the estimate of n, i.e.,</span></nobr></DIV>
<DIV style="position:absolute;top:390;left:408"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:395;left:417"><nobr><span class="ft11"><i>n</i></span></nobr></DIV>
<DIV style="position:absolute;top:390;left:423"><nobr><span class="ft3">/n,</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:81"><nobr><span class="ft3">is equal to 0</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:146"><nobr><span class="ft3">.78/m [5].</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:81"><nobr><span class="ft3">Property 4</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:145"><nobr><span class="ft3">In a network of n nodes, the expected number of nodes</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:81"><nobr><span class="ft3">that will have the ith bit of their local synopsis ls</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:337"><nobr><span class="ft3">[i] = 1 is n/2</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:404"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:408"><nobr><span class="ft3">. This</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:81"><nobr><span class="ft7">result implies that the expected number of nodes that contribute a 1<br>to the ith bit of S and the bits to the right of the ith bit in S (i.e., bits</span></nobr></DIV>
<DIV style="position:absolute;top:485;left:83"><nobr><span class="ft3">j</span></nobr></DIV>
<DIV style="position:absolute;top:485;left:87"><nobr><span class="ft3">, where i</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:136"><nobr><span class="ft3"> j  k) is n/2</span></nobr></DIV>
<DIV style="position:absolute;top:482;left:219"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:482;left:222"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:485;left:236"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:81"><nobr><span class="ft1">2.2</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:121"><nobr><span class="ft1">SUM</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:94"><nobr><span class="ft3">Considine et al. [3] extended the Count algorithm described above</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:81"><nobr><span class="ft7">for computing the Sum aggregate. The synopsis generation func-<br>tion SG</span></nobr></DIV>
<DIV style="position:absolute;top:563;left:123"><nobr><span class="ft3">() for Sum is a modification of that for Count while the</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:81"><nobr><span class="ft3">fusion function SF</span></nobr></DIV>
<DIV style="position:absolute;top:578;left:182"><nobr><span class="ft3">() and the evaluation function SE() for Sum are</span></nobr></DIV>
<DIV style="position:absolute;top:594;left:81"><nobr><span class="ft3">identical to those for Count.</span></nobr></DIV>
<DIV style="position:absolute;top:610;left:94"><nobr><span class="ft3">To generate its local synopsis for a sensor reading v, a node X</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:81"><nobr><span class="ft3">invokes the function CT</span></nobr></DIV>
<DIV style="position:absolute;top:625;left:209"><nobr><span class="ft3">() v times</span></nobr></DIV>
<DIV style="position:absolute;top:623;left:260"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:626;left:269"><nobr><span class="ft3">and ORs the results. As a result,</span></nobr></DIV>
<DIV style="position:absolute;top:641;left:81"><nobr><span class="ft3">the local synopsis of a node is a bitmap of length k</span></nobr></DIV>
<DIV style="position:absolute;top:641;left:368"><nobr><span class="ft3">= log</span></nobr></DIV>
<DIV style="position:absolute;top:647;left:399"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:642;left:406"><nobr><span class="ft3">u</span></nobr></DIV>
<DIV style="position:absolute;top:646;left:413"><nobr><span class="ft11"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:641;left:420"><nobr><span class="ft3">+ 4</span></nobr></DIV>
<DIV style="position:absolute;top:657;left:81"><nobr><span class="ft3">where u</span></nobr></DIV>
<DIV style="position:absolute;top:662;left:124"><nobr><span class="ft11"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:657;left:132"><nobr><span class="ft3">is an upper bound on the value of Sum aggregate. Unlike</span></nobr></DIV>
<DIV style="position:absolute;top:673;left:81"><nobr><span class="ft7">the local synopsis of a node for Count, more than one bit in the<br>local synopsis of a node for Sum will be equal to 1. Count can<br>be considered as a special case of Sum where each node's sensor<br>reading is equal to one unit.</span></nobr></DIV>
<DIV style="position:absolute;top:736;left:94"><nobr><span class="ft3">Considine et al. [3] proposed an optimized version of SG</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:409"><nobr><span class="ft3">() for</span></nobr></DIV>
<DIV style="position:absolute;top:751;left:81"><nobr><span class="ft7">Sum to make it suitable for a low-end sensor node, even if the<br>sensed value v is high. Moreover, they showed that Properties 1-<br>4 described above for Count also hold for Sum (with appropriate<br>modifications). Similarly, as in the case of Count, the PCSA algo-<br>rithm can be used to reduce the standard deviation of the estimate<br>for Sum.</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:81"><nobr><span class="ft1">3.</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:112"><nobr><span class="ft1">ATTACKS ON SYNOPSIS DIFFUSION</span></nobr></DIV>
<DIV style="position:absolute;top:885;left:94"><nobr><span class="ft3">The Synopsis Diffusion aggregation framework does not include</span></nobr></DIV>
<DIV style="position:absolute;top:901;left:81"><nobr><span class="ft7">any provisions for security; as a result, it is vulnerable to many at-<br>tacks that can be launched by unauthorized or compromised nodes.<br>To prevent unauthorized nodes from eavesdropping on or partici-<br>pating in communications between legitimate nodes, we can aug-<br>ment the aggregation framework with any one of several recently<br>proposed authentication and encryption protocols [15, 24]. How-<br>ever, compromised nodes pose an entirely new set of security chal-<br>lenges.</span></nobr></DIV>
<DIV style="position:absolute;top:1026;left:94"><nobr><span class="ft3">Sensor nodes are often deployed in unattended environments, so</span></nobr></DIV>
<DIV style="position:absolute;top:1042;left:81"><nobr><span class="ft3">they are vulnerable to physical tampering. Current sensor nodes</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:81"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:87"><nobr><span class="ft3">Each sensor reading is assumed to be an integer</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft7">lack hardware support for tamper-resistance. Consequently, it is<br>relatively easy for an adversary to compromise a node without be-<br>ing detected. The adversary can obtain confidential information<br>(e.g., cryptographic keys) from the compromised sensor and repro-<br>gram it with malicious code.</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:489"><nobr><span class="ft3">A compromised node can be used to launch multiple attacks</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:475"><nobr><span class="ft7">against the sensor application. These attacks include jamming at<br>physical or link layer, other denial of service attacks like flooding,<br>route disruption, message dropping, message modification, false<br>data injection and many others. Standard authentication mecha-<br>nisms cannot prevent these insider attacks since the adversary knows<br>all the keying material possessed by the compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:489"><nobr><span class="ft3">In this paper, we focus on defending against an important sub-</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:475"><nobr><span class="ft7">class of these insider attacks which can potentially corrupt the final<br>result of the aggregation query. Below we describe these attacks in<br>the context of the Count and Sum aggregates.</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:489"><nobr><span class="ft3">A compromised node M can corrupt the aggregate value com-</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:475"><nobr><span class="ft7">puted at the root (i.e., the sink) of the hierarchical aggregation<br>framework in three ways. First, M can simply drop aggregation<br>messages that it is supposed to relay towards the sink. If M is lo-<br>cated at a relatively high position in the aggregation hierarchy, this<br>has the effect of omitting a large fraction of the set of sensor read-<br>ings being aggregated. Second, M can falsify its own sensor read-<br>ing with the goal of influencing the aggregate value. Third, M can<br>falsify the sub-aggregate which M is supposed to compute based<br>on the messages received from M's child nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:489"><nobr><span class="ft3">The effect of the first attack in which a node intentionally drops</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:475"><nobr><span class="ft8">aggregation messages is no different from the effect of transmis-<br>sion and node failures, which are common in sensor networks [7].<br>The synopsis diffusion approach employs multi-path routing for ad-<br>dressing these failures, and thus it also addresses message losses<br>due to compromised nodes [3, 12, 14]. We refer to the second at-<br>tack in which a sensor intentionally falsifies its own reading as the<br>falsified local value attack</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:616"><nobr><span class="ft3">. This attack is similar to the behavior of</span></nobr></DIV>
<DIV style="position:absolute;top:619;left:475"><nobr><span class="ft8">nodes with faulty sensors and can be addressed by well-studied ap-<br>proaches for fault tolerance such as majority voting and reputation-<br>based frameworks [10, 6]. The third attack, however, in which a<br>node falsifies the aggregate value it is relaying to its parents in the<br>hierarchy is much more difficult to address, and is the main focus<br>of this paper. We refer to this attack as the falsified sub-aggregate<br>attack</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:508"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:475"><nobr><span class="ft3">The Falsified Sub-Aggregate Attack</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:685"><nobr><span class="ft3">Since the sink estimates the</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:475"><nobr><span class="ft7">aggregate based on the lowest-order bit r that is 0 in the final fused<br>synopsis, a compromised node would need to falsify its own fused<br>synopsis such that it would affect the value of r. It can accomplish<br>this quite easily by simply inserting ones in one or more bits in po-<br>sitions j, where r</span></nobr></DIV>
<DIV style="position:absolute;top:807;left:570"><nobr><span class="ft3"> j  k, in its own fused synopsis which it broad-</span></nobr></DIV>
<DIV style="position:absolute;top:823;left:475"><nobr><span class="ft7">casts to its parents. Note that the compromised node does not need<br>to know the true value of r; it can simply set some higher-order bits<br>to 1 in the hope that this will affect the value of r computed by the<br>sink. Since the synopsis fusion function is a bitwise Boolean OR,<br>the resulting synopsis computed at the sink will reflect the contri-<br>butions of the compromised node.</span></nobr></DIV>
<DIV style="position:absolute;top:918;left:489"><nobr><span class="ft3">Let r</span></nobr></DIV>
<DIV style="position:absolute;top:915;left:516"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:918;left:523"><nobr><span class="ft3">be the lowest-order bit that is 0 in the corrupted synopsis,</span></nobr></DIV>
<DIV style="position:absolute;top:933;left:475"><nobr><span class="ft7">whereas r is the lowest-order bit that is 0 in the correct synopsis.<br>Then the sink's estimate of the aggregate will be larger than the<br>correct estimate by a factor of 2</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:648"><nobr><span class="ft11"><i>r</i></span></nobr></DIV>
<DIV style="position:absolute;top:960;left:652"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:962;left:655"><nobr><span class="ft11"><i>-r</i></span></nobr></DIV>
<DIV style="position:absolute;top:965;left:668"><nobr><span class="ft3">. It is easy to see that, with the</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:475"><nobr><span class="ft7">above technique, the compromised node can inject a large amount<br>of error in the final estimate of the sink.</span></nobr></DIV>
<DIV style="position:absolute;top:1012;left:489"><nobr><span class="ft3">We also observe that even a single node can launch this attack</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:475"><nobr><span class="ft7">with a high rate of success because the use of multi-path routing<br>in the synopsis diffusion approach makes it highly likely that the<br>falsified synopsis will be propagated to the base station. If p is the</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">73</span></nobr></DIV>
</DIV>
<!-- Page 4 -->
<a name="4"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="38004.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft3">packet loss rate and if each node has</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:286"><nobr><span class="ft3"> parents in the aggregation</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:81"><nobr><span class="ft3">hierarchy then the probability of success for this attack is</span></nobr></DIV>
<DIV style="position:absolute;top:103;left:384"><nobr><span class="ft3">(1 - p</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:418"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:103;left:425"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:100;left:430"><nobr><span class="ft11"><i>h</i></span></nobr></DIV>
<DIV style="position:absolute;top:104;left:436"><nobr><span class="ft3">,</span></nobr></DIV>
<DIV style="position:absolute;top:119;left:81"><nobr><span class="ft7">where the compromised node is h hops away from the sink. As an<br>example, if p</span></nobr></DIV>
<DIV style="position:absolute;top:135;left:156"><nobr><span class="ft3">= 0.2,  = 3, and h = 5 then the probability that the</span></nobr></DIV>
<DIV style="position:absolute;top:151;left:81"><nobr><span class="ft3">attack will succeed is 96%.</span></nobr></DIV>
<DIV style="position:absolute;top:166;left:94"><nobr><span class="ft3">On the other hand, it is very hard to launch an attack which re-</span></nobr></DIV>
<DIV style="position:absolute;top:182;left:81"><nobr><span class="ft7">sults in the aggregate estimated at the sink being lower than the true<br>estimate. This is because setting a bit in the falsified synopsis to 0<br>has no effect if there is another node X that contributes a 1 to the<br>same position in the fused synopsis. To make this attack a success<br>the attacker has to compromise all the possible paths from node X<br>to the sink so that X 's 1 cannot reach the sink, which is hard to<br>achieve. If there is more than one node which contributes to the<br>same bit then it is even harder. As an example, in Count algorithm,<br>half of the nodes are likely to contribute to the leftmost bit of the<br>synopsis, one-fourth nodes of contribute to the second bit, and so<br>on. There are bits in the synopsis to which only one or two nodes<br>contribute but it is very hard to predict in advance which nodes will<br>be contributing to these particular bits if the sink broadcasts along<br>the query request a random seed to be used with the hash function<br>in the synopsis generation phase. Hence, we can safely assume that<br>this attack is extremely difficult to launch. In the rest of this paper,<br>we restrict our discussion to the previous attack where the goal of<br>the attacker is only to increase the estimate.</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:81"><nobr><span class="ft1">4.</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:112"><nobr><span class="ft12">PROBLEM DESCRIPTION &amp;<br>ASSUMPTIONS</span></nobr></DIV>
<DIV style="position:absolute;top:540;left:81"><nobr><span class="ft1">4.1</span></nobr></DIV>
<DIV style="position:absolute;top:540;left:121"><nobr><span class="ft1">Problem Description</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:94"><nobr><span class="ft3">In a sensor network where some fraction of the nodes are poten-</span></nobr></DIV>
<DIV style="position:absolute;top:578;left:81"><nobr><span class="ft7">tially compromised, there are three sources that contribute to the<br>error in the sink's estimate of the aggregate being computed: (i)<br>error due to packet losses, (ii) error due to the approximation algo-<br>rithm used, e.g., Flajolet and Martin's probabilistic algorithm [5],<br>and (iii) error injected by compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:656;left:94"><nobr><span class="ft3">The first two types of error are already addressed by the syn-</span></nobr></DIV>
<DIV style="position:absolute;top:672;left:81"><nobr><span class="ft8">posis diffusion aggregation framework. Our paper is complemen-<br>tary to this previous work; our objective is to filter out the third<br>type of error. In particular, we aim to make the synopsis diffusion<br>approach resilient to the falsified local value attack and the falsi-<br>fied sub-aggregate attack</span></nobr></DIV>
<DIV style="position:absolute;top:735;left:217"><nobr><span class="ft3">, i.e., to enable the sink to get the "true"</span></nobr></DIV>
<DIV style="position:absolute;top:750;left:81"><nobr><span class="ft7">estimate of the aggregate being computed despite the presence of<br>compromised nodes in the aggregation hierarchy. By "true" esti-<br>mate we mean the estimate of the aggregate which the sink would<br>compute if there were no compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:81"><nobr><span class="ft1">4.2</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:121"><nobr><span class="ft1">Assumptions</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:94"><nobr><span class="ft3">We now discuss our assumptions with respect to the sensor net-</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:81"><nobr><span class="ft8">work and the adversary.<br>System Assumptions</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:202"><nobr><span class="ft3">We assume that the base station is located at</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:81"><nobr><span class="ft7">the center of the sensor network, and nodes are deployed around<br>the base station. However, our approach for attack-resilient ag-<br>gregation does not depend upon this assumption. We assume that<br>sensor nodes are similar to the current generation of sensor nodes,<br>e.g., Mica2 motes [13], in their computational and communication<br>capabilities and power resources, while the sink is a laptop class<br>device supplied with long-lasting power.</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:94"><nobr><span class="ft3">We assume that the sink has an estimate of the upper bound on</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:81"><nobr><span class="ft7">the value of the Count aggregate. If the sink does not have any<br>further knowledge, the upper bound of Count can be set to the total<br>number of nodes deployed. We also assume that there exists an<br>upper bound on the value of a sensor reading. The upper bound of</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft8">Sum can be conservatively set to be equal to product of the upper<br>bound of Count and the upper bound of a sensor reading. Previous<br>works on the synopsis diffusion approach [3, 14] have made the<br>same assumptions regarding the upper bounds for Count and Sum;<br>these bounds provide an estimate of the length of the synopsis.<br>Security Assumptions</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:603"><nobr><span class="ft3">We assume that the sink cannot be compro-</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:475"><nobr><span class="ft7">mised and it uses a protocol such as µTesla [15]) to authenticate its<br>broadcast messages. We also assume that each node shares a pair-<br>wise key with the sink, which is used to authenticate the messages<br>it sends to the sink.</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:489"><nobr><span class="ft3">We assume that the adversary can compromise sensor nodes with-</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:475"><nobr><span class="ft8">out being detected. If a node is compromised, all the information it<br>holds will also be compromised. We use a Byzantine fault model,<br>where the adversary can inject malicious messages into the network<br>through the compromised nodes. We conservatively assume that all<br>compromised nodes can collude, or are under the control of a single<br>attacker.<br>Notations</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:535"><nobr><span class="ft3">The following notations are used in the description of</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:475"><nobr><span class="ft3">our attack-resilient aggregation algorithms.</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:495"><nobr><span class="ft3">· BS refers to the base station, i.e., the sink. X is the identifier</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:509"><nobr><span class="ft7">of a the sensor node whereas M represents a compromised<br>node.</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:495"><nobr><span class="ft3">· K</span></nobr></DIV>
<DIV style="position:absolute;top:458;left:517"><nobr><span class="ft11"><i>X</i></span></nobr></DIV>
<DIV style="position:absolute;top:453;left:529"><nobr><span class="ft3">is the pair-wise key X shares with the sink.</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:495"><nobr><span class="ft3">· m1|m2 denotes the concatenation of two message fields m1</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:509"><nobr><span class="ft3">and m2.</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:495"><nobr><span class="ft3">· MAC(K,m) is the message authentication code (MAC) of the</span></nobr></DIV>
<DIV style="position:absolute;top:526;left:509"><nobr><span class="ft3">message m generated using the key K.</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:495"><nobr><span class="ft3">· X  Y : m denotes a one-hop delivery of message m from X</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:509"><nobr><span class="ft3">to Y , while X</span></nobr></DIV>
<DIV style="position:absolute;top:561;left:585"><nobr><span class="ft3">  : m denotes that X broadcasts message m</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:509"><nobr><span class="ft3">to all of its one-hop neighbors, and X</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:711"><nobr><span class="ft3">  : m denotes that</span></nobr></DIV>
<DIV style="position:absolute;top:594;left:509"><nobr><span class="ft3">X</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:522"><nobr><span class="ft3">broadcasts message m to all nodes in the network.</span></nobr></DIV>
<DIV style="position:absolute;top:631;left:475"><nobr><span class="ft1">5.</span></nobr></DIV>
<DIV style="position:absolute;top:631;left:507"><nobr><span class="ft12">ATTACK-RESILIENT AGGREGATION:<br>THE BASIC APPROACH</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:489"><nobr><span class="ft3">In this section, we present an attack-resilient approach for com-</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:475"><nobr><span class="ft7">puting the Count and Sum aggregates. In this approach we assume<br>that the BS has an estimate of the lower bound and the upper bound<br>of the aggregates. We will see that this approach is scalable only if<br>the ratio of the upper bound to the lower bound is small. Despite<br>this limitation, we discuss this approach in detail because it pro-<br>vides the background and motivation for our extended approach,<br>which is discussed in Section 6. We first present the main idea un-<br>derlying the basic approach and then present the detailed protocol<br>for securing Count and Sum.</span></nobr></DIV>
<DIV style="position:absolute;top:843;left:475"><nobr><span class="ft1">5.1</span></nobr></DIV>
<DIV style="position:absolute;top:843;left:516"><nobr><span class="ft1">The Main Idea</span></nobr></DIV>
<DIV style="position:absolute;top:865;left:489"><nobr><span class="ft3">In our approach, nodes execute the synopsis diffusion aggrega-</span></nobr></DIV>
<DIV style="position:absolute;top:881;left:475"><nobr><span class="ft7">tion algorithm as specified in [3, 14]. However, a subset of the<br>nodes include along with their synopses a message authentication<br>code (MAC) that can be used by the sink to verify the validity of<br>their contribution to the aggregate function.</span></nobr></DIV>
<DIV style="position:absolute;top:943;left:489"><nobr><span class="ft3">The key observations behind the design of our approach are that</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:495"><nobr><span class="ft3">· In order to derive the correct estimate from the final synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:509"><nobr><span class="ft7">(say S) computed at the sink, we need only to figure out the<br>correct lowest order bit (say r) in S that is 0.</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:495"><nobr><span class="ft3">· The number of nodes contributing a 1 to bit j decreases ex-</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:509"><nobr><span class="ft3">ponentially as we move from the lowest order bit ( j</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:795"><nobr><span class="ft3">= 1) to</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:509"><nobr><span class="ft3">higher order bits of the synopsis. For example, in the case</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">74</span></nobr></DIV>
</DIV>
<!-- Page 5 -->
<a name="5"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft15{font-size:10px;font-family:Times;color:#000000;}
	.ft16{font-size:13px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38005.png" alt="background image">
<DIV style="position:absolute;top:86;left:114"><nobr><span class="ft7">of Count, on average, half the nodes in the network will con-<br>tribute</span></nobr></DIV>
<DIV style="position:absolute;top:99;left:153"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:102;left:162"><nobr><span class="ft3">to the leftmost bit of the synopsis, one-fourth of the</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:114"><nobr><span class="ft3">nodes contribute to the second bit of the synposis, and so on.</span></nobr></DIV>
<DIV style="position:absolute;top:140;left:81"><nobr><span class="ft7">Thus, we expect that only a small number of nodes will contribute<br>to the bits around the expected value of r. Each such node includes<br>along with its response to an aggregation query a MAC computed<br>using a pairwise key shared exclusively with sink. We demonstrate<br>that these MACs enable the sink to filter out the contributions of<br>the falsified sub-aggregates injected by the compromised nodes to<br>the final aggregate.</span></nobr></DIV>
<DIV style="position:absolute;top:250;left:94"><nobr><span class="ft3">For our scheme to work, two issues need to be addressed. First,</span></nobr></DIV>
<DIV style="position:absolute;top:266;left:81"><nobr><span class="ft7">since the the value of r is not known before the execution of the<br>query, we need to specify a criterion whereby a node can determine<br>if it needs to include a MAC along with its synopsis. Second, this<br>criterion should be designed so that the number of such nodes who<br>include a MAC is minimized.</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:94"><nobr><span class="ft3">In our basic approach, we assume that the BS has an estimate</span></nobr></DIV>
<DIV style="position:absolute;top:360;left:81"><nobr><span class="ft7">of the lower bound and the upper bound of Count which are de-<br>noted by l</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:136"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:375;left:145"><nobr><span class="ft3">and u</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:175"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:375;left:184"><nobr><span class="ft3">respectively. Based upon these bounds, the BS</span></nobr></DIV>
<DIV style="position:absolute;top:391;left:81"><nobr><span class="ft7">knows that bit r will lie between a and b, which are the bit po-<br>sitions in the synopsis S corresponding to l</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:321"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:407;left:331"><nobr><span class="ft3">and u</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:362"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:407;left:372"><nobr><span class="ft3">respectively,</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:81"><nobr><span class="ft3">i.e., a</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:116"><nobr><span class="ft3">= log</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:153"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:422;left:160"><nobr><span class="ft3">(l</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:176"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:422;left:182"><nobr><span class="ft3">) and b = log</span></nobr></DIV>
<DIV style="position:absolute;top:428;left:269"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:422;left:276"><nobr><span class="ft3">(u</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:295"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:422;left:300"><nobr><span class="ft3">) (by Property 2 in Sec-</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:81"><nobr><span class="ft7">tion 2). Thus, there is no need for the BS to verify the bits to the<br>left of a; only nodes contributing to bits in the range a to b need<br>to prove to the BS that their contribution to the synopsis S is valid.<br>We refer to the collection of bits in the range a to b in synopsis S<br>as the synopsis-edge as shown in Figure 2. It is easy to see that the<br>length of the synopsis-edge is</span></nobr></DIV>
<DIV style="position:absolute;top:516;left:247"><nobr><span class="ft3">(log</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:276"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:516;left:282"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:513;left:289"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:517;left:294"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:524;left:290"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:527;left:293"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:516;left:300"><nobr><span class="ft3">)+1) bits. If we denote</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:81"><nobr><span class="ft3">the number of nodes contributing to the synopsis-edge by</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:397"><nobr><span class="ft3">, then,</span></nobr></DIV>
<DIV style="position:absolute;top:550;left:81"><nobr><span class="ft3">by Property 4 in Section 2,</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:228"><nobr><span class="ft3">  (</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:260"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:550;left:265"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:260"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:265"><nobr><span class="ft14"><i>a</i></span></nobr></DIV>
<DIV style="position:absolute;top:549;left:273"><nobr><span class="ft3">+ . . . +</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:316"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:550;left:321"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:557;left:316"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:557;left:321"><nobr><span class="ft14"><i>b</i></span></nobr></DIV>
<DIV style="position:absolute;top:549;left:327"><nobr><span class="ft3">) </span></nobr></DIV>
<DIV style="position:absolute;top:546;left:351"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:351"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:549;left:365"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:372"><nobr><span class="ft11"><i>2u</i></span></nobr></DIV>
<DIV style="position:absolute;top:550;left:383"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:557;left:376"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:560;left:379"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:549;left:391"><nobr><span class="ft3">-1).</span></nobr></DIV>
<DIV style="position:absolute;top:567;left:94"><nobr><span class="ft3">The upper bound for Count (u</span></nobr></DIV>
<DIV style="position:absolute;top:572;left:261"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:567;left:266"><nobr><span class="ft3">) can be set to the total number</span></nobr></DIV>
<DIV style="position:absolute;top:583;left:81"><nobr><span class="ft3">of nodes deployed. The lower bound for Count (l</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:345"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:583;left:351"><nobr><span class="ft3">) can be guessed</span></nobr></DIV>
<DIV style="position:absolute;top:599;left:81"><nobr><span class="ft7">depending on the the energy reserve of the sensor nodes and rate<br>of energy expenditure. As an example, if 2000 nodes are deployed<br>then u</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:115"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:630;left:124"><nobr><span class="ft3">= 2000 and l</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:197"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:630;left:205"><nobr><span class="ft3">= 1000 may be a safe estimate at the time</span></nobr></DIV>
<DIV style="position:absolute;top:646;left:81"><nobr><span class="ft8">of the Count query's execution. For this example, the length of the<br>synopsis-edge</span></nobr></DIV>
<DIV style="position:absolute;top:661;left:161"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:177"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:662;left:182"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:669;left:178"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:672;left:181"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:661;left:192"><nobr><span class="ft3">= 2 and the expected number of nodes con-</span></nobr></DIV>
<DIV style="position:absolute;top:677;left:81"><nobr><span class="ft3">tributing to synopsis-edge is less than 3.87.</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:319"><nobr><span class="ft2">synopsis-edge</span></nobr></DIV>
<DIV style="position:absolute;top:788;left:278"><nobr><span class="ft15">corresponds to</span></nobr></DIV>
<DIV style="position:absolute;top:805;left:280"><nobr><span class="ft15">Lower Bound</span></nobr></DIV>
<DIV style="position:absolute;top:788;left:364"><nobr><span class="ft15">corresponds to</span></nobr></DIV>
<DIV style="position:absolute;top:806;left:368"><nobr><span class="ft15">Upper Bound</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:81"><nobr><span class="ft3">Figure 2: Securing Count synopsis.</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:315"><nobr><span class="ft3">To securely compute</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:81"><nobr><span class="ft7">Count synopsis, the base station needs to verify only bits in the<br>synopsis-edge.</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:94"><nobr><span class="ft3">For the ease of presentation, we present the basic approach as-</span></nobr></DIV>
<DIV style="position:absolute;top:937;left:81"><nobr><span class="ft7">suming that only one synopsis is computed. We can easily extend<br>this approach to compute m synopses in parallel as in algorithm<br>PCSA.</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:81"><nobr><span class="ft1">5.2</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:121"><nobr><span class="ft1">Securing Count</span></nobr></DIV>
<DIV style="position:absolute;top:1015;left:94"><nobr><span class="ft3">To compute the Count aggregate securely, we extend the original</span></nobr></DIV>
<DIV style="position:absolute;top:1030;left:81"><nobr><span class="ft3">Count algorithm discussed in Section 2 as follows. For the sake</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:81"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:87"><nobr><span class="ft3">For convenience, henceforth, we say that a node "contributes" to</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:81"><nobr><span class="ft3">a position j in the synopsis S if bit j in its local synopsis is 1.</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft7">of completeness, we first briefly describe the query dissemination<br>phase, and then we present the aggregation procedure in detail.</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:489"><nobr><span class="ft3">In the query dissemination phase, the BS broadcasts the name</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:475"><nobr><span class="ft7">of the aggregation function, a random number (Seed) and the bit<br>positions of the start and the end of the synopsis-edge, which are<br>specified by a and b respectively. Each node will use the random<br>number, Seed, as an input to the hash function in the synopsis gen-<br>eration procedure. In more concrete terms, a query packet that the<br>BS broadcasts is as follows:</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:567"><nobr><span class="ft3">BS</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:585"><nobr><span class="ft3">  : F</span></nobr></DIV>
<DIV style="position:absolute;top:239;left:638"><nobr><span class="ft11"><i>agg</i></span></nobr></DIV>
<DIV style="position:absolute;top:234;left:655"><nobr><span class="ft3">, Seed, a, b, s,t, h</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:475"><nobr><span class="ft3">where F</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:518"><nobr><span class="ft11"><i>agg</i></span></nobr></DIV>
<DIV style="position:absolute;top:258;left:538"><nobr><span class="ft3">is the name of the aggregation function (i.e. `Count'), s</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:475"><nobr><span class="ft7">denotes the time when the aggregation phase will start, t represents<br>the duration of one round i.e. t</span></nobr></DIV>
<DIV style="position:absolute;top:289;left:650"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:666"><nobr><span class="ft11"><i>T</i></span></nobr></DIV>
<DIV style="position:absolute;top:297;left:667"><nobr><span class="ft11"><i>h</i></span></nobr></DIV>
<DIV style="position:absolute;top:289;left:675"><nobr><span class="ft3">, where h is the total number</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:475"><nobr><span class="ft8">of hops and T is the duration of the aggregation phase (also called<br>epoch</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:507"><nobr><span class="ft3">). Note that, as in the original Count algorithm discussed in</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:475"><nobr><span class="ft7">Section 2, the epoch is sub-divided into a series of rounds, one for<br>each hop, starting from the farthest hop. µTesla [15] can be used<br>for authenticating the broadcast packet.</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:489"><nobr><span class="ft3">In the aggregation phase, each node executes the synopsis gen-</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:475"><nobr><span class="ft3">eration function SG</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:584"><nobr><span class="ft3">() and the synopsis fusion function SF() for</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:475"><nobr><span class="ft7">Count as discussed in Section 2. In addition, each node checks<br>whether it contributes to the synopsis-edge, and if so, it generates a<br>MAC and forwards the MAC along with its fused synopsis. Specif-<br>ically, if node X contributes to bit i in the synopsis-edge, it gener-<br>ates a MAC, M</span></nobr></DIV>
<DIV style="position:absolute;top:477;left:562"><nobr><span class="ft3">= MAC(K</span></nobr></DIV>
<DIV style="position:absolute;top:482;left:618"><nobr><span class="ft11"><i>X</i></span></nobr></DIV>
<DIV style="position:absolute;top:477;left:626"><nobr><span class="ft3">, m) over the message m whose format</span></nobr></DIV>
<DIV style="position:absolute;top:493;left:475"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:493;left:487"><nobr><span class="ft3">[X|i|Seed], where Seed is the random number which was dissem-</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:475"><nobr><span class="ft7">inated in the query distribution phase. Each node X forwards to<br>its parents its fused synopsis along with the set of MACs (</span></nobr></DIV>
<DIV style="position:absolute;top:524;left:802"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:525;left:817"><nobr><span class="ft3">) it</span></nobr></DIV>
<DIV style="position:absolute;top:540;left:475"><nobr><span class="ft7">received from its child nodes and its own MAC if it generated one.<br>The format of the message a node X forwards to its parents is as<br>follows:</span></nobr></DIV>
<DIV style="position:absolute;top:593;left:615"><nobr><span class="ft3">X</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:627"><nobr><span class="ft3">  : S</span></nobr></DIV>
<DIV style="position:absolute;top:598;left:667"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:592;left:671"><nobr><span class="ft3">|</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:675"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:592;left:690"><nobr><span class="ft3">,</span></nobr></DIV>
<DIV style="position:absolute;top:613;left:475"><nobr><span class="ft3">where S</span></nobr></DIV>
<DIV style="position:absolute;top:618;left:518"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:613;left:525"><nobr><span class="ft3">is the fused synopsis computed by X . If the message does</span></nobr></DIV>
<DIV style="position:absolute;top:629;left:475"><nobr><span class="ft7">not fit into one packet, node X breaks it into several packets and<br>forwards them. In Appendix A, we formally describe the algorithm<br>(SecureCount) executed by each node in response to an aggregation<br>query.</span></nobr></DIV>
<DIV style="position:absolute;top:692;left:489"><nobr><span class="ft3">After the BS receives the MACs, it checks their validity. In par-</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:475"><nobr><span class="ft3">ticular, for each message and MAC pair</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:705"><nobr><span class="ft3">[m|MAC(K</span></nobr></DIV>
<DIV style="position:absolute;top:712;left:764"><nobr><span class="ft11"><i>X</i></span></nobr></DIV>
<DIV style="position:absolute;top:707;left:772"><nobr><span class="ft3">, m)] where</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:475"><nobr><span class="ft3">m</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:489"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:503"><nobr><span class="ft3">[X|i|Seed], the BS executes the synopsis generation function</span></nobr></DIV>
<DIV style="position:absolute;top:739;left:475"><nobr><span class="ft3">SG</span></nobr></DIV>
<DIV style="position:absolute;top:738;left:492"><nobr><span class="ft3">() of X and verifies whether node X really contributes to bit i</span></nobr></DIV>
<DIV style="position:absolute;top:754;left:475"><nobr><span class="ft7">in the synopsis-edge, and then checks whether the attached MAC<br>is valid. If any of these tests fail, the corresponding MAC is dis-<br>carded.</span></nobr></DIV>
<DIV style="position:absolute;top:802;left:489"><nobr><span class="ft3">After this verification step, the BS checks whether it has received</span></nobr></DIV>
<DIV style="position:absolute;top:817;left:475"><nobr><span class="ft7">at least one valid MAC for each bit in the synopsis-edge. The bits in<br>the synopsis-edge for which the BS has not received a valid MAC<br>are reset to 0. The bits at positions to the left of the synopsis-edge<br>are set to 1. Finally, the BS computes the Count using the synopsis<br>evaluation function SE</span></nobr></DIV>
<DIV style="position:absolute;top:880;left:598"><nobr><span class="ft3">().</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:475"><nobr><span class="ft3">Security Analysis</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:579"><nobr><span class="ft3">The security of our approach follows from two</span></nobr></DIV>
<DIV style="position:absolute;top:911;left:475"><nobr><span class="ft3">facts:</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:495"><nobr><span class="ft3">· The sink can independently verify the output of SG() for a</span></nobr></DIV>
<DIV style="position:absolute;top:948;left:509"><nobr><span class="ft3">particular node X . This is because the output of SG</span></nobr></DIV>
<DIV style="position:absolute;top:948;left:801"><nobr><span class="ft3">() de-</span></nobr></DIV>
<DIV style="position:absolute;top:964;left:509"><nobr><span class="ft7">pends only upon the node id X , and the random seed included<br>in the query message.</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:495"><nobr><span class="ft3">· Each bit that is set to 1 in the synopsis edge has an associated</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:509"><nobr><span class="ft7">MAC that can be verified by the sink. This MAC is computed<br>using a pairwise key that is known only to the contributing<br>node and the sink, thus the MAC cannot be fabricated by an<br>attacker (as long as it is reasonably long.)</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">75</span></nobr></DIV>
</DIV>
<!-- Page 6 -->
<a name="6"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft17{font-size:17px;font-family:Times;color:#000000;}
	.ft18{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38006.png" alt="background image">
<DIV style="position:absolute;top:86;left:94"><nobr><span class="ft3">Although a compromised node can falsely set some bits in its</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft7">fused synopsis and forward false MACs corresponding to those<br>bits, the sink will be able to discard any false MACs. This implies<br>that the attacker cannot falsely increase the Count. On the other<br>hand, the attacker may attempt to decrease the Count by dropping<br>a genuine MAC (or by corrupting a genuine MAC) sent by a con-<br>tributing node, but the genuine MAC is likely to reach BS via an<br>alternate path. If BS receives at least one valid MAC for each 1 bit<br>in the synopsis-edge, then BS obtains the true estimate of Count as<br>discussed below.</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:94"><nobr><span class="ft3">As discussed in Section 2, the synopsis diffusion approach uses</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:81"><nobr><span class="ft7">a multi-path routing scheme to reduce the aggregation error due to<br>packet losses resulting from node and link failures. The effect of<br>packets being dropped by compromised nodes is simply to increase<br>the overall packet loss rate, and this can be countered by an appro-<br>priate choice of</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:171"><nobr><span class="ft3">, the number of parents of a node in the synop-</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:81"><nobr><span class="ft7">sis diffusion ring-based aggregation hierarchy. Specifically, if each<br>node has more than</span></nobr></DIV>
<DIV style="position:absolute;top:352;left:188"><nobr><span class="ft3"> parents, the total number of rings in the rings</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:81"><nobr><span class="ft7">topology is h, and if the probability of a node being compromised<br>is p then, on average, a contributing node's MAC will reach the BS<br>with probability q, where</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:204"><nobr><span class="ft3">q</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:214"><nobr><span class="ft3"> 1h</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:252"><nobr><span class="ft11"><i>h</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:247"><nobr><span class="ft17"></span></nobr></DIV>
<DIV style="position:absolute;top:456;left:247"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:455;left:250"><nobr><span class="ft11"><i>=1</i></span></nobr></DIV>
<DIV style="position:absolute;top:439;left:265"><nobr><span class="ft3">(1 - p</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:299"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:439;left:305"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:312"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:479;left:81"><nobr><span class="ft7">Here we have assumed that the contributing nodes are uniformly<br>distributed over the rings in the hierarchy. As an example, if p</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:429"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:511;left:81"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:510;left:87"><nobr><span class="ft3">.05,  = 3, and h = 10 then q is greater than 0.999, i.e., the impact</span></nobr></DIV>
<DIV style="position:absolute;top:526;left:81"><nobr><span class="ft7">of the compromised nodes on the communication error is negligi-<br>ble.</span></nobr></DIV>
<DIV style="position:absolute;top:558;left:94"><nobr><span class="ft3">We also note that while deriving q we assumed that there is only</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:81"><nobr><span class="ft8">one node which contributes to a particular bit in the synopsis. In<br>reality, the expected number of nodes contributing to a bit increases<br>exponentially as we move from the Rth bit, where R is the the<br>length of the prefix of all ones in the synopsis S, to the lower-order<br>bits, thereby increasing the probability that at least one MAC cor-<br>responding to a bit position reaches the sink.<br>Computation and Communication Overhead</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:343"><nobr><span class="ft3">Each contributing</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:81"><nobr><span class="ft18">node computes one MAC. The expected number of contributing<br>nodes is</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:130"><nobr><span class="ft3"> =</span></nobr></DIV>
<DIV style="position:absolute;top:697;left:157"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:707;left:157"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:700;left:173"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:697;left:180"><nobr><span class="ft11"><i>2u</i></span></nobr></DIV>
<DIV style="position:absolute;top:701;left:190"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:708;left:183"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:711;left:186"><nobr><span class="ft14"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:700;left:198"><nobr><span class="ft3">-1), which is independent of network size.</span></nobr></DIV>
<DIV style="position:absolute;top:718;left:81"><nobr><span class="ft7">Thus, only a subset of nodes will incur any computational over-<br>head. With respect to communication overhead, the maximum num-<br>ber of MACs that any node will need to forward is</span></nobr></DIV>
<DIV style="position:absolute;top:749;left:354"><nobr><span class="ft3">. Thus this ap-</span></nobr></DIV>
<DIV style="position:absolute;top:765;left:81"><nobr><span class="ft7">proach is scalable, and can be used in large-scale sensor networks<br>as long as the ratio u</span></nobr></DIV>
<DIV style="position:absolute;top:785;left:192"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:781;left:197"><nobr><span class="ft3">/l</span></nobr></DIV>
<DIV style="position:absolute;top:785;left:207"><nobr><span class="ft11"><i>c</i></span></nobr></DIV>
<DIV style="position:absolute;top:781;left:216"><nobr><span class="ft3">is reasonably small.</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:81"><nobr><span class="ft1">5.3</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:121"><nobr><span class="ft1">Securing SUM</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:94"><nobr><span class="ft3">We can extend the approach used for making the Count aggre-</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:81"><nobr><span class="ft7">gate resilient to compromised nodes to the Sum aggregate. To de-<br>rive the synopsis-edge for Sum we need to assume upper and lower<br>bounds for the value of a sensor reading in addition to the upper<br>and lower bounds for the number of sensor nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:94"><nobr><span class="ft3">A node X sends to the BS a MAC, M</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:301"><nobr><span class="ft3">= MAC(K</span></nobr></DIV>
<DIV style="position:absolute;top:914;left:357"><nobr><span class="ft11"><i>X</i></span></nobr></DIV>
<DIV style="position:absolute;top:909;left:365"><nobr><span class="ft3">, m), only if it</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:81"><nobr><span class="ft7">contributes to the synopsis-edge as in SecureCount. The format of<br>the message m sent by a node is</span></nobr></DIV>
<DIV style="position:absolute;top:940;left:256"><nobr><span class="ft3">[X|A|Seed|v], where X is the node</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:81"><nobr><span class="ft8">id, Seed is the random seed included in the broadcast query, A rep-<br>resents the collection of bits in the synopsis to which X contributes,<br>and v is X 's sensed value.<br>Security Analysis</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:186"><nobr><span class="ft3">In the case of the Sum aggregate, the attacker</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:81"><nobr><span class="ft7">could falsely set some bits in its synopsis not only by using a false<br>node id but also using a false sensor reading. Although MACs from<br>the contributing nodes enable the BS to verify the node Ids, the BS<br>cannot verify the sensed value of a node. A compromised node can</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft3">claim to have a large sensed value close to the upper bound u</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:814"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:823"><nobr><span class="ft3">to</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:475"><nobr><span class="ft3">increase its chance of being able to contribute to the synopsis-edge.</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:489"><nobr><span class="ft3">The following theorem (whose proof can be found in Appendix</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:475"><nobr><span class="ft8">B) shows that this attack's impact is limited.<br>Theorem 1.</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:547"><nobr><span class="ft3">Let</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:569"><nobr><span class="ft3"> be the number of compromised nodes in a net-</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:475"><nobr><span class="ft3">work of n nodes. Let u</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:607"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:164;left:617"><nobr><span class="ft3">and a</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:648"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:164;left:658"><nobr><span class="ft3">denote the upper bound and the</span></nobr></DIV>
<DIV style="position:absolute;top:180;left:475"><nobr><span class="ft7">average value of the sensor reading respectively. Let S be the final<br>synopsis computed at the sink and let R be the length of the prefix<br>of all ones in S. Let s denote the value of the Sum aggregate. If each<br>compromised node claims that its sensed value is equal to the upper<br>bound u</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:519"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:243;left:525"><nobr><span class="ft3">, and if</span></nobr></DIV>
<DIV style="position:absolute;top:242;left:568"><nobr><span class="ft3">( u</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:595"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:242;left:600"><nobr><span class="ft3">) &lt; s, then the probability Pr[S[R + 1] = 1]</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:475"><nobr><span class="ft7">is proportional to the product of the fraction of compromised nodes<br>in the network,</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:560"><nobr><span class="ft3">/n.</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:489"><nobr><span class="ft3">Note that if the compromised node contributes to the</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:783"><nobr><span class="ft3">(R + 1)th</span></nobr></DIV>
<DIV style="position:absolute;top:306;left:475"><nobr><span class="ft7">bit BS's estimate of Sum doubles. Thus, the theorem shows that for<br>a large network, as long the fraction of compromised nodes</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:791"><nobr><span class="ft3"> grows</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:475"><nobr><span class="ft7">sub-linearly, the probability of this attack succeeding is small. For<br>smaller networks, the probability of this attack succeeding depends<br>upon the ratio</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:556"><nobr><span class="ft3">/n and on the ratio u</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:678"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:368;left:683"><nobr><span class="ft3">/a</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:697"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:368;left:702"><nobr><span class="ft3">. As an example, if n</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:823"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:475"><nobr><span class="ft3">1000,</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:509"><nobr><span class="ft3"> = 25, and u</span></nobr></DIV>
<DIV style="position:absolute;top:389;left:582"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:384;left:588"><nobr><span class="ft3">/a</span></nobr></DIV>
<DIV style="position:absolute;top:389;left:601"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:384;left:610"><nobr><span class="ft3">= 4, then Pr[S[R + 1] = 1] = 0.064.</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:489"><nobr><span class="ft3">The impact of the attack is further reduced if we employ the</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:475"><nobr><span class="ft7">PCSA algorithm in which m independent synopses are computed<br>and the final estimator ¯</span></nobr></DIV>
<DIV style="position:absolute;top:432;left:603"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:431;left:616"><nobr><span class="ft3">is calculated by averaging these m esti-</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:475"><nobr><span class="ft7">mators. As an example, to add an error of 40% to the final Sum,<br>the attacker needs to set the R</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:639"><nobr><span class="ft3">+ 1-th bit in at least</span></nobr></DIV>
<DIV style="position:absolute;top:460;left:752"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:469;left:754"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:462;left:766"><nobr><span class="ft3">synopses. In</span></nobr></DIV>
<DIV style="position:absolute;top:478;left:475"><nobr><span class="ft3">the example above where Pr[S[R</span></nobr></DIV>
<DIV style="position:absolute;top:478;left:656"><nobr><span class="ft3">+ 1] = 1] is 0.064, this probabil-</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:475"><nobr><span class="ft7">ity is close to zero when m is 20. This example illustrates that this<br>attack's impact is limited when</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:646"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:505;left:653"><nobr><span class="ft11"><i> u</i></span></nobr></DIV>
<DIV style="position:absolute;top:509;left:667"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:517;left:653"><nobr><span class="ft11"><i>n a</i></span></nobr></DIV>
<DIV style="position:absolute;top:520;left:667"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:509;left:673"><nobr><span class="ft3">) is small.</span></nobr></DIV>
<DIV style="position:absolute;top:529;left:489"><nobr><span class="ft3">On the other hand, when</span></nobr></DIV>
<DIV style="position:absolute;top:529;left:630"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:524;left:637"><nobr><span class="ft11"><i> u</i></span></nobr></DIV>
<DIV style="position:absolute;top:529;left:651"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:536;left:637"><nobr><span class="ft11"><i>n a</i></span></nobr></DIV>
<DIV style="position:absolute;top:540;left:651"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:529;left:657"><nobr><span class="ft3">) is large, we cannot neglect the</span></nobr></DIV>
<DIV style="position:absolute;top:545;left:475"><nobr><span class="ft7">possibility that the attacker will succeed in injecting a significant<br>error to the Sum computed at the sink. To address this scenario, we<br>can use a scheme in which a node that contributes to the synopsis-<br>edge needs an endorsement from at least</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:704"><nobr><span class="ft3"> neighbors attesting to</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:475"><nobr><span class="ft8">the validity of its sensed value. We assume that the sensed values<br>of one-hop neighbors are correlated so that one node can verify<br>the reading of its neighbors. We assume that there are fewer than<br> compromised nodes among the one hop neighbors of any node.<br>Each contributing node X collects at least</span></nobr></DIV>
<DIV style="position:absolute;top:670;left:703"><nobr><span class="ft3"> endorsements from its</span></nobr></DIV>
<DIV style="position:absolute;top:686;left:475"><nobr><span class="ft8">one-hop neighbors in the form of a MAC computed over the sensor<br>reading using the pairwise key that the neighbor shares with the<br>sink. Then X computes an XMAC [1] by XORing the collected<br>MACs and X 's own MAC, and sends the XMAC to the BS. (Zhu<br>et al. [25] use an identical scheme to reduce the total size of the<br>MACs.) We also assume that BS has the knowledge to verify if a<br>set of nodes are one-hop neighbors, which prevents the collusion<br>attack. (We refer to this scheme as the XMAC-based scheme.)<br>Computation and Communication Overhead</span></nobr></DIV>
<DIV style="position:absolute;top:812;left:750"><nobr><span class="ft3">The number of</span></nobr></DIV>
<DIV style="position:absolute;top:827;left:475"><nobr><span class="ft3">contributing nodes</span></nobr></DIV>
<DIV style="position:absolute;top:827;left:580"><nobr><span class="ft3"> is less than</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:658"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:834;left:658"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:827;left:673"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:824;left:680"><nobr><span class="ft11"><i>2u</i></span></nobr></DIV>
<DIV style="position:absolute;top:828;left:690"><nobr><span class="ft14"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:835;left:683"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:838;left:686"><nobr><span class="ft14"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:827;left:698"><nobr><span class="ft3">-1), where u</span></nobr></DIV>
<DIV style="position:absolute;top:832;left:773"><nobr><span class="ft11"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:827;left:782"><nobr><span class="ft3">and l</span></nobr></DIV>
<DIV style="position:absolute;top:832;left:809"><nobr><span class="ft11"><i>s</i></span></nobr></DIV>
<DIV style="position:absolute;top:827;left:817"><nobr><span class="ft3">are</span></nobr></DIV>
<DIV style="position:absolute;top:845;left:475"><nobr><span class="ft7">the upper bound and lower bound of Sum. As in the case of Count,<br> is independent of the network size and thus this approach is scal-<br>able. With respect to worst case communication overhead, a node<br>will need to forward at most</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:630"><nobr><span class="ft3"> MACs.</span></nobr></DIV>
<DIV style="position:absolute;top:924;left:475"><nobr><span class="ft1">6.</span></nobr></DIV>
<DIV style="position:absolute;top:924;left:507"><nobr><span class="ft12">THE EXTENDED APPROACH: TRADING<br>LATENCY FOR<br>COMMUNICATION OVERHEAD</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:489"><nobr><span class="ft3">When the ratio (</span></nobr></DIV>
<DIV style="position:absolute;top:987;left:581"><nobr><span class="ft3">) of the upper bound of the aggregate to the</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:475"><nobr><span class="ft7">lower bound is high, the basic approach described in the previous<br>section is not scalable because the worst case communication cost<br>incurred by a node is proportional to</span></nobr></DIV>
<DIV style="position:absolute;top:1034;left:675"><nobr><span class="ft3">. In this section, we describe</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:475"><nobr><span class="ft7">an approach which has lower communication costs in comparison<br>to the basic approach at the expense of greater latency.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">76</span></nobr></DIV>
</DIV>
<!-- Page 7 -->
<a name="7"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft19{font-size:7px;font-family:Times;color:#000000;}
	.ft20{font-size:7px;line-height:11px;font-family:Times;color:#000000;}
	.ft21{font-size:7px;line-height:12px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38007.png" alt="background image">
<DIV style="position:absolute;top:83;left:81"><nobr><span class="ft1">6.1</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:121"><nobr><span class="ft1">Protocol Overview</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:94"><nobr><span class="ft3">Our extended approach is based on the observation that the ex-</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:81"><nobr><span class="ft3">pected number of nodes that contribute to bits i, where R</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:386"><nobr><span class="ft3">&lt; i  k in</span></nobr></DIV>
<DIV style="position:absolute;top:137;left:81"><nobr><span class="ft7">the synopsis (k is the length of the synopsis) is very small. In fact,<br>using Property 2 and Property 4 from Section 2, we can show that<br>expected number of nodes contributing to the Rth and higher-order<br>bits of S is less than 2</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:197"><nobr><span class="ft3">/  2.58.</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:94"><nobr><span class="ft3">We use a sliding-window based approach in which the aggre-</span></nobr></DIV>
<DIV style="position:absolute;top:215;left:81"><nobr><span class="ft3">gation phase is divided into multiple epochs</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:317"><nobr><span class="ft11"><i>3</i></span></nobr></DIV>
<DIV style="position:absolute;top:215;left:323"><nobr><span class="ft3">. Starting at the right-</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:81"><nobr><span class="ft7">most bit k, we proceed from right to left within the synopsis S using<br>a bit window of w bits. In each epoch, only the nodes that con-<br>tribute a 1 to the bits in S corresponding to the current position of<br>the window, send MACs to the sink that can be used to verify their<br>contribution to S. In other words, in the first epoch, only nodes that<br>contribute a 1 to bits k to k</span></nobr></DIV>
<DIV style="position:absolute;top:309;left:228"><nobr><span class="ft3">-w+1 respond to the query. In epoch</span></nobr></DIV>
<DIV style="position:absolute;top:325;left:81"><nobr><span class="ft3">two, nodes that contribute to bits between k</span></nobr></DIV>
<DIV style="position:absolute;top:325;left:329"><nobr><span class="ft3">- w and k - 2w + 1</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:81"><nobr><span class="ft3">respond, and so on.</span></nobr></DIV>
<DIV style="position:absolute;top:356;left:94"><nobr><span class="ft3">The algorithm terminates when the querying node has determined</span></nobr></DIV>
<DIV style="position:absolute;top:372;left:81"><nobr><span class="ft7">that the remaining bits of S to the left of the current window are<br>likely to be 1 with high probability. The design of this termination<br>criterion is the main challenge in using this approach; we discuss<br>the termination criterion and its analytical underpinnings in detail.</span></nobr></DIV>
<DIV style="position:absolute;top:435;left:94"><nobr><span class="ft3">Once the querying node determines that the algorithm can termi-</span></nobr></DIV>
<DIV style="position:absolute;top:450;left:81"><nobr><span class="ft7">nate it broadcasts a STOP message to the network to announce the<br>end of the iterative aggregation procedure.</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:81"><nobr><span class="ft1">6.2</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:121"><nobr><span class="ft1">Protocol Operation</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:94"><nobr><span class="ft3">The operation of the protocol is similar to that of the protocol</span></nobr></DIV>
<DIV style="position:absolute;top:532;left:81"><nobr><span class="ft7">used in the basic approach with some minor differences as follows.<br>The query message broadcast to the network includes the window<br>size w in addition to the other parameters. As in the original syn-<br>opsis diffusion algorithm [3, 14], we assume that the time is syn-<br>chronized among BS and the sensor nodes. Each node computes<br>the start and end time of the current epoch, based on the window w.</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:94"><nobr><span class="ft3">Further, although the MACs generated by nodes are sent to the</span></nobr></DIV>
<DIV style="position:absolute;top:642;left:81"><nobr><span class="ft7">BS over the course of multiple epochs, the fused synopsis com-<br>puted by each node is forwarded to its parent in the first epoch.<br>Thus, the BS can compute the aggregate at the end of the first epoch<br>itself, although this aggregate may be erroneous in the presence of<br>compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:81"><nobr><span class="ft1">6.3</span></nobr></DIV>
<DIV style="position:absolute;top:733;left:121"><nobr><span class="ft1">Termination Criterion</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:94"><nobr><span class="ft3">The goal of our algorithm is to find r, the lowest-order bit in S</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:81"><nobr><span class="ft3">that is 0. Further, recall that S is of the form 1</span></nobr></DIV>
<DIV style="position:absolute;top:769;left:336"><nobr><span class="ft11"><i>r</i></span></nobr></DIV>
<DIV style="position:absolute;top:768;left:340"><nobr><span class="ft11"><i>-1</i></span></nobr></DIV>
<DIV style="position:absolute;top:771;left:354"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:378"><nobr><span class="ft3">, where the</span></nobr></DIV>
<DIV style="position:absolute;top:787;left:81"><nobr><span class="ft3">bits at positions i</span></nobr></DIV>
<DIV style="position:absolute;top:786;left:177"><nobr><span class="ft3">&gt; r are highly likely to be 0. Thus, the intuition</span></nobr></DIV>
<DIV style="position:absolute;top:802;left:81"><nobr><span class="ft7">behind our termination criterion is simple: as we examine the bits<br>of S moving from right to left, if we observe two consecutive 1's,<br>i.e., if we observe the string "110", it is highly likely that the 0<br>is at the rth position. In fact, we can show analytically that the<br>probability of this event is greater than 90% which follows from<br>the following theorem.</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:94"><nobr><span class="ft3">Theorem 2.</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:163"><nobr><span class="ft3">Let F denote the event that the string "0s</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:380"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:896;left:384"><nobr><span class="ft3">11" where</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:81"><nobr><span class="ft3">s</span></nobr></DIV>
<DIV style="position:absolute;top:910;left:86"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:912;left:94"><nobr><span class="ft3">represents any string of length l, l</span></nobr></DIV>
<DIV style="position:absolute;top:912;left:284"><nobr><span class="ft3"> 0 appears in a synopsis S.</span></nobr></DIV>
<DIV style="position:absolute;top:928;left:81"><nobr><span class="ft7">The probability of the event F is less than 10%. (The proof is given<br>in the appendix.)</span></nobr></DIV>
<DIV style="position:absolute;top:959;left:94"><nobr><span class="ft3">Further, we can take advantage of the fact that most applications</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:81"><nobr><span class="ft7">will use the PCSA algorithm to reduce the approximation error in<br>estimating R</span></nobr></DIV>
<DIV style="position:absolute;top:990;left:150"><nobr><span class="ft3">= r -1. Recall that in the PCSA algorithm m synopses</span></nobr></DIV>
<DIV style="position:absolute;top:1006;left:81"><nobr><span class="ft3">are computed in parallel. Let R</span></nobr></DIV>
<DIV style="position:absolute;top:1011;left:256"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:1006;left:265"><nobr><span class="ft3">denote the value of R estimated</span></nobr></DIV>
<DIV style="position:absolute;top:1022;left:81"><nobr><span class="ft3">from the ith synopsis. Then, according to the PCSA algorithm,</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:81"><nobr><span class="ft11"><i>3</i></span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:87"><nobr><span class="ft3">The original synopsis diffusion algorithm [3, 14] takes one epoch</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:81"><nobr><span class="ft3">to complete.</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:475"><nobr><span class="ft7">the the expected value of the random variable R is estimated by<br>averaging the individual values of R for each synopsis, i.e., E</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:805"><nobr><span class="ft3">[R] =</span></nobr></DIV>
<DIV style="position:absolute;top:115;left:478"><nobr><span class="ft3">¯</span></nobr></DIV>
<DIV style="position:absolute;top:118;left:475"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:486"><nobr><span class="ft3">= </span></nobr></DIV>
<DIV style="position:absolute;top:115;left:509"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:114;left:512"><nobr><span class="ft11"><i>=m</i></span></nobr></DIV>
<DIV style="position:absolute;top:124;left:509"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:123;left:512"><nobr><span class="ft11"><i>=1</i></span></nobr></DIV>
<DIV style="position:absolute;top:118;left:530"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:122;left:539"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:117;left:542"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:489"><nobr><span class="ft3">Although there is likely to be some variation among the R</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:807"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:133;left:811"><nobr><span class="ft3">, we</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:475"><nobr><span class="ft7">know from Property 3 in Section 2 that the variation is expected<br>to correspond to two bit position both to the left and the right of<br>the true value of R. This suggests that there is a high degree of<br>correlation between the R</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:619"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:196;left:629"><nobr><span class="ft3">for different synopses. Thus, in our</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:475"><nobr><span class="ft7">window-based approach, we can increase our confidence that we<br>have found the correct position of R, if we observe the bit pattern<br>"11" in multiple synopses among the m that are being computed in<br>parallel. Based on this intuition, our termination criterion consists<br>of checking whether we have observed the string "11" in at least m</span></nobr></DIV>
<DIV style="position:absolute;top:271;left:830"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:290;left:475"><nobr><span class="ft3">out of the m synopses.</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:680"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:699"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:679"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:405;left:679"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:698"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:700"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:699"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:679"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:477"><nobr><span class="ft19">1st Synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:478"><nobr><span class="ft19">2nd Synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:475"><nobr><span class="ft19">m-th Synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:405;left:476"><nobr><span class="ft19">3rd Synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:780"><nobr><span class="ft20">1st position of<br>   the window</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:616"><nobr><span class="ft19">the aggregation</span></nobr></DIV>
<DIV style="position:absolute;top:576;left:616"><nobr><span class="ft19">after this window</span></nobr></DIV>
<DIV style="position:absolute;top:565;left:616"><nobr><span class="ft19">process stops</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:690"><nobr><span class="ft19">the termination-test</span></nobr></DIV>
<DIV style="position:absolute;top:565;left:689"><nobr><span class="ft21">passes in this<br>   window</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:658"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:639"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:643"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:662"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:639"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:516;left:643"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:516;left:658"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:658"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:612;left:475"><nobr><span class="ft7">Figure 3: Each synopsis is divided into several windows of<br>width w</span></nobr></DIV>
<DIV style="position:absolute;top:627;left:526"><nobr><span class="ft3">= 2 bits. After the termination criterion is satisfied,</span></nobr></DIV>
<DIV style="position:absolute;top:643;left:475"><nobr><span class="ft7">the base station broadcasts a STOP message and the aggrega-<br>tion phase stops after the next epoch. In each epoch, nodes<br>which contribute to the corresponding window send a MAC to<br>the base station. The MACs which correspond to the crossed<br>bits are never sent.</span></nobr></DIV>
<DIV style="position:absolute;top:752;left:489"><nobr><span class="ft3">Our goal in selecting the threshold m</span></nobr></DIV>
<DIV style="position:absolute;top:749;left:687"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:752;left:694"><nobr><span class="ft3">is to reduce the likelihood</span></nobr></DIV>
<DIV style="position:absolute;top:768;left:475"><nobr><span class="ft7">of both a false positive, which means that the algorithm was ter-<br>minated too early, and a false negative, which means that the al-<br>gorithm terminated too late, i.e., after the sliding window had al-<br>ready crossed the true position of R. A false positive results in an<br>over-estimate of R, whereas a false negative results in additional<br>communication overhead. We now show that it is possible to find a<br>suitable value for m</span></nobr></DIV>
<DIV style="position:absolute;top:859;left:582"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:862;left:590"><nobr><span class="ft3">such that the probability of false positive and</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:475"><nobr><span class="ft3">the probability of false negative are both low.</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:489"><nobr><span class="ft3">Theorem 3.</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:558"><nobr><span class="ft3">Let G</span></nobr></DIV>
<DIV style="position:absolute;top:898;left:589"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:894;left:596"><nobr><span class="ft3">denote the event that both bit i and</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:785"><nobr><span class="ft3">(i + 1) in</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:475"><nobr><span class="ft3">a synopsis S are 1. Let</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:598"><nobr><span class="ft3"> denote the expected value of the estimator</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:478"><nobr><span class="ft3">¯</span></nobr></DIV>
<DIV style="position:absolute;top:926;left:475"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:483"><nobr><span class="ft3">. Then, Pr</span></nobr></DIV>
<DIV style="position:absolute;top:925;left:544"><nobr><span class="ft3">[G</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:558"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:925;left:564"><nobr><span class="ft3">] = 0.3454, Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:658"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:925;left:678"><nobr><span class="ft3">] = 0.1315, and Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:930;left:796"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:925;left:816"><nobr><span class="ft3">] =</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:475"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:940;left:482"><nobr><span class="ft3">.0412.</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:489"><nobr><span class="ft3">Because of space limitations, the proof of this theorem can be</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:475"><nobr><span class="ft3">found in the appendix.</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:489"><nobr><span class="ft3">If the sliding window in our algorithm is two bits wide, i.e, w</span></nobr></DIV>
<DIV style="position:absolute;top:987;left:811"><nobr><span class="ft3">= 2,</span></nobr></DIV>
<DIV style="position:absolute;top:1003;left:475"><nobr><span class="ft7">from the definition of the false positive (FP), we get that the prob-<br>ability Pr</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:526"><nobr><span class="ft3">[FP] is the probability that the event G</span></nobr></DIV>
<DIV style="position:absolute;top:1024;left:741"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:766"><nobr><span class="ft3">occurs in m</span></nobr></DIV>
<DIV style="position:absolute;top:1016;left:830"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:475"><nobr><span class="ft7">or more synopses. Similarly, the probability of a false negative,<br>Pr</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:487"><nobr><span class="ft3">[FN] is the probability that the event G</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:697"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:707"><nobr><span class="ft3">occurs in fewer than m</span></nobr></DIV>
<DIV style="position:absolute;top:1048;left:830"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:475"><nobr><span class="ft3">synopses. For m</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:568"><nobr><span class="ft3">= 20 (which is the typical value used in previous</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">77</span></nobr></DIV>
</DIV>
<!-- Page 8 -->
<a name="8"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="38008.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft3">work [3, 14], we find that the best value of m</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:332"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:340"><nobr><span class="ft3">is 4 in which case</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:93"><nobr><span class="ft3">[FP] = 0.0082 and Pr[FN] = 0.0484. The same approach illus-</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:81"><nobr><span class="ft3">trated here can be used to derive the appropriate threshold m</span></nobr></DIV>
<DIV style="position:absolute;top:114;left:416"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:117;left:424"><nobr><span class="ft3">for</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:81"><nobr><span class="ft3">other window sizes.</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:94"><nobr><span class="ft3">Figure 3 illustrates the operation of our algorithm for w</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:393"><nobr><span class="ft3">= 2. As-</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:81"><nobr><span class="ft7">sume that the termination criterion is satisfied in epoch e. The BS<br>broadcasts a STOP message which directs all nodes to terminate<br>the aggregation phase. Note that by the time each node in the net-<br>work receives the broadcast STOP message, many of the nodes will<br>have already sent MACs corresponding to their contributions to the<br>next epoch e</span></nobr></DIV>
<DIV style="position:absolute;top:242;left:151"><nobr><span class="ft3">+ 1 of the algorithm. Thus, the effect of the termina-</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:81"><nobr><span class="ft7">tion criterion being satisfied in epoch e message is to terminate the<br>aggregation after epoch e</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:219"><nobr><span class="ft3">+ 1.</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:94"><nobr><span class="ft3">We can take advantage of this extra epoch to further increase our</span></nobr></DIV>
<DIV style="position:absolute;top:306;left:81"><nobr><span class="ft7">level of confidence in the estimated value of R. Let the bit position<br>of the sliding window in epoch e correspond to bits</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:369"><nobr><span class="ft3"> and  + 1.</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:81"><nobr><span class="ft3">Instead of estimating R</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:209"><nobr><span class="ft3">=  + 1 because m</span></nobr></DIV>
<DIV style="position:absolute;top:334;left:312"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:337;left:319"><nobr><span class="ft3">out of m synopses had</span></nobr></DIV>
<DIV style="position:absolute;top:353;left:81"><nobr><span class="ft3">both bits</span></nobr></DIV>
<DIV style="position:absolute;top:352;left:129"><nobr><span class="ft3"> and +1 equal to 1, we can now estimate R based on the</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:81"><nobr><span class="ft3">observed value of R</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:187"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:368;left:194"><nobr><span class="ft3">for all m synopses. Our simulations show that</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:81"><nobr><span class="ft8">estimate of the aggregate computed using our extended approach is<br>close to the estimate computed using the original synopsis diffusion<br>[3, 14] algorithm.<br>Latency</span></nobr></DIV>
<DIV style="position:absolute;top:431;left:131"><nobr><span class="ft3">The number of epochs taken by our sliding window ap-</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:81"><nobr><span class="ft3">proach depends on the ratio (</span></nobr></DIV>
<DIV style="position:absolute;top:446;left:235"><nobr><span class="ft3">) of the upper bound of the aggregate</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:81"><nobr><span class="ft7">to the actual value. If the upper bound is u and the actual value is<br>, for a window of width w the number of epochs is equal to</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:143"><nobr><span class="ft3">(log</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:174"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:507;left:183"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:184"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:511;left:197"><nobr><span class="ft3">-log</span></nobr></DIV>
<DIV style="position:absolute;top:517;left:227"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:507;left:236"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:237"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:532;left:197"><nobr><span class="ft3">w</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:249"><nobr><span class="ft3">+2) = (log</span></nobr></DIV>
<DIV style="position:absolute;top:518;left:328"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:512;left:335"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:532;left:322"><nobr><span class="ft3">w</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:345"><nobr><span class="ft3">+2)</span></nobr></DIV>
<DIV style="position:absolute;top:558;left:81"><nobr><span class="ft3">Communication Overhead</span></nobr></DIV>
<DIV style="position:absolute;top:558;left:241"><nobr><span class="ft3">Theorem 3 implies that it is highly</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:81"><nobr><span class="ft3">likely that the sliding window contains the position ¯</span></nobr></DIV>
<DIV style="position:absolute;top:574;left:358"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:573;left:369"><nobr><span class="ft3">when the ter-</span></nobr></DIV>
<DIV style="position:absolute;top:589;left:81"><nobr><span class="ft7">mination criterion is satisfied. As discussed above, if the termina-<br>tion criterion is satisfied in epoch e, the aggregation completes after<br>epoch e</span></nobr></DIV>
<DIV style="position:absolute;top:620;left:124"><nobr><span class="ft3">+ 1. Thus, by property 2 and property 4 in Section 2, if m</span></nobr></DIV>
<DIV style="position:absolute;top:636;left:81"><nobr><span class="ft7">synopses are computed in parallel, the expected number of nodes<br>which send a MAC varies in the range of</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:303"><nobr><span class="ft3">(2.58 ×m) to (5.16×m).</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:81"><nobr><span class="ft7">Even if a sensor node contributes to more than one bits, it sends<br>just one MAC validating all the bits. Note that the number of con-<br>tributing nodes does not exceed this range even if the network size<br>is increased. Our simulation results show that 85 MACs are sent on<br>average when m</span></nobr></DIV>
<DIV style="position:absolute;top:730;left:171"><nobr><span class="ft3">= 20.</span></nobr></DIV>
<DIV style="position:absolute;top:746;left:94"><nobr><span class="ft3">We observe that the width of the window w determines a tradeoff</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:81"><nobr><span class="ft7">between the communication overhead and the latency. If we divide<br>the synopses into wider windows, the number of MACs sent and<br>hence the communication overhead will increase while the latency<br>of the aggregation process will decrease, and vice versa.</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:81"><nobr><span class="ft1">6.4</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:121"><nobr><span class="ft1">Discussion</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:94"><nobr><span class="ft3">An alternative approach to the sliding window-based approach</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:81"><nobr><span class="ft7">described above is one in which the base station computes the ag-<br>gregate of interest in the first epoch using the original Synopsis<br>Diffusion algorithm. It then broadcasts a message requesting only<br>the nodes that contribute to the bit window that contains R to send<br>the MACs authenticating their local synopses. If the BS success-<br>fully verifies all the MACs it receives, then the protocol terminates<br>at the end of the second epoch. However, if it does not receive the<br>requested MACs or if one or more MACs are invalid, the BS exe-<br>cutes the sliding-window protocol described above to compute the<br>correct value of R. If the probability of compromised nodes be-<br>ing present in the network is low, then this alternative approach is<br>preferable to the extended approach since it will have much lower<br>latency on average.</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:475"><nobr><span class="ft1">7.</span></nobr></DIV>
<DIV style="position:absolute;top:83;left:507"><nobr><span class="ft1">SIMULATION RESULTS</span></nobr></DIV>
<DIV style="position:absolute;top:105;left:489"><nobr><span class="ft3">In this section, we report on a detailed simulation study that ex-</span></nobr></DIV>
<DIV style="position:absolute;top:121;left:475"><nobr><span class="ft7">amined the performance of our attack-resilient aggregation algo-<br>rithms discussed in Sections 5 and 6. Our simulations were writ-<br>ten using the TAG simulator developed by Madden et al. [11]. We<br>added the attack-resilient functionality to the source code provided<br>by Considine et al. [3] which simulates their multipath aggregation<br>algorithms in the TAG simulator environment.</span></nobr></DIV>
<DIV style="position:absolute;top:226;left:475"><nobr><span class="ft1">7.1</span></nobr></DIV>
<DIV style="position:absolute;top:226;left:516"><nobr><span class="ft1">Simulation Environment</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:489"><nobr><span class="ft3">For our basic experimental network topology, we used a regular</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:475"><nobr><span class="ft3">30</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:491"><nobr><span class="ft3">×30 grid with 900 sensor nodes, where one sensor is placed at</span></nobr></DIV>
<DIV style="position:absolute;top:280;left:475"><nobr><span class="ft7">each grid point and the base station is at the center of the grid, as in<br>[3]. The communication radius of each node is 2 unit allowing<br>the nearest eight grid neighbors to be reached.</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:489"><nobr><span class="ft3">The goal of our simulation experiments is to examine the com-</span></nobr></DIV>
<DIV style="position:absolute;top:343;left:475"><nobr><span class="ft7">munication overhead and accuracy of our scheme in the presence<br>of packet losses, which are relatively frequent in sensor networks.<br>We use a simple packet loss model in which packets are dropped<br>with a fixed probability; this packet loss rate is assumed to include<br>packets that are lost due to being dropped by compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:489"><nobr><span class="ft3">We do not model any additional attacks by compromised nodes,</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:475"><nobr><span class="ft7">specifically the falsified subaggregate and the falsified local value<br>attacks, in our simulation. This is because we have already shown<br>that these attacks cannot affect the estimate of the aggregate com-<br>puted at the sink. Consequently, these attacks simply have the effect<br>of increasing the communication and computation overhead; in ef-<br>fect, they become a form of DOS or resource consumption attacks.</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:489"><nobr><span class="ft3">We assign a unique id to each sensor, and we assume that the sen-</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:475"><nobr><span class="ft7">sor reading is a random integer uniformly distributed in the range<br>of 0 to 250 units. We compute 20 synopses in parallel using the<br>PCSA algorithm as in the experiments reported in [3, 14]. We use<br>the method of independent replications as our simulation method-<br>ology. Each simulation experiment was repeated 200 times with a<br>different seed. The plots below show the 95% confidence intervals<br>of the reported metric.</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:475"><nobr><span class="ft1">7.2</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:516"><nobr><span class="ft1">Results and Discussion</span></nobr></DIV>
<DIV style="position:absolute;top:690;left:489"><nobr><span class="ft3">Due to space constraints, we will only present the results of our</span></nobr></DIV>
<DIV style="position:absolute;top:705;left:475"><nobr><span class="ft8">extended approach for computing the Sum aggregate.<br>Accuracy of our estimate</span></nobr></DIV>
<DIV style="position:absolute;top:721;left:625"><nobr><span class="ft3">In the first set of experiments, we val-</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:475"><nobr><span class="ft7">idate our claim that our attack-resilient approach has the same ac-<br>curacy in computing the true value of the aggregate as the original<br>synopsis diffusion approach. Figure 4a plots the estimates of our<br>approach and the synopsis diffusion approach as a function of the<br>packet loss rate. We observe that the two estimates are indeed very<br>close in all loss rate conditions. We observe that the average value<br>of the sensor reading is approximately 125, i.e., the accurate Sum<br>is 900</span></nobr></DIV>
<DIV style="position:absolute;top:846;left:510"><nobr><span class="ft3">×125 = 11250.</span></nobr></DIV>
<DIV style="position:absolute;top:863;left:475"><nobr><span class="ft3">Communication overhead</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:629"><nobr><span class="ft3">We now compare the communication</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:475"><nobr><span class="ft7">overhead of our approach to that of the original synopsis diffusion<br>approach. Figure 4(b) plots the total number of bytes transmitted<br>for computing the Sum aggregate. As discussed in Section 5.3,<br>for preventing a node from using a false reading to generate its<br>own local synopsis, we can adopt two approaches. In the first ap-<br>proach, we ignore the impact of the falsified local value attack; in<br>the figure, this approach is labeled as ARSD (attack-resilient syn-<br>opsis diffusion). The second approach requires the contributing<br>node to include a XMAC, which corresponds to an endorsement<br>from its neighbors, in the message; in the figure, this approach is<br>labeled ARSD+XMAC.</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:489"><nobr><span class="ft3">For ARSD+XMAC, each contributing node sends an authentica-</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:475"><nobr><span class="ft3">tion message which has two parts: the first part contains the ID (2</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">78</span></nobr></DIV>
</DIV>
<!-- Page 9 -->
<a name="9"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft22{font-size:4px;font-family:Times;color:#000000;}
	.ft23{font-size:8px;line-height:11px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38009.png" alt="background image">
<DIV style="position:absolute;top:263;left:249"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:263;left:307"><nobr><span class="ft11"><i>0.1</i></span></nobr></DIV>
<DIV style="position:absolute;top:263;left:370"><nobr><span class="ft11"><i>0.2</i></span></nobr></DIV>
<DIV style="position:absolute;top:263;left:433"><nobr><span class="ft11"><i>0.3</i></span></nobr></DIV>
<DIV style="position:absolute;top:256;left:236"><nobr><span class="ft11"><i>0.6</i></span></nobr></DIV>
<DIV style="position:absolute;top:223;left:236"><nobr><span class="ft11"><i>0.8</i></span></nobr></DIV>
<DIV style="position:absolute;top:190;left:244"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:156;left:236"><nobr><span class="ft11"><i>1.2</i></span></nobr></DIV>
<DIV style="position:absolute;top:123;left:236"><nobr><span class="ft11"><i>1.4</i></span></nobr></DIV>
<DIV style="position:absolute;top:101;left:251"><nobr><span class="ft11"><i>x 10</i></span></nobr></DIV>
<DIV style="position:absolute;top:97;left:271"><nobr><span class="ft22">5</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:312"><nobr><span class="ft11"><i>Link Loss Rate</i></span></nobr></DIV>
<DIV style="position:absolute;top:212;left:238"><nobr><span class="ft11"><i>Estimated Sum</i></span></nobr></DIV>
<DIV style="position:absolute;top:125;left:393"><nobr><span class="ft23"><i>ARSD<br> SD</i></span></nobr></DIV>
<DIV style="position:absolute;top:170;left:362"><nobr><span class="ft11"><i>Actual Sum </i></span></nobr></DIV>
<DIV style="position:absolute;top:263;left:485"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:543"><nobr><span class="ft19">0.1</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:605"><nobr><span class="ft19">0.2</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:667"><nobr><span class="ft19">0.3</span></nobr></DIV>
<DIV style="position:absolute;top:256;left:481"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:230;left:481"><nobr><span class="ft19">2</span></nobr></DIV>
<DIV style="position:absolute;top:203;left:481"><nobr><span class="ft19">3</span></nobr></DIV>
<DIV style="position:absolute;top:176;left:481"><nobr><span class="ft19">4</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:481"><nobr><span class="ft19">5</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:481"><nobr><span class="ft19">6</span></nobr></DIV>
<DIV style="position:absolute;top:104;left:488"><nobr><span class="ft19">x 10</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:507"><nobr><span class="ft22">4</span></nobr></DIV>
<DIV style="position:absolute;top:272;left:548"><nobr><span class="ft19">Link Loss Rate</span></nobr></DIV>
<DIV style="position:absolute;top:230;left:479"><nobr><span class="ft19">Total Byte Transmitted</span></nobr></DIV>
<DIV style="position:absolute;top:155;left:590"><nobr><span class="ft20">ARSD<br>ARSD+XMAC<br>SD</span></nobr></DIV>
<DIV style="position:absolute;top:292;left:297"><nobr><span class="ft11"><i>a. Accuracy of Sum</i></span></nobr></DIV>
<DIV style="position:absolute;top:292;left:540"><nobr><span class="ft11"><i>b. Byte overhead</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:248"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:279"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:310"><nobr><span class="ft11"><i>4</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:342"><nobr><span class="ft11"><i>6</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:373"><nobr><span class="ft11"><i>8</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:401"><nobr><span class="ft11"><i>10</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:432"><nobr><span class="ft11"><i>12</i></span></nobr></DIV>
<DIV style="position:absolute;top:457;left:244"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:424;left:244"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:391;left:244"><nobr><span class="ft11"><i>4</i></span></nobr></DIV>
<DIV style="position:absolute;top:358;left:244"><nobr><span class="ft11"><i>6</i></span></nobr></DIV>
<DIV style="position:absolute;top:326;left:244"><nobr><span class="ft11"><i>8</i></span></nobr></DIV>
<DIV style="position:absolute;top:471;left:279"><nobr><span class="ft11"><i>Log (upper bound / actual Sum)</i></span></nobr></DIV>
<DIV style="position:absolute;top:420;left:242"><nobr><span class="ft11"><i>Number of epochs</i></span></nobr></DIV>
<DIV style="position:absolute;top:328;left:315"><nobr><span class="ft11"><i>ARSD (window width=2)</i></span></nobr></DIV>
<DIV style="position:absolute;top:464;left:506"><nobr><span class="ft19">1000</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:546"><nobr><span class="ft19">2000</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:585"><nobr><span class="ft19">3000</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:624"><nobr><span class="ft19">4000</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:663"><nobr><span class="ft19">5000</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:478"><nobr><span class="ft19">40</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:478"><nobr><span class="ft19">60</span></nobr></DIV>
<DIV style="position:absolute;top:385;left:478"><nobr><span class="ft19">80</span></nobr></DIV>
<DIV style="position:absolute;top:348;left:472"><nobr><span class="ft19">100</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:472"><nobr><span class="ft19">120</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:532"><nobr><span class="ft19">Number of sensor nodes</span></nobr></DIV>
<DIV style="position:absolute;top:447;left:475"><nobr><span class="ft19">Number of Contributing nodes</span></nobr></DIV>
<DIV style="position:absolute;top:324;left:637"><nobr><span class="ft19">ARSD</span></nobr></DIV>
<DIV style="position:absolute;top:493;left:317"><nobr><span class="ft11"><i>c. Latency</i></span></nobr></DIV>
<DIV style="position:absolute;top:493;left:518"><nobr><span class="ft11"><i>d. Varying the network size</i></span></nobr></DIV>
<DIV style="position:absolute;top:535;left:367"><nobr><span class="ft3">Figure 4: Experimental Results</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:81"><nobr><span class="ft7">bytes) of the contributing node and its sensed value (3 bytes), and<br>the second part includes the IDs of the k neighbors and a XMAC<br>(4 bytes). If the value of k is not more than 4 then a node needs<br>8 bytes to specify the identity of the neighbors whose MACs are<br>used to generate the XMAC. Thus, the size of one authentication<br>message is 17 bytes. For ARSD, the contributing node just needs<br>to send its own MAC; no neighbor endorsement is needed, which<br>reduces the authentication message size to 9 bytes.</span></nobr></DIV>
<DIV style="position:absolute;top:705;left:94"><nobr><span class="ft3">Figure 4(b) shows that the byte overhead of the ARSD+XMAC</span></nobr></DIV>
<DIV style="position:absolute;top:721;left:81"><nobr><span class="ft8">scheme is roughly 5 times larger than the original approach, whereas<br>ARSD is 2.5 times larger than the original approach. One might ex-<br>pect that if loss rate is high our extended approach may take more<br>time to stop because some MACs could be lost en-route, and, as a<br>result, the communication overhead could increase. But Figure 4(b)<br>demonstrates that the overhead of the extended approach does not<br>increase with the loss rate.<br>Latency</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:132"><nobr><span class="ft3">As discussed in Section 6, the latency of the extended</span></nobr></DIV>
<DIV style="position:absolute;top:846;left:81"><nobr><span class="ft8">approach depends on the looseness of the base station's estimate of<br>the upper bound of Sum. Figure 4(c) plots the number of epochs<br>taken by our extended approach as a function of the ratio of the<br>upper bound to the actual value of the aggregate. The figure shows<br>that the number of epochs increases at logarithmic scale with the<br>ratio of the upper bound to the actual Sum. We note, however, that<br>the byte overhead of our scheme is independent of this ratio.<br>Effect of network size</span></nobr></DIV>
<DIV style="position:absolute;top:956;left:210"><nobr><span class="ft3">In this experiment, we study the impact of</span></nobr></DIV>
<DIV style="position:absolute;top:972;left:81"><nobr><span class="ft7">the network size on the communication overhead of the extended<br>approach. The communication overhead depends upon the number<br>of contributing nodes that send a MAC to the base station, authen-<br>ticating their synopsis. Recall from Section 6 that the expected<br>number of contributing nodes is independent of the network size.<br>Figure 4(d) confirms our analysis; we observe that the number of<br>contributing nodes is more or less constant as the network size in-</span></nobr></DIV>
<DIV style="position:absolute;top:579;left:475"><nobr><span class="ft3">creases</span></nobr></DIV>
<DIV style="position:absolute;top:577;left:514"><nobr><span class="ft11"><i>4</i></span></nobr></DIV>
<DIV style="position:absolute;top:579;left:520"><nobr><span class="ft3">. This figure thus illustrates the scalability of our approach</span></nobr></DIV>
<DIV style="position:absolute;top:595;left:475"><nobr><span class="ft3">for attack-resilient aggregation.</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:475"><nobr><span class="ft1">8.</span></nobr></DIV>
<DIV style="position:absolute;top:628;left:507"><nobr><span class="ft1">RELATED WORK</span></nobr></DIV>
<DIV style="position:absolute;top:650;left:489"><nobr><span class="ft3">Several data aggregation protocols [11, 19, 23] have been pro-</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:475"><nobr><span class="ft7">posed in the literature which efficiently fuse the sensed information<br>en-route to the base station to reduce the communication overhead.<br>Since packet losses and node failures are relatively common in sen-<br>sor networks, several studies have investigated the design of robust<br>aggregation algorithms. Considine et al. [3] and Nath et al. [14,<br>12] have presented robust aggregation approaches that combine the<br>use of multi-path routing with clever algorithms that avoid double-<br>counting of sensor readings. Jelasity et al. [9] proposed a robust<br>gossip-based protocol for computing aggregates over network com-<br>ponents in a fully decentralized fashion. They assume that nodes<br>form an overlay network where any pair of nodes are considered to<br>be neighbors, which makes this protocol impractical for sensor net-<br>works. We note that none of the above algorithms were designed<br>with security in mind.</span></nobr></DIV>
<DIV style="position:absolute;top:885;left:489"><nobr><span class="ft3">Recently several researchers have examined security issues in</span></nobr></DIV>
<DIV style="position:absolute;top:901;left:475"><nobr><span class="ft7">aggregation. Wagner [17] examined the problem of resilient data<br>aggregation in presence of malicious nodes, and provided guide-<br>lines for selecting aggregation functions in a sensor network. Buttyan<br>et al. [2] proposed a model of resilient aggregation and analyzed<br>the maximum deviation from the true value of the aggregate that an<br>adversary could introduce while remaining undetected. The mod-<br>els used by by both Buttyan et al and Wagner assume that there is<br>no in-network aggregation, that is, the aggregation is performed at<br>the sink. Przydatek et al [16] present protocols that can be used by<br>a trusted remote user to query a sensor network in which the base</span></nobr></DIV>
<DIV style="position:absolute;top:1063;left:476"><nobr><span class="ft11"><i>4</i></span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:482"><nobr><span class="ft3">The link loss rate is held at 20% in this set of experiments.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">79</span></nobr></DIV>
</DIV>
<!-- Page 10 -->
<a name="10"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="38010.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft7">station may be compromised and the base station is the only aggre-<br>gator. One of the protocols described by Przydatek et al is a robust<br>approach for counting distinct elements in a data stream that can<br>be used for estimating the size of the network, i.e., the Count ag-<br>gregate. Their approach for counting distinct elements is similar to<br>our scheme for Count in the sense that in both cases only a subset<br>of elements need to be verified.</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:94"><nobr><span class="ft3">The first secure in-network data aggregation protocol was de-</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:81"><nobr><span class="ft7">signed by Hu and Evans [8]. Their protocol is effective only if no<br>more than one node is compromised. Recently, Yang et al. [18] pro-<br>posed SDAP, a secure hop-by-hop data aggregation protocol which<br>can tolerate more than one compromised node. SDAP is a tree-<br>based aggregation protocol with communication cost comparable<br>with that of the ordinary aggregation protocols while it provides<br>certain level of assurance on the trustworthiness of the aggregation<br>result. As SDAP is a tree-based protocol, it is vulnerable to link<br>loss and node failures which are relatively common in sensor net-<br>works, whereas our protocol is robust to this communication loss<br>and, at the same time, secure against compromised nodes.</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:94"><nobr><span class="ft3">We note that our work is related to the general problem of pre-</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:81"><nobr><span class="ft7">venting false data injection. Du et al. [4] proposed a mechanism<br>that allows the base station to check the aggregated values submit-<br>ted by several designated aggregators, based on the endorsements<br>provided by a certain number of witness nodes around the aggrega-<br>tors. Their scheme does not provide per-hop aggregation. Several<br>other works [20, 21, 25] have also proposed solutions to prevent<br>false data injection attacks in sensor networks, but they do not in-<br>volve data aggregation.</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:81"><nobr><span class="ft1">9.</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:112"><nobr><span class="ft1">CONCLUSION</span></nobr></DIV>
<DIV style="position:absolute;top:571;left:94"><nobr><span class="ft3">In this paper, we investigated the security issues of synopsis dif-</span></nobr></DIV>
<DIV style="position:absolute;top:587;left:81"><nobr><span class="ft7">fusion framework in presence of compromised nodes. We showed<br>that a compromised node can launch several simple attacks on the<br>existing aggregation algorithms, which could significantly deviate<br>the estimate of the aggregate. We also proposed modifications to<br>the aggregation algorithms that guard against these attacks. Our<br>analytical results and simulation results show that our approach is<br>effective and it incurs minimal computation and communication<br>overhead.</span></nobr></DIV>
<DIV style="position:absolute;top:712;left:94"><nobr><span class="ft3">In this paper, we assume that a sensor node has a security associ-</span></nobr></DIV>
<DIV style="position:absolute;top:728;left:81"><nobr><span class="ft7">ation only with the base station, and, as a result, the authentication<br>messages cannot be processed in-network in our approach. To fur-<br>ther reduce the communication overhead, we plan to exploit other<br>security settings, e.g., local pairwise keys among nodes, as a part<br>of our future work.</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:81"><nobr><span class="ft1">10.</span></nobr></DIV>
<DIV style="position:absolute;top:831;left:121"><nobr><span class="ft1">REFERENCES</span></nobr></DIV>
<DIV style="position:absolute;top:858;left:87"><nobr><span class="ft3">[1] M. Bellare, R. Guerin, and P. Rogaway. XOR MACs: New</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:110"><nobr><span class="ft7">methods for message authentication using finite<br>pseudorandom functions. In Proc. of the 15th Annual<br>International Cryptology Conference on Advances in<br>Cryptology - CRYPTO'95</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:249"><nobr><span class="ft3">, pages 15­28, 1995.</span></nobr></DIV>
<DIV style="position:absolute;top:938;left:87"><nobr><span class="ft3">[2] L. Buttyan, P. Schaffer, and I. Vajda. Resilient aggregation</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:110"><nobr><span class="ft7">with attack detection in sensor networks. In Proc. of 2nd<br>IEEE Workshop on Sensor Networks and Systems for<br>Pervasive Computing</span></nobr></DIV>
<DIV style="position:absolute;top:985;left:225"><nobr><span class="ft3">, 2006.</span></nobr></DIV>
<DIV style="position:absolute;top:1002;left:87"><nobr><span class="ft3">[3] J. Considine, F. Li, G. Kollios, and J. Byers. Approximate</span></nobr></DIV>
<DIV style="position:absolute;top:1018;left:110"><nobr><span class="ft8">aggregation techniques for sensor databases. In Proc. of<br>IEEE Int'l Conf. on Data Engineering (ICDE)</span></nobr></DIV>
<DIV style="position:absolute;top:1033;left:359"><nobr><span class="ft3">, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:87"><nobr><span class="ft3">[4] W. Du, J. Deng, Y. S. Han, and P. Varshney. A pairwise key</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:110"><nobr><span class="ft3">pre-distribution scheme for wireless sensor networks. In</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:504"><nobr><span class="ft7">Proc. of the 10th ACM Conference on Computer and<br>Communications Security (CCS '03).</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:705"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:119;left:482"><nobr><span class="ft3">[5] P. Flajolet and G. N. Martin. Probabilistic counting</span></nobr></DIV>
<DIV style="position:absolute;top:134;left:504"><nobr><span class="ft8">algorithms for data base applications. Journal of Computer<br>and System Sciences</span></nobr></DIV>
<DIV style="position:absolute;top:150;left:615"><nobr><span class="ft3">, 31(2):182­209, 1985.</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:482"><nobr><span class="ft3">[6] S. Ganeriwal and M. B. Sribastava. Reputation-based</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:504"><nobr><span class="ft7">framework for highly integrity sensor networks. In Proc. of<br>ACM Workshop on Security of Sensor and Adhoc Networks<br>(SASN)</span></nobr></DIV>
<DIV style="position:absolute;top:214;left:544"><nobr><span class="ft3">, Washington, DC, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:482"><nobr><span class="ft3">[7] D. Ganesan, R. Govindan, S. Shenker, and D. Estrin.</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:504"><nobr><span class="ft8">Highly-resilient energy-efficient multipath routing in<br>wireless sensor networks. Mobile Comuting and<br>Communication Review</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:632"><nobr><span class="ft3">, 4(5):11­25, 2001.</span></nobr></DIV>
<DIV style="position:absolute;top:296;left:482"><nobr><span class="ft3">[8] L. Hu and D. Evans. Secure aggregation for wireless</span></nobr></DIV>
<DIV style="position:absolute;top:312;left:504"><nobr><span class="ft8">networks. In Proc. of Workshop on Security and Assurance in<br>Ad hoc Networks.</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:600"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:482"><nobr><span class="ft3">[9] M. Jelasity, A. Montresor, and O. Babaoglu. Gossip-based</span></nobr></DIV>
<DIV style="position:absolute;top:360;left:504"><nobr><span class="ft8">aggregation in large dynamic networks. ACM Transactions<br>on Computer Systems</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:621"><nobr><span class="ft3">, 23(3):219­252, 2005.</span></nobr></DIV>
<DIV style="position:absolute;top:393;left:475"><nobr><span class="ft3">[10] F. Koushanfar, M. Potkonjak, and</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:504"><nobr><span class="ft8">A. Sangiovanni-Vincentelli. Fault tolerance techniques in<br>wireless ad-hoc sensor networks. In Sensors 2002.<br>Proceedings of IEEE</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:617"><nobr><span class="ft3">, pages 1491 ­ 1496.</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:475"><nobr><span class="ft3">[11] S. Madden, M. J. Franklin, J.M. Hellerstein, and W. Hong.</span></nobr></DIV>
<DIV style="position:absolute;top:473;left:504"><nobr><span class="ft8">TAG: A tiny aggregation service for ad hoc sensor networks.<br>In Proc. of 5th USENIX Symposium on Operating Systems<br>Design and Implementation</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:654"><nobr><span class="ft3">, 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:521;left:475"><nobr><span class="ft3">[12] A. Manjhi, S. Nath, and P. Gibbons. Tributeries and deltas :</span></nobr></DIV>
<DIV style="position:absolute;top:537;left:504"><nobr><span class="ft8">Efficient and robust aggregation in sensor network streams.<br>In Proc. of ACM International Conference on Management<br>of Data (SIGMOD)</span></nobr></DIV>
<DIV style="position:absolute;top:569;left:609"><nobr><span class="ft3">, 2005.</span></nobr></DIV>
<DIV style="position:absolute;top:586;left:475"><nobr><span class="ft18">[13] Mica Motes. http://www.xbow.com.<br>[14] S. Nath, P. B. Gibbons, S. Seshan, and Z. Anderson.</span></nobr></DIV>
<DIV style="position:absolute;top:619;left:504"><nobr><span class="ft8">Synopsis diffusion for robust aggregation in sensor networks.<br>In Proc. of the 2nd international conference on Embedded<br>networked sensor systems (SenSys)</span></nobr></DIV>
<DIV style="position:absolute;top:650;left:693"><nobr><span class="ft3">, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:475"><nobr><span class="ft3">[15] A. Perrig, R. Szewczyk, V. Wen, D. Culler, and J. D. Tygar.</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:504"><nobr><span class="ft7">SPINS: Security protocols for sensor networks. In Seventh<br>Annual International Conference on Mobile Computing and<br>Networks (MobiCOM)</span></nobr></DIV>
<DIV style="position:absolute;top:714;left:626"><nobr><span class="ft3">, 2001.</span></nobr></DIV>
<DIV style="position:absolute;top:731;left:475"><nobr><span class="ft3">[16] B. Przydatek, D. Song, and A. Perrig. SIA: Secure</span></nobr></DIV>
<DIV style="position:absolute;top:747;left:504"><nobr><span class="ft7">information aggregation in sensor networks. In Proc. of the<br>1st international conference on Embedded networked sensor<br>systems (SenSys)</span></nobr></DIV>
<DIV style="position:absolute;top:779;left:595"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:796;left:475"><nobr><span class="ft3">[17] D. Wagner. Resilient aggregation in sensor networks. In</span></nobr></DIV>
<DIV style="position:absolute;top:812;left:504"><nobr><span class="ft7">Proc. of ACM Workshop on Security of Sensor and Adhoc<br>Networks (SASN)</span></nobr></DIV>
<DIV style="position:absolute;top:827;left:598"><nobr><span class="ft3">, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:844;left:475"><nobr><span class="ft3">[18] Y. Yang, X. Wang, S. Zhu, and G. Cao. SDAP: A secure</span></nobr></DIV>
<DIV style="position:absolute;top:860;left:504"><nobr><span class="ft7">hop-by-hop data aggregation protocol for sensor networks.<br>In Proc. of ACM MOBIHOC, 2006.</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:475"><nobr><span class="ft3">[19] Y. Yao and J. E. Gehrke. The cougar approach to in-network</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:504"><nobr><span class="ft7">query processing in sensor networks. ACM SIGMOD Record,<br>31(2):9­18, September 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:475"><nobr><span class="ft3">[20] Fan Ye, Haiyun Luo, Songwu Lu, and Lixia Zhang.</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:504"><nobr><span class="ft7">Statistical en-route filtering of injected false data in sensor<br>networks. In Proc. of IEEE Infocom, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:990;left:475"><nobr><span class="ft3">[21] W. Zhang and G. Cao. Group rekeying for filtering false data</span></nobr></DIV>
<DIV style="position:absolute;top:1006;left:504"><nobr><span class="ft7">in sensor networks: A predistribution and local<br>collaboration-based approach. Proc. of IEEE Infocom, 2005.</span></nobr></DIV>
<DIV style="position:absolute;top:1039;left:475"><nobr><span class="ft3">[22] J. Zhao and R. Govindan. Understanding packet delivery</span></nobr></DIV>
<DIV style="position:absolute;top:1054;left:504"><nobr><span class="ft3">performance in dense wireless sensor networks. In Proc. of</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">80</span></nobr></DIV>
</DIV>
<!-- Page 11 -->
<a name="11"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft24{font-size:15px;line-height:23px;font-family:Times;color:#000000;}
	.ft25{font-size:11px;line-height:19px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38011.png" alt="background image">
<DIV style="position:absolute;top:86;left:110"><nobr><span class="ft7">the 1st international conference on Embedded networked<br>sensor systems (SenSys)</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:239"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:119;left:81"><nobr><span class="ft3">[23] J. Zhao, R. Govindan, and D. Estrin. Computing aggregates</span></nobr></DIV>
<DIV style="position:absolute;top:134;left:110"><nobr><span class="ft7">for monitoring sensor networks. In Proc. of the 2nd IEEE<br>International Workshop on Sensor Network Protocols and<br>Applications</span></nobr></DIV>
<DIV style="position:absolute;top:166;left:178"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:183;left:81"><nobr><span class="ft3">[24] S. Zhu, S. Setia, and S. Jajodia. LEAP: Efficient security</span></nobr></DIV>
<DIV style="position:absolute;top:199;left:110"><nobr><span class="ft7">mechanisms for large-scale distributed sensor networks. In<br>Proc. of the 10th ACM Conference on Computer and<br>Communications Security (CCS '03).</span></nobr></DIV>
<DIV style="position:absolute;top:230;left:310"><nobr><span class="ft3">, 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:81"><nobr><span class="ft3">[25] S. Zhu, S. Setia, S. Jajodia, and P. Ning. An interleaved</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:110"><nobr><span class="ft8">hop-by-hop authentication scheme for filtering injected false<br>data in sensor networks. In Proc. of IEEE Symposium on<br>Security and Privacy</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:223"><nobr><span class="ft3">, 2004.</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:81"><nobr><span class="ft24">Appendix<br>A.</span></nobr></DIV>
<DIV style="position:absolute;top:374;left:81"><nobr><span class="ft7">Below we describe the algorithm (SecureCount) executed by each<br>node in response to a Count query. X represents the node Id.</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:81"><nobr><span class="ft3">Algorithm 2</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:154"><nobr><span class="ft3">SecureCount(X</span></nobr></DIV>
<DIV style="position:absolute;top:420;left:237"><nobr><span class="ft3">, Seed, a, b)</span></nobr></DIV>
<DIV style="position:absolute;top:441;left:86"><nobr><span class="ft3">1:</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:104"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:440;left:122"><nobr><span class="ft3">= {}; //</span></nobr></DIV>
<DIV style="position:absolute;top:440;left:167"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:441;left:186"><nobr><span class="ft3">is initialized as an empty set</span></nobr></DIV>
<DIV style="position:absolute;top:456;left:86"><nobr><span class="ft3">2: i</span></nobr></DIV>
<DIV style="position:absolute;top:456;left:110"><nobr><span class="ft3">= SG(X, Seed); // X contributes to bit i</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:86"><nobr><span class="ft3">3: if (a</span></nobr></DIV>
<DIV style="position:absolute;top:472;left:129"><nobr><span class="ft3"> i  b) then</span></nobr></DIV>
<DIV style="position:absolute;top:488;left:86"><nobr><span class="ft3">4:</span></nobr></DIV>
<DIV style="position:absolute;top:488;left:117"><nobr><span class="ft3">m</span></nobr></DIV>
<DIV style="position:absolute;top:487;left:130"><nobr><span class="ft3">= [X|i|Seed];</span></nobr></DIV>
<DIV style="position:absolute;top:503;left:86"><nobr><span class="ft3">5:</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:117"><nobr><span class="ft3">M</span></nobr></DIV>
<DIV style="position:absolute;top:503;left:132"><nobr><span class="ft3">= MAC(K</span></nobr></DIV>
<DIV style="position:absolute;top:508;left:187"><nobr><span class="ft11"><i>X</i></span></nobr></DIV>
<DIV style="position:absolute;top:503;left:195"><nobr><span class="ft3">, m);</span></nobr></DIV>
<DIV style="position:absolute;top:519;left:86"><nobr><span class="ft3">6:</span></nobr></DIV>
<DIV style="position:absolute;top:519;left:117"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:135"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:519;left:149"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:166"><nobr><span class="ft3">M;</span></nobr></DIV>
<DIV style="position:absolute;top:535;left:86"><nobr><span class="ft7">7: end if<br>8: S</span></nobr></DIV>
<DIV style="position:absolute;top:556;left:110"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:550;left:117"><nobr><span class="ft3">= SF(); // S</span></nobr></DIV>
<DIV style="position:absolute;top:556;left:182"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:551;left:190"><nobr><span class="ft3">is the fused synopsis at X</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:86"><nobr><span class="ft3">9:</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:104"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:566;left:122"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:135"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:566;left:152"><nobr><span class="ft3"></span></nobr></DIV>
<DIV style="position:absolute;top:566;left:163"><nobr><span class="ft16"><i>C</i></span></nobr></DIV>
<DIV style="position:absolute;top:566;left:173"><nobr><span class="ft3">; //</span></nobr></DIV>
<DIV style="position:absolute;top:566;left:191"><nobr><span class="ft16"><i>C</i></span></nobr></DIV>
<DIV style="position:absolute;top:566;left:203"><nobr><span class="ft3">represents the set of MACs X received from</span></nobr></DIV>
<DIV style="position:absolute;top:582;left:104"><nobr><span class="ft3">// its child nodes</span></nobr></DIV>
<DIV style="position:absolute;top:598;left:81"><nobr><span class="ft3">10: X</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:117"><nobr><span class="ft3">  : S</span></nobr></DIV>
<DIV style="position:absolute;top:603;left:157"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:597;left:161"><nobr><span class="ft3">|</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:165"><nobr><span class="ft16"><i>M</i></span></nobr></DIV>
<DIV style="position:absolute;top:598;left:180"><nobr><span class="ft3">;</span></nobr></DIV>
<DIV style="position:absolute;top:643;left:81"><nobr><span class="ft1">B. Proofs of Theorems</span></nobr></DIV>
<DIV style="position:absolute;top:668;left:81"><nobr><span class="ft3">We provide the proofs for the theorems present in the paper.</span></nobr></DIV>
<DIV style="position:absolute;top:684;left:94"><nobr><span class="ft3">Theorem 1.</span></nobr></DIV>
<DIV style="position:absolute;top:683;left:166"><nobr><span class="ft3">Let there be n nodes in the sensor network among</span></nobr></DIV>
<DIV style="position:absolute;top:699;left:81"><nobr><span class="ft3">which</span></nobr></DIV>
<DIV style="position:absolute;top:699;left:118"><nobr><span class="ft3"> nodes are compromised. Let u</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:298"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:699;left:308"><nobr><span class="ft3">and a</span></nobr></DIV>
<DIV style="position:absolute;top:704;left:338"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:699;left:348"><nobr><span class="ft3">denote the upper</span></nobr></DIV>
<DIV style="position:absolute;top:715;left:81"><nobr><span class="ft8">bound and the average value of the sensor reading respectively. Let<br>S</span></nobr></DIV>
<DIV style="position:absolute;top:731;left:91"><nobr><span class="ft3">be the final synposis computed at the sink and let R be the length</span></nobr></DIV>
<DIV style="position:absolute;top:746;left:81"><nobr><span class="ft7">of the prefix of all ones in S. Let s denote the value of the Sum<br>aggregate. If each compromised node claims that its sensed value is<br>equal to the upper bound u</span></nobr></DIV>
<DIV style="position:absolute;top:782;left:224"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:778;left:229"><nobr><span class="ft3">, and if</span></nobr></DIV>
<DIV style="position:absolute;top:777;left:269"><nobr><span class="ft3">( u</span></nobr></DIV>
<DIV style="position:absolute;top:782;left:296"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:777;left:301"><nobr><span class="ft3">) &lt; s, then the probability</span></nobr></DIV>
<DIV style="position:absolute;top:793;left:81"><nobr><span class="ft3">Pr[S</span></nobr></DIV>
<DIV style="position:absolute;top:793;left:104"><nobr><span class="ft3">[R + 1] = 1] is proportional to the product of the fraction of</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:81"><nobr><span class="ft3">compromised nodes in the network,</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:276"><nobr><span class="ft3">/n, and the ratio u</span></nobr></DIV>
<DIV style="position:absolute;top:814;left:381"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:809;left:387"><nobr><span class="ft3">/a</span></nobr></DIV>
<DIV style="position:absolute;top:814;left:400"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:809;left:405"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:830;left:96"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:832;left:104"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:830;left:134"><nobr><span class="ft3">. By property 2 in Section 2, the expected value of the</span></nobr></DIV>
<DIV style="position:absolute;top:846;left:81"><nobr><span class="ft3">estimator R, for the Sum synopsis S, is log</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:314"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:845;left:322"><nobr><span class="ft3">(s), where s denotes</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:81"><nobr><span class="ft8">the Sum. As a node X with sensed value v invokes the function<br>CT() v times (in the synopsis generation phase), the probability that<br>X</span></nobr></DIV>
<DIV style="position:absolute;top:893;left:94"><nobr><span class="ft3">does not contribute to bit i in S is</span></nobr></DIV>
<DIV style="position:absolute;top:892;left:277"><nobr><span class="ft3">(1 -</span></nobr></DIV>
<DIV style="position:absolute;top:890;left:307"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:900;left:305"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:900;left:311"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:892;left:315"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:890;left:321"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:894;left:326"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:893;left:331"><nobr><span class="ft3">. So, the probability</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:81"><nobr><span class="ft3">(p) that a node with sensed value u</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:267"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:908;left:275"><nobr><span class="ft3">will contribute to the</span></nobr></DIV>
<DIV style="position:absolute;top:908;left:390"><nobr><span class="ft3">(R + 1)th</span></nobr></DIV>
<DIV style="position:absolute;top:924;left:81"><nobr><span class="ft3">bit is (1</span></nobr></DIV>
<DIV style="position:absolute;top:924;left:124"><nobr><span class="ft3">-(1-</span></nobr></DIV>
<DIV style="position:absolute;top:921;left:171"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:932;left:164"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:931;left:169"><nobr><span class="ft14"><i>R</i></span></nobr></DIV>
<DIV style="position:absolute;top:931;left:174"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:924;left:186"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:922;left:191"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:925;left:196"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:924;left:201"><nobr><span class="ft3">). After simplifying, we get</span></nobr></DIV>
<DIV style="position:absolute;top:958;left:141"><nobr><span class="ft3">p</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:151"><nobr><span class="ft3">= 1 -(1- 1</span></nobr></DIV>
<DIV style="position:absolute;top:967;left:213"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:966;left:220"><nobr><span class="ft3">s )</span></nobr></DIV>
<DIV style="position:absolute;top:954;left:239"><nobr><span class="ft11"><i>u</i></span></nobr></DIV>
<DIV style="position:absolute;top:958;left:245"><nobr><span class="ft14"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:957;left:252"><nobr><span class="ft3"> 1-(1- u</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:325"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:967;left:315"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:966;left:321"><nobr><span class="ft3">s ) =</span></nobr></DIV>
<DIV style="position:absolute;top:949;left:362"><nobr><span class="ft3">u</span></nobr></DIV>
<DIV style="position:absolute;top:953;left:369"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:967;left:359"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:966;left:366"><nobr><span class="ft3">s</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:81"><nobr><span class="ft3">The above approximation is valid as u</span></nobr></DIV>
<DIV style="position:absolute;top:993;left:290"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:988;left:300"><nobr><span class="ft3">is smaller than s. If there</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:81"><nobr><span class="ft3">are</span></nobr></DIV>
<DIV style="position:absolute;top:1004;left:100"><nobr><span class="ft3"> compromised nodes, then Pr (S[R + 1] = 1) is</span></nobr></DIV>
<DIV style="position:absolute;top:1036;left:123"><nobr><span class="ft3">q</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:132"><nobr><span class="ft3">= 1 -(1- p)</span></nobr></DIV>
<DIV style="position:absolute;top:1032;left:206"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:215"><nobr><span class="ft3">  p = u</span></nobr></DIV>
<DIV style="position:absolute;top:1031;left:284"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:270"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:1044;left:276"><nobr><span class="ft3">s = (</span></nobr></DIV>
<DIV style="position:absolute;top:1026;left:318"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:314"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:1044;left:321"><nobr><span class="ft3"> ) (</span></nobr></DIV>
<DIV style="position:absolute;top:1026;left:349"><nobr><span class="ft25"><br>n ) (</span></nobr></DIV>
<DIV style="position:absolute;top:1027;left:378"><nobr><span class="ft3">u</span></nobr></DIV>
<DIV style="position:absolute;top:1031;left:385"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:378"><nobr><span class="ft3">a</span></nobr></DIV>
<DIV style="position:absolute;top:1049;left:385"><nobr><span class="ft11"><i>v</i></span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:392"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:489"><nobr><span class="ft3">To prove Theorem 2, we first prove the following results.</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:475"><nobr><span class="ft3">Lemma 1.</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:542"><nobr><span class="ft3">Let E</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:572"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:102;left:576"><nobr><span class="ft3">, 1</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:595"><nobr><span class="ft3"> i  k -2 denote the event that the string</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:475"><nobr><span class="ft3">"011" appears in a synopsis S from bit i to bit</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:723"><nobr><span class="ft3">(i + 2) (i.e., S[i] = 0,</span></nobr></DIV>
<DIV style="position:absolute;top:134;left:475"><nobr><span class="ft3">S</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:482"><nobr><span class="ft3">[i + 1] = 1, and S[i + 2] = 1), where k is the length of S. The</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:475"><nobr><span class="ft3">maximum value of the probability (p</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:676"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:149;left:680"><nobr><span class="ft3">) of the event E</span></nobr></DIV>
<DIV style="position:absolute;top:153;left:764"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:149;left:771"><nobr><span class="ft3">is 0.037 for</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:475"><nobr><span class="ft3">any value of i and for any value of Count (or Sum) shared by S.</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:490"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:189;left:499"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:187;left:529"><nobr><span class="ft3">. If function CT</span></nobr></DIV>
<DIV style="position:absolute;top:187;left:618"><nobr><span class="ft3">() is invoked once (ref. Section 2), then</span></nobr></DIV>
<DIV style="position:absolute;top:203;left:475"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:203;left:487"><nobr><span class="ft3">[S[ j] = 1] = q</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:563"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:203;left:570"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:200;left:587"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:211;left:585"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:210;left:591"><nobr><span class="ft14"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:203;left:596"><nobr><span class="ft3">, 1  j  k. This probability increases if it is</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:475"><nobr><span class="ft3">given that bit j</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:555"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:220;left:559"><nobr><span class="ft3">, 1</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:575"><nobr><span class="ft3"> j</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:595"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:220;left:601"><nobr><span class="ft3"> k will remain 0. Specifically,</span></nobr></DIV>
<DIV style="position:absolute;top:252;left:519"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:531"><nobr><span class="ft3">[S[ j] = 1|S[j</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:599"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:251;left:602"><nobr><span class="ft3">] = 0] =</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:663"><nobr><span class="ft3">q</span></nobr></DIV>
<DIV style="position:absolute;top:247;left:671"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:261;left:651"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:261;left:660"><nobr><span class="ft3">-q</span></nobr></DIV>
<DIV style="position:absolute;top:266;left:680"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:264;left:684"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:251;left:692"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:243;left:742"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:262;left:707"><nobr><span class="ft3">(2</span></nobr></DIV>
<DIV style="position:absolute;top:261;left:721"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:725"><nobr><span class="ft3">) (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:769"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:271;left:765"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:271;left:772"><nobr><span class="ft14"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:268;left:774"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:779"><nobr><span class="ft3">) .</span></nobr></DIV>
<DIV style="position:absolute;top:289;left:475"><nobr><span class="ft3">If</span></nobr></DIV>
<DIV style="position:absolute;top:289;left:487"><nobr><span class="ft3"> is the total Count (or Sum) shared by synopsis S, then Pr[S[i] =</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:475"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:482"><nobr><span class="ft3">] = (1 -q</span></nobr></DIV>
<DIV style="position:absolute;top:310;left:535"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:305;left:539"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:302;left:544"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:305;left:552"><nobr><span class="ft3">, and</span></nobr></DIV>
<DIV style="position:absolute;top:330;left:538"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:550"><nobr><span class="ft3">[S[i + 1] = 1, S[i + 2] = 1]</span></nobr></DIV>
<DIV style="position:absolute;top:345;left:538"><nobr><span class="ft3">= 1 -Pr[S[i+1] = 0]-Pr[S[i+2] = 0]</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:546"><nobr><span class="ft3">+ Pr[S[i + 1] = 0, S[i + 2] = 0]</span></nobr></DIV>
<DIV style="position:absolute;top:361;left:754"><nobr><span class="ft3">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:376;left:538"><nobr><span class="ft3">= 1 -(1-q</span></nobr></DIV>
<DIV style="position:absolute;top:382;left:605"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:381;left:608"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:376;left:622"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:374;left:627"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:376;left:637"><nobr><span class="ft3">-(1-q</span></nobr></DIV>
<DIV style="position:absolute;top:382;left:682"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:381;left:685"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:376;left:699"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:374;left:704"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:392;left:546"><nobr><span class="ft3">+ (1 -q</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:591"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:397;left:594"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:392;left:610"><nobr><span class="ft3">-q</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:629"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:397;left:632"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:392;left:646"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:389;left:651"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:410;left:538"><nobr><span class="ft3">= 1 -(1-</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:606"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:418;left:600"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:418;left:605"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:417;left:607"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:410;left:619"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:624"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:410;left:634"><nobr><span class="ft3">-(1-</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:681"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:418;left:674"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:418;left:680"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:417;left:682"><nobr><span class="ft14"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:410;left:694"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:404;left:699"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:429;left:546"><nobr><span class="ft3">+ (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:593"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:586"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:592"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:436;left:594"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:429;left:608"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:426;left:628"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:622"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:437;left:627"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:436;left:629"><nobr><span class="ft14"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:429;left:641"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:423;left:646"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:454;left:475"><nobr><span class="ft3">So, the probability of the event E</span></nobr></DIV>
<DIV style="position:absolute;top:459;left:653"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:454;left:660"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:479;left:519"><nobr><span class="ft3">p</span></nobr></DIV>
<DIV style="position:absolute;top:483;left:526"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:478;left:533"><nobr><span class="ft3">= Pr[S[i] = 0]×</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:546"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:558"><nobr><span class="ft3">[S[i + 1] = 1, S[i + 2] = 1 | S[i] = 0]</span></nobr></DIV>
<DIV style="position:absolute;top:512;left:533"><nobr><span class="ft3">= (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:575"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:520;left:574"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:579"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:512;left:583"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:506;left:589"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:512;left:597"><nobr><span class="ft3">×</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:546"><nobr><span class="ft3">[1 -(1-</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:626"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:598"><nobr><span class="ft11"><i>(2</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:608"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:610"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:620"><nobr><span class="ft11"><i>) (1-</i></span></nobr></DIV>
<DIV style="position:absolute;top:538;left:647"><nobr><span class="ft14"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:547;left:646"><nobr><span class="ft14"><i>2i</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:654"><nobr><span class="ft11"><i>)</i></span></nobr></DIV>
<DIV style="position:absolute;top:531;left:660"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:665"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:531;left:675"><nobr><span class="ft3">-(1-</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:743"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:715"><nobr><span class="ft11"><i>(2</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:725"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:727"><nobr><span class="ft14"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:737"><nobr><span class="ft11"><i>) (1-</i></span></nobr></DIV>
<DIV style="position:absolute;top:538;left:765"><nobr><span class="ft14"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:547;left:763"><nobr><span class="ft14"><i>2i</i></span></nobr></DIV>
<DIV style="position:absolute;top:539;left:772"><nobr><span class="ft11"><i>)</i></span></nobr></DIV>
<DIV style="position:absolute;top:531;left:778"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:525;left:783"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:548"><nobr><span class="ft3">+ (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:553;left:615"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:588"><nobr><span class="ft11"><i>(2</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:597"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:599"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:609"><nobr><span class="ft11"><i>) (1-</i></span></nobr></DIV>
<DIV style="position:absolute;top:563;left:637"><nobr><span class="ft14"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:572;left:636"><nobr><span class="ft14"><i>2i</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:644"><nobr><span class="ft11"><i>)</i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:652"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:553;left:693"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:666"><nobr><span class="ft11"><i>(2</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:675"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:677"><nobr><span class="ft14"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:687"><nobr><span class="ft11"><i>) (1-</i></span></nobr></DIV>
<DIV style="position:absolute;top:563;left:715"><nobr><span class="ft14"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:572;left:714"><nobr><span class="ft14"><i>2i</i></span></nobr></DIV>
<DIV style="position:absolute;top:564;left:722"><nobr><span class="ft11"><i>)</i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:728"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:550;left:733"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:556;left:741"><nobr><span class="ft3">]</span></nobr></DIV>
<DIV style="position:absolute;top:556;left:765"><nobr><span class="ft3">(2)</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:475"><nobr><span class="ft3">Note that if i</span></nobr></DIV>
<DIV style="position:absolute;top:588;left:550"><nobr><span class="ft3">&lt;&lt; log</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:592"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:588;left:598"><nobr><span class="ft3">(), the 1st factor is close to 0 and second</span></nobr></DIV>
<DIV style="position:absolute;top:603;left:475"><nobr><span class="ft3">factor is close to 1, making p</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:641"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:603;left:650"><nobr><span class="ft3">close to 0. On the other hand, if</span></nobr></DIV>
<DIV style="position:absolute;top:620;left:475"><nobr><span class="ft3">i</span></nobr></DIV>
<DIV style="position:absolute;top:619;left:483"><nobr><span class="ft3">&gt;&gt; log</span></nobr></DIV>
<DIV style="position:absolute;top:624;left:525"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:619;left:531"><nobr><span class="ft3">(), the 1st factor is close to 1, but the 2nd factor are</span></nobr></DIV>
<DIV style="position:absolute;top:635;left:475"><nobr><span class="ft3">close to 0, again making p</span></nobr></DIV>
<DIV style="position:absolute;top:640;left:620"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:635;left:627"><nobr><span class="ft3">close to 0. p</span></nobr></DIV>
<DIV style="position:absolute;top:640;left:696"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:635;left:703"><nobr><span class="ft3">attains the highest value</span></nobr></DIV>
<DIV style="position:absolute;top:651;left:475"><nobr><span class="ft3">when i is close to log</span></nobr></DIV>
<DIV style="position:absolute;top:655;left:597"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:650;left:603"><nobr><span class="ft3">(). We have numerically found that the</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:475"><nobr><span class="ft3">maximum value of p</span></nobr></DIV>
<DIV style="position:absolute;top:671;left:588"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:666;left:595"><nobr><span class="ft3">is 0.037, for any value of i or</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:754"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:475"><nobr><span class="ft3">Lemma 2.</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:538"><nobr><span class="ft3">Let E denote the event that the string "011" appears in</span></nobr></DIV>
<DIV style="position:absolute;top:741;left:475"><nobr><span class="ft7">a synopsis S at any position. The probability of the event E is less<br>than 0.099.</span></nobr></DIV>
<DIV style="position:absolute;top:779;left:490"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:781;left:499"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:779;left:529"><nobr><span class="ft3">. E</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:547"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:779;left:555"><nobr><span class="ft3">denotes the event that "011" appears in a synopsis</span></nobr></DIV>
<DIV style="position:absolute;top:796;left:475"><nobr><span class="ft3">S</span></nobr></DIV>
<DIV style="position:absolute;top:795;left:487"><nobr><span class="ft3">where 0 is at the ith bit. We observe that the events E</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:793"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:795;left:797"><nobr><span class="ft3">, E</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:813"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:799;left:816"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:795;left:831"><nobr><span class="ft3">,</span></nobr></DIV>
<DIV style="position:absolute;top:811;left:475"><nobr><span class="ft3">E</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:483"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:815;left:486"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:811;left:506"><nobr><span class="ft3">are mutually exclusive, for any value of i. Following the</span></nobr></DIV>
<DIV style="position:absolute;top:826;left:475"><nobr><span class="ft7">same direction of Lemma 1, we can show that the probability that<br>" 011s</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:511"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:842;left:515"><nobr><span class="ft3">011" appears in synopsis S is close to zero, where s</span></nobr></DIV>
<DIV style="position:absolute;top:840;left:804"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:842;left:812"><nobr><span class="ft3">rep-</span></nobr></DIV>
<DIV style="position:absolute;top:858;left:475"><nobr><span class="ft3">resents any string of length l, l</span></nobr></DIV>
<DIV style="position:absolute;top:858;left:650"><nobr><span class="ft3"> 0. So, the probability that two</span></nobr></DIV>
<DIV style="position:absolute;top:874;left:475"><nobr><span class="ft3">events E</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:520"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:874;left:527"><nobr><span class="ft3">and E</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:560"><nobr><span class="ft11"><i>j</i></span></nobr></DIV>
<DIV style="position:absolute;top:874;left:567"><nobr><span class="ft3">where j</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:612"><nobr><span class="ft3"> (i+3) can occur together is negligible,</span></nobr></DIV>
<DIV style="position:absolute;top:889;left:475"><nobr><span class="ft3">for any value of i. As a result, we can approximate that events E</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:825"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:889;left:829"><nobr><span class="ft3">s</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:475"><nobr><span class="ft3">are mutually exclusive and hence the probability of event E is</span></nobr></DIV>
<DIV style="position:absolute;top:942;left:627"><nobr><span class="ft3">p</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:637"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:656"><nobr><span class="ft11"><i>k</i></span></nobr></DIV>
<DIV style="position:absolute;top:939;left:651"><nobr><span class="ft17"></span></nobr></DIV>
<DIV style="position:absolute;top:958;left:650"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:957;left:653"><nobr><span class="ft11"><i>=1</i></span></nobr></DIV>
<DIV style="position:absolute;top:942;left:669"><nobr><span class="ft3">p</span></nobr></DIV>
<DIV style="position:absolute;top:946;left:676"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:941;left:679"><nobr><span class="ft3">,</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:475"><nobr><span class="ft3">where p</span></nobr></DIV>
<DIV style="position:absolute;top:981;left:520"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:976;left:528"><nobr><span class="ft3">is given by expression (2) and k is the length of S. We</span></nobr></DIV>
<DIV style="position:absolute;top:992;left:475"><nobr><span class="ft3">have numerically found that maximum value of p is 0.099.</span></nobr></DIV>
<DIV style="position:absolute;top:1051;left:475"><nobr><span class="ft3">Lemma 3.</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:543"><nobr><span class="ft3">Let F</span></nobr></DIV>
<DIV style="position:absolute;top:1055;left:572"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:581"><nobr><span class="ft3">denote the event that a string "0s</span></nobr></DIV>
<DIV style="position:absolute;top:1048;left:765"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:769"><nobr><span class="ft3">11" appears</span></nobr></DIV>
<DIV style="position:absolute;top:1066;left:475"><nobr><span class="ft3">in a synopsis S, and let F denote the general event that a string</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">81</span></nobr></DIV>
</DIV>
<!-- Page 12 -->
<a name="12"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft26{font-size:5px;line-height:7px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="38012.png" alt="background image">
<DIV style="position:absolute;top:86;left:81"><nobr><span class="ft3">"0s</span></nobr></DIV>
<DIV style="position:absolute;top:84;left:99"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:103"><nobr><span class="ft3">11", l</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:136"><nobr><span class="ft3"> 0 appears in S, where s</span></nobr></DIV>
<DIV style="position:absolute;top:84;left:271"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:278"><nobr><span class="ft3">represents any string of length</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:81"><nobr><span class="ft3">l</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:85"><nobr><span class="ft3">. Pr</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:105"><nobr><span class="ft3">[F] = Pr[F</span></nobr></DIV>
<DIV style="position:absolute;top:106;left:160"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:101;left:166"><nobr><span class="ft3">]</span></nobr></DIV>
<DIV style="position:absolute;top:126;left:96"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:128;left:104"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:126;left:134"><nobr><span class="ft3">. As the string "011" is a special case of string "0s</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:416"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:126;left:420"><nobr><span class="ft3">11"</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:81"><nobr><span class="ft3">where l</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:128"><nobr><span class="ft3">= 0, Pr[F]  Pr[F</span></nobr></DIV>
<DIV style="position:absolute;top:146;left:229"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:141;left:235"><nobr><span class="ft3">]. On the other hand, if string s</span></nobr></DIV>
<DIV style="position:absolute;top:138;left:421"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:141;left:429"><nobr><span class="ft3">=</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:81"><nobr><span class="ft3">"0s</span></nobr></DIV>
<DIV style="position:absolute;top:155;left:99"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:157;left:103"><nobr><span class="ft3">11", l</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:140"><nobr><span class="ft3"> 0 appears in S, string "011" must also appear as a</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:81"><nobr><span class="ft3">substring of s</span></nobr></DIV>
<DIV style="position:absolute;top:170;left:155"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:173;left:159"><nobr><span class="ft3">. As an example, if s</span></nobr></DIV>
<DIV style="position:absolute;top:170;left:276"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:172;left:283"><nobr><span class="ft3">= "01011" where s</span></nobr></DIV>
<DIV style="position:absolute;top:170;left:389"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:172;left:397"><nobr><span class="ft3">= "10",</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:81"><nobr><span class="ft3">we can see "011" as a substring of s</span></nobr></DIV>
<DIV style="position:absolute;top:185;left:279"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:188;left:283"><nobr><span class="ft3">. Hence, Pr</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:346"><nobr><span class="ft3">[F]  Pr[F</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:403"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:188;left:409"><nobr><span class="ft3">]. So,</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:81"><nobr><span class="ft3">we get that Pr</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:155"><nobr><span class="ft3">[F] = Pr[F</span></nobr></DIV>
<DIV style="position:absolute;top:209;left:211"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:204;left:217"><nobr><span class="ft3">].</span></nobr></DIV>
<DIV style="position:absolute;top:265;left:94"><nobr><span class="ft3">Theorem 2.</span></nobr></DIV>
<DIV style="position:absolute;top:264;left:160"><nobr><span class="ft3">Let F denote the event that the string "0s</span></nobr></DIV>
<DIV style="position:absolute;top:262;left:380"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:264;left:384"><nobr><span class="ft3">11" where</span></nobr></DIV>
<DIV style="position:absolute;top:280;left:81"><nobr><span class="ft3">s</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:86"><nobr><span class="ft11"><i>l</i></span></nobr></DIV>
<DIV style="position:absolute;top:280;left:94"><nobr><span class="ft3">represents any string of length l, l</span></nobr></DIV>
<DIV style="position:absolute;top:280;left:284"><nobr><span class="ft3"> 0 appears in a synopsis S.</span></nobr></DIV>
<DIV style="position:absolute;top:296;left:81"><nobr><span class="ft3">The probability of the event F is less than 10%.</span></nobr></DIV>
<DIV style="position:absolute;top:320;left:96"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:104"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:320;left:134"><nobr><span class="ft3">. As the event F</span></nobr></DIV>
<DIV style="position:absolute;top:324;left:227"><nobr><span class="ft11"><i>0</i></span></nobr></DIV>
<DIV style="position:absolute;top:320;left:238"><nobr><span class="ft3">in Lemma 3 is same as the event E</span></nobr></DIV>
<DIV style="position:absolute;top:335;left:81"><nobr><span class="ft7">in Lemma 2, we get that the probability of event F is less than<br>10%.</span></nobr></DIV>
<DIV style="position:absolute;top:381;left:94"><nobr><span class="ft3">Theorem 3.</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:164"><nobr><span class="ft3">Let G</span></nobr></DIV>
<DIV style="position:absolute;top:385;left:195"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:380;left:202"><nobr><span class="ft3">denote the event that both bit i and</span></nobr></DIV>
<DIV style="position:absolute;top:380;left:391"><nobr><span class="ft3">(i + 1) in</span></nobr></DIV>
<DIV style="position:absolute;top:396;left:81"><nobr><span class="ft3">a synopsis S are 1. Let</span></nobr></DIV>
<DIV style="position:absolute;top:396;left:204"><nobr><span class="ft3"> denote the expected value of the estimator</span></nobr></DIV>
<DIV style="position:absolute;top:409;left:84"><nobr><span class="ft3">¯</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:81"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:89"><nobr><span class="ft3">. Then, Pr</span></nobr></DIV>
<DIV style="position:absolute;top:411;left:150"><nobr><span class="ft3">[G</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:163"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:411;left:170"><nobr><span class="ft3">] = 0.3454, Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:263"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:411;left:283"><nobr><span class="ft3">] = 0.1315, and Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:417;left:401"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:411;left:421"><nobr><span class="ft3">] =</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:81"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:427;left:87"><nobr><span class="ft3">.0412.</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:490"><nobr><span class="ft3">P</span></nobr></DIV>
<DIV style="position:absolute;top:88;left:499"><nobr><span class="ft11"><i>ROOF</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:529"><nobr><span class="ft3">. The expected value of ¯</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:665"><nobr><span class="ft3">R</span></nobr></DIV>
<DIV style="position:absolute;top:86;left:677"><nobr><span class="ft3">is log</span></nobr></DIV>
<DIV style="position:absolute;top:91;left:708"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:715"><nobr><span class="ft3">(</span></nobr></DIV>
<DIV style="position:absolute;top:81;left:739"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:93;left:737"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:86;left:746"><nobr><span class="ft3">), which we de-</span></nobr></DIV>
<DIV style="position:absolute;top:102;left:475"><nobr><span class="ft3">note by</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:517"><nobr><span class="ft3">, where  is the total Count (or Sum) shared by m synopses</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:475"><nobr><span class="ft3">following the algorithm PCSA. If function CT</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:733"><nobr><span class="ft3">() is invoked once</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:475"><nobr><span class="ft3">(ref. Section 2),</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:555"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:566"><nobr><span class="ft3">[S[i] = 1] = q</span></nobr></DIV>
<DIV style="position:absolute;top:169;left:638"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:164;left:645"><nobr><span class="ft3">= 1</span></nobr></DIV>
<DIV style="position:absolute;top:174;left:660"><nobr><span class="ft3">m</span></nobr></DIV>
<DIV style="position:absolute;top:155;left:683"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:681"><nobr><span class="ft3">2</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:688"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:164;left:693"><nobr><span class="ft3">, 1  i  k</span></nobr></DIV>
<DIV style="position:absolute;top:196;left:475"><nobr><span class="ft3">because synopsis S is selected with probability</span></nobr></DIV>
<DIV style="position:absolute;top:193;left:742"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:203;left:741"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:196;left:755"><nobr><span class="ft3">among m syn-</span></nobr></DIV>
<DIV style="position:absolute;top:212;left:475"><nobr><span class="ft3">opses. As</span></nobr></DIV>
<DIV style="position:absolute;top:211;left:532"><nobr><span class="ft3"> is the total Count (or Sum) shared by all synopses, we</span></nobr></DIV>
<DIV style="position:absolute;top:227;left:475"><nobr><span class="ft3">get by using similar expression as (1) in Lemma 1 that</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:549"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:254;left:561"><nobr><span class="ft3">[G</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:575"><nobr><span class="ft11"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:254;left:578"><nobr><span class="ft3">] = 1 -(1-</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:654"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:647"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:657"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:261;left:663"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:254;left:667"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:672"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:254;left:679"><nobr><span class="ft3">-(1-</span></nobr></DIV>
<DIV style="position:absolute;top:251;left:731"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:720"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:262;left:730"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:261;left:735"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:261;left:737"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:254;left:749"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:755"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:273;left:600"><nobr><span class="ft3">+ (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:647"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:281;left:640"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:281;left:651"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:280;left:656"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:273;left:662"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:270;left:688"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:281;left:676"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:281;left:687"><nobr><span class="ft11"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:280;left:692"><nobr><span class="ft14"><i>i</i></span></nobr></DIV>
<DIV style="position:absolute;top:280;left:694"><nobr><span class="ft14"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:273;left:706"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:267;left:711"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:298;left:475"><nobr><span class="ft3">So,</span></nobr></DIV>
<DIV style="position:absolute;top:324;left:538"><nobr><span class="ft3">Pr</span></nobr></DIV>
<DIV style="position:absolute;top:324;left:550"><nobr><span class="ft3">[G</span></nobr></DIV>
<DIV style="position:absolute;top:329;left:563"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:324;left:570"><nobr><span class="ft3">] = 1 -(1-</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:650"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:333;left:638"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:332;left:649"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:329;left:660"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:339;left:659"><nobr><span class="ft14"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:324;left:668"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:673"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:324;left:680"><nobr><span class="ft3">-(1-</span></nobr></DIV>
<DIV style="position:absolute;top:321;left:736"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:333;left:720"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:332;left:731"><nobr><span class="ft11"><i> 2</i></span></nobr></DIV>
<DIV style="position:absolute;top:329;left:750"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:339;left:749"><nobr><span class="ft14"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:324;left:758"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:763"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:347;left:591"><nobr><span class="ft3">+ (1 -</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:643"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:356;left:632"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:355;left:642"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:353;left:653"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:362;left:652"><nobr><span class="ft14"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:347;left:663"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:344;left:692"><nobr><span class="ft11"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:356;left:677"><nobr><span class="ft11"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:355;left:688"><nobr><span class="ft11"><i> 2</i></span></nobr></DIV>
<DIV style="position:absolute;top:353;left:707"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:362;left:706"><nobr><span class="ft14"><i>m</i></span></nobr></DIV>
<DIV style="position:absolute;top:347;left:715"><nobr><span class="ft3">)</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:720"><nobr><span class="ft11"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:373;left:576"><nobr><span class="ft3"> 1-e</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:616"><nobr><span class="ft11"><i>-</i></span></nobr></DIV>
<DIV style="position:absolute;top:366;left:626"><nobr><span class="ft26"><i>1<br></i></span></nobr></DIV>
<DIV style="position:absolute;top:373;left:635"><nobr><span class="ft3">-e</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:653"><nobr><span class="ft11"><i>-</i></span></nobr></DIV>
<DIV style="position:absolute;top:366;left:666"><nobr><span class="ft14"><i>1</i></span></nobr></DIV>
<DIV style="position:absolute;top:374;left:663"><nobr><span class="ft14"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:374;left:669"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:373;left:677"><nobr><span class="ft3">+ e</span></nobr></DIV>
<DIV style="position:absolute;top:368;left:695"><nobr><span class="ft11"><i>-</i></span></nobr></DIV>
<DIV style="position:absolute;top:366;left:708"><nobr><span class="ft14"><i>3</i></span></nobr></DIV>
<DIV style="position:absolute;top:374;left:705"><nobr><span class="ft14"><i>2</i></span></nobr></DIV>
<DIV style="position:absolute;top:374;left:711"><nobr><span class="ft14"><i></i></span></nobr></DIV>
<DIV style="position:absolute;top:373;left:720"><nobr><span class="ft3">= 0.3454</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:475"><nobr><span class="ft3">Similarly, we find Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:601"><nobr><span class="ft11"><i>+1</i></span></nobr></DIV>
<DIV style="position:absolute;top:397;left:620"><nobr><span class="ft3">]</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:628"><nobr><span class="ft3">= 0.1315, and Pr[G</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:735"><nobr><span class="ft11"><i>+2</i></span></nobr></DIV>
<DIV style="position:absolute;top:397;left:755"><nobr><span class="ft3">]</span></nobr></DIV>
<DIV style="position:absolute;top:397;left:762"><nobr><span class="ft3">= 0.0412.</span></nobr></DIV>
<DIV style="position:absolute;top:1128;left:452"><nobr><span class="ft6">82</span></nobr></DIV>
</DIV>
</BODY>
</HTML>
