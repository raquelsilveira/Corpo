<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>vis99.dvi</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="generator" content="pdftohtml 0.35beta">
<META name="date" content="2000-04-24T14:00:45+00:00">
</HEAD>
<BODY bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft0{font-size:19px;font-family:Helvetica;color:#000000;}
	.ft1{font-size:13px;font-family:Times;color:#000000;}
	.ft2{font-size:16px;font-family:Helvetica;color:#000000;}
	.ft3{font-size:11px;font-family:Times;color:#000000;}
	.ft4{font-size:11px;font-family:Times;color:#000000;}
	.ft5{font-size:10px;font-family:Times;color:#000000;}
	.ft6{font-size:10px;font-family:Courier;color:#000000;}
	.ft7{font-size:10px;font-family:Times;color:#000000;}
	.ft8{font-size:6px;font-family:Times;color:#000000;}
	.ft9{font-size:11px;font-family:Times;color:#000000;}
	.ft10{font-size:13px;font-family:Times;color:#000000;}
	.ft11{font-size:7px;font-family:Times;color:#000000;}
	.ft12{font-size:5px;font-family:Times;color:#000000;}
	.ft13{font-size:16px;font-family:Courier;color:#000000;}
	.ft14{font-size:16px;font-family:Times;color:#000000;}
	.ft15{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft16{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
	.ft17{font-size:11px;line-height:18px;font-family:Times;color:#000000;}
	.ft18{font-size:10px;line-height:14px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="26001.png" alt="background image">
<DIV style="position:absolute;top:102;left:180"><nobr><span class="ft0"><b>Accelerating 3D Convolution using Graphics Hardware</b></span></nobr></DIV>
<DIV style="position:absolute;top:148;left:341"><nobr><span class="ft1">Matthias Hopf</span></nobr></DIV>
<DIV style="position:absolute;top:148;left:503"><nobr><span class="ft1">Thomas Ertl</span></nobr></DIV>
<DIV style="position:absolute;top:191;left:244"><nobr><span class="ft1">Visualization and Interactive Systems Group, IfI, University of Stuttgart</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:81"><nobr><span class="ft2"><b>Abstract</b></span></nobr></DIV>
<DIV style="position:absolute;top:290;left:81"><nobr><span class="ft15">Many volume filtering operations used for image enhancement,<br>data processing or feature detection can be written in terms of three-<br>dimensional convolutions. It is not possible to yield interactive<br>frame rates on todays hardware when applying such convolutions<br>on volume data using software filter routines. As modern graph-<br>ics workstations have the ability to render two-dimensional convo-<br>luted images to the frame buffer, this feature can be used to accel-<br>erate the process significantly. This way generic 3D convolution<br>can be added as a powerful tool in interactive volume visualization<br>toolkits.</span></nobr></DIV>
<DIV style="position:absolute;top:469;left:81"><nobr><span class="ft4"><b>Keywords:</b></span></nobr></DIV>
<DIV style="position:absolute;top:469;left:152"><nobr><span class="ft3">Convolution, Hardware Acceleration, Volume Visual-</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:81"><nobr><span class="ft3">ization</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:81"><nobr><span class="ft2"><b>1</b></span></nobr></DIV>
<DIV style="position:absolute;top:554;left:109"><nobr><span class="ft2"><b>Introduction</b></span></nobr></DIV>
<DIV style="position:absolute;top:597;left:81"><nobr><span class="ft16">Direct volume rendering is a very important technique for visualiz-<br>ing three dimensional data. Several fundamental different methods<br>have been introduced [2, 4, 5, 6, 8, 12]. Hardware-based volume<br>texturing [9, 14] is one of the most prominent variants for interac-<br>tive visualization due to the high frame rates that can be achieved<br>with this technique.</span></nobr></DIV>
<DIV style="position:absolute;top:712;left:81"><nobr><span class="ft16">The basic principle of texture based volume rendering is depicted<br>in Figure 1. According to the sampling theorem a 3D view of the<br>volume is generated by drawing an adequate number of equidistant,<br>semi-transparent polygons parallel to the image plane with respect<br>to the current viewing direction ("volume slicing").</span></nobr></DIV>
<DIV style="position:absolute;top:809;left:81"><nobr><span class="ft16">Filtering on the other hand is a major part of the visualization<br>pipeline. It is broadly used for improving images, reducing noise,<br>and enhancing detail structure. Volume rendering can benefit from<br>filter operations, as low pass filters reduce the noise e.g. of sam-<br>pled medical volume images and high pass filters can be used for<br>edge extraction, visualizing prominent data features. Multiscale ap-<br>proaches as [13] regularly use disjunct filtering and downsampling<br>steps and can benefit from any speedups of the filtering process.</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:93"><nobr><span class="ft5">{</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:99"><nobr><span class="ft6">hopf,ertl</span></nobr></DIV>
<DIV style="position:absolute;top:976;left:164"><nobr><span class="ft5">}</span></nobr></DIV>
<DIV style="position:absolute;top:980;left:170"><nobr><span class="ft6">@informatik.uni-stuttgart.de</span></nobr></DIV>
<DIV style="position:absolute;top:999;left:93"><nobr><span class="ft18">Institut f®ur Informatik<br>Breitwiesenstr. 20 ≠ 22<br>70565 Stuttgart<br>Germany</span></nobr></DIV>
<DIV style="position:absolute;top:236;left:495"><nobr><span class="ft8">            </span></nobr></DIV>
<DIV style="position:absolute;top:408;left:544"><nobr><span class="ft3">Figure 1: Texture based volume rendering</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:477"><nobr><span class="ft16">Filters can be classified as linear or non-linear. Discrete linear filters<br>can be written as convolutions with filter kernels that completely<br>specify the filtering operation. Non-linear filters, as for instance<br>morphological operators, were recently used for volume analysis<br>and visualization [7]. Segmentation and classification depend heav-<br>ily on filtering operations as well. Bro-Nielson [1] already thought<br>about using convolution hardware for accelerating the registration<br>process.</span></nobr></DIV>
<DIV style="position:absolute;top:604;left:477"><nobr><span class="ft16">For texture based volume rendering the data set has to be loaded<br>into special texture memory, which can be addressed by the graph-<br>ics pipe very fast. The loading process itself is relatively slow, tak-<br>ing several seconds for big data sets even on the fastest available<br>graphics workstations. As the data set has to be reloaded after a<br>filter operation has been performed in software, interactive filtering<br>will benefit a lot from convolution algorithms that directly work<br>on the texture hardware. Additionally, we will show in the follow-<br>ing that computing the convolution with graphics hardware is much<br>faster than software solutions.</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:477"><nobr><span class="ft2"><b>2</b></span></nobr></DIV>
<DIV style="position:absolute;top:815;left:505"><nobr><span class="ft2"><b>3D Convolution</b></span></nobr></DIV>
<DIV style="position:absolute;top:857;left:477"><nobr><span class="ft16">The general three-dimensional discrete convolution can be written<br>as</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:500"><nobr><span class="ft9">~</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:497"><nobr><span class="ft9">f (x, y, z) =</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:568"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:572"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:578"><nobr><span class="ft11">,i</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:586"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:929;left:591"><nobr><span class="ft11">,i</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:599"><nobr><span class="ft12">3</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:607"><nobr><span class="ft9">k(i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:625"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:631"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:642"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:648"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:659"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:665"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:674"><nobr><span class="ft9">∑ f(x + i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:723"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:730"><nobr><span class="ft9">, y + i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:765"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:771"><nobr><span class="ft9">, z + i</span></nobr></DIV>
<DIV style="position:absolute;top:913;left:806"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:909;left:812"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:957;left:477"><nobr><span class="ft17">with f being the input data function and k being the filter kernel,<br>resulting in the convoluted data ~</span></nobr></DIV>
<DIV style="position:absolute;top:975;left:649"><nobr><span class="ft9">f .</span></nobr></DIV>
<DIV style="position:absolute;top:999;left:477"><nobr><span class="ft16">In the following examination we will assume without loss of gen-<br>erality that k(i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:555"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:562"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:573"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:579"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:590"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:596"><nobr><span class="ft9">) is given for 0</span></nobr></DIV>
<DIV style="position:absolute;top:1013;left:679"><nobr><span class="ft9"> i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:698"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:704"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:715"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:721"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1021;left:732"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1017;left:742"><nobr><span class="ft9">&lt; n and vanishes</span></nobr></DIV>
<DIV style="position:absolute;top:1035;left:477"><nobr><span class="ft16">outside this interval. Also, we will assume that the input data func-<br>tion vanishes for (x, y, z) outside the interval [0, m)</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:759"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1053;left:765"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:477"><nobr><span class="ft3">In the special case of k(i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:617"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:624"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:634"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:641"><nobr><span class="ft9">, i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:651"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:658"><nobr><span class="ft9">) = Ø</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:687"><nobr><span class="ft9">k</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:694"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:700"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:710"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:716"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:1073;left:726"><nobr><span class="ft9">∑ Øk</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:741"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:747"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:757"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:763"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:1073;left:773"><nobr><span class="ft9">∑ Øk</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:788"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:794"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:1081;left:804"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:1077;left:811"><nobr><span class="ft9">) the</span></nobr></DIV>
<DIV style="position:absolute;top:1058;left:84"><nobr><span class="ft7">0-7803-5897-X/99/$10.00 Copyright 1999 IEEE </span></nobr></DIV>
<DIV style="position:absolute;top:1149;left:446"><nobr><span class="ft14"><b>471</b></span></nobr></DIV>
</DIV>
<!-- Page 2 -->
<a name="2"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft19{font-size:5px;font-family:Helvetica;color:#000000;}
	.ft20{font-size:8px;font-family:Times;color:#000000;}
	.ft21{font-size:5px;font-family:Times;color:#ffffff;}
	.ft22{font-size:9px;font-family:Times;color:#000000;}
	.ft23{font-size:11px;font-family:Times;color:#000000;}
	.ft24{font-size:11px;font-family:Courier;color:#000000;}
	.ft25{font-size:11px;line-height:14px;font-family:Times;color:#000000;}
	.ft26{font-size:11px;line-height:18px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="26002.png" alt="background image">
<DIV style="position:absolute;top:195;left:107"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:101"><nobr><span class="ft19">0.1</span></nobr></DIV>
<DIV style="position:absolute;top:152;left:101"><nobr><span class="ft19">0.2</span></nobr></DIV>
<DIV style="position:absolute;top:131;left:101"><nobr><span class="ft19">0.3</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:101"><nobr><span class="ft19">0.4</span></nobr></DIV>
<DIV style="position:absolute;top:88;left:101"><nobr><span class="ft19">0.5</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:112"><nobr><span class="ft19">-3</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:134"><nobr><span class="ft19">-2</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:155"><nobr><span class="ft19">-1</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:178"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:199"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:220"><nobr><span class="ft19">2</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:242"><nobr><span class="ft19">3</span></nobr></DIV>
<DIV style="position:absolute;top:164;left:288"><nobr><span class="ft19">0.1</span></nobr></DIV>
<DIV style="position:absolute;top:128;left:288"><nobr><span class="ft19">0.2</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:288"><nobr><span class="ft19">0.3</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:301"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:319"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:337"><nobr><span class="ft19">2</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:356"><nobr><span class="ft19">3</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:374"><nobr><span class="ft19">4</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:392"><nobr><span class="ft19">5</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:411"><nobr><span class="ft19">6</span></nobr></DIV>
<DIV style="position:absolute;top:202;left:429"><nobr><span class="ft19">7</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:99"><nobr><span class="ft19">-0.5</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:99"><nobr><span class="ft19">-0.4</span></nobr></DIV>
<DIV style="position:absolute;top:299;left:99"><nobr><span class="ft19">-0.3</span></nobr></DIV>
<DIV style="position:absolute;top:286;left:99"><nobr><span class="ft19">-0.2</span></nobr></DIV>
<DIV style="position:absolute;top:273;left:99"><nobr><span class="ft19">-0.1</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:107"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:101"><nobr><span class="ft19">0.1</span></nobr></DIV>
<DIV style="position:absolute;top:233;left:101"><nobr><span class="ft19">0.2</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:101"><nobr><span class="ft19">0.3</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:112"><nobr><span class="ft19">-3</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:134"><nobr><span class="ft19">-2</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:155"><nobr><span class="ft19">-1</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:178"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:199"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:220"><nobr><span class="ft19">2</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:242"><nobr><span class="ft19">3</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:286"><nobr><span class="ft19">-0.5</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:286"><nobr><span class="ft19">-0.4</span></nobr></DIV>
<DIV style="position:absolute;top:299;left:286"><nobr><span class="ft19">-0.3</span></nobr></DIV>
<DIV style="position:absolute;top:286;left:286"><nobr><span class="ft19">-0.2</span></nobr></DIV>
<DIV style="position:absolute;top:273;left:286"><nobr><span class="ft19">-0.1</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:294"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:288"><nobr><span class="ft19">0.1</span></nobr></DIV>
<DIV style="position:absolute;top:233;left:288"><nobr><span class="ft19">0.2</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:288"><nobr><span class="ft19">0.3</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:301"><nobr><span class="ft19">0</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:319"><nobr><span class="ft19">1</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:337"><nobr><span class="ft19">2</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:356"><nobr><span class="ft19">3</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:374"><nobr><span class="ft19">4</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:392"><nobr><span class="ft19">5</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:411"><nobr><span class="ft19">6</span></nobr></DIV>
<DIV style="position:absolute;top:333;left:429"><nobr><span class="ft19">7</span></nobr></DIV>
<DIV style="position:absolute;top:356;left:100"><nobr><span class="ft3">Figure 2: The Gauﬂ filter function and its second derivative</span></nobr></DIV>
<DIV style="position:absolute;top:519;left:81"><nobr><span class="ft25">Figure 3: Example image; original, filtered with Gauﬂ, and filtered<br>with second derivative</span></nobr></DIV>
<DIV style="position:absolute;top:581;left:81"><nobr><span class="ft17">kernel is called separable. In this case the number of operations<br>necessary for the convolution can be reduced down to O(m</span></nobr></DIV>
<DIV style="position:absolute;top:596;left:418"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:599;left:424"><nobr><span class="ft9">n),</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:81"><nobr><span class="ft3">from O(m</span></nobr></DIV>
<DIV style="position:absolute;top:614;left:139"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:145"><nobr><span class="ft9">n</span></nobr></DIV>
<DIV style="position:absolute;top:614;left:154"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:617;left:160"><nobr><span class="ft9">) in the non-separable case:</span></nobr></DIV>
<DIV style="position:absolute;top:650;left:137"><nobr><span class="ft9">~</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:134"><nobr><span class="ft9">f</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:141"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:147"><nobr><span class="ft9">(x, y, z)</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:207"><nobr><span class="ft9">=</span></nobr></DIV>
<DIV style="position:absolute;top:674;left:239"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:677;left:243"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:650;left:257"><nobr><span class="ft9">Ø</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:257"><nobr><span class="ft9">k</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:264"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:270"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:280"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:287"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:650;left:295"><nobr><span class="ft9">∑ f(x + i</span></nobr></DIV>
<DIV style="position:absolute;top:658;left:345"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:351"><nobr><span class="ft9">, y, z)</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:425"><nobr><span class="ft3">(1)</span></nobr></DIV>
<DIV style="position:absolute;top:692;left:137"><nobr><span class="ft9">~</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:134"><nobr><span class="ft9">f</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:141"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:147"><nobr><span class="ft9">(x, y, z)</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:207"><nobr><span class="ft9">=</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:239"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:719;left:243"><nobr><span class="ft12">2</span></nobr></DIV>
<DIV style="position:absolute;top:692;left:257"><nobr><span class="ft9">Ø</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:257"><nobr><span class="ft9">k</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:264"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:270"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:280"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:287"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:692;left:295"><nobr><span class="ft9">∑ ~</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:302"><nobr><span class="ft9">f</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:309"><nobr><span class="ft11">1</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:315"><nobr><span class="ft9">(x, y + i</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:363"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:695;left:369"><nobr><span class="ft9">, z)</span></nobr></DIV>
<DIV style="position:absolute;top:696;left:425"><nobr><span class="ft3">(2)</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:142"><nobr><span class="ft9">~</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:139"><nobr><span class="ft9">f (x, y, z)</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:207"><nobr><span class="ft9">=</span></nobr></DIV>
<DIV style="position:absolute;top:758;left:239"><nobr><span class="ft11">i</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:243"><nobr><span class="ft12">3</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:257"><nobr><span class="ft9">Ø</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:257"><nobr><span class="ft9">k</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:264"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:270"><nobr><span class="ft9">(i</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:280"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:287"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:295"><nobr><span class="ft9">∑ ~</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:302"><nobr><span class="ft9">f</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:309"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:315"><nobr><span class="ft9">(x, y, z + i</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:376"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:737;left:383"><nobr><span class="ft9">)</span></nobr></DIV>
<DIV style="position:absolute;top:738;left:425"><nobr><span class="ft3">(3)</span></nobr></DIV>
<DIV style="position:absolute;top:792;left:81"><nobr><span class="ft16">Of course special care has to be taken near the boundaries of the<br>input data function, as convolution routines are generally written<br>on a very low language level for speed purposes.</span></nobr></DIV>
<DIV style="position:absolute;top:854;left:81"><nobr><span class="ft17">Figure 2 shows two well known convolution filters, the Gauﬂ fil-<br>ter and its second derivative, both in their continuous and discrete<br>forms. They can be used for noise reduction and edge detection,<br>respectively. An example image that was filtered with these kernels<br>can be seen in Figure 3.</span></nobr></DIV>
<DIV style="position:absolute;top:979;left:81"><nobr><span class="ft2"><b>3</b></span></nobr></DIV>
<DIV style="position:absolute;top:979;left:109"><nobr><span class="ft2"><b>Hardware Acceleration</b></span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:81"><nobr><span class="ft16">In order to accelerate the convolution process, special purpose hard-<br>ware can be used. On systems that have built-in Digital Signal<br>Processors (DSPs), for example for multimedia acceleration, a spe-<br>cialized convolution subroutine could be downloaded to the signal</span></nobr></DIV>
<DIV style="position:absolute;top:171;left:639"><nobr><span class="ft20">2D Convolution</span></nobr></DIV>
<DIV style="position:absolute;top:236;left:500"><nobr><span class="ft3">Figure 4: The first pass of the hardware filtering algorithm</span></nobr></DIV>
<DIV style="position:absolute;top:362;left:638"><nobr><span class="ft21">0</span></nobr></DIV>
<DIV style="position:absolute;top:362;left:638"><nobr><span class="ft12">1</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:480"><nobr><span class="ft21">000000000000000000000000000000</span></nobr></DIV>
<DIV style="position:absolute;top:298;left:480"><nobr><span class="ft21">000000000000000000000000000000</span></nobr></DIV>
<DIV style="position:absolute;top:291;left:480"><nobr><span class="ft21">000000000000000000000000000000</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:480"><nobr><span class="ft21">000000000000000000000000000000</span></nobr></DIV>
<DIV style="position:absolute;top:305;left:480"><nobr><span class="ft12">111111111111111111111111111111</span></nobr></DIV>
<DIV style="position:absolute;top:298;left:480"><nobr><span class="ft12">111111111111111111111111111111</span></nobr></DIV>
<DIV style="position:absolute;top:291;left:480"><nobr><span class="ft12">111111111111111111111111111111</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:480"><nobr><span class="ft12">111111111111111111111111111111</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:721"><nobr><span class="ft22">Used texture coordinates</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:477"><nobr><span class="ft22">0</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:721"><nobr><span class="ft21">00</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:721"><nobr><span class="ft21">00</span></nobr></DIV>
<DIV style="position:absolute;top:318;left:721"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:721"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:279;left:749"><nobr><span class="ft22">the data value</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:674"><nobr><span class="ft22">15/16</span></nobr></DIV>
<DIV style="position:absolute;top:314;left:749"><nobr><span class="ft22">Texel</span></nobr></DIV>
<DIV style="position:absolute;top:290;left:749"><nobr><span class="ft22">inside a texel</span></nobr></DIV>
<DIV style="position:absolute;top:267;left:749"><nobr><span class="ft22">Exact position of</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:484"><nobr><span class="ft22">1/16</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:638"><nobr><span class="ft22">3/4</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:666"><nobr><span class="ft22">7/8</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:698"><nobr><span class="ft22">1</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:721"><nobr><span class="ft22">Texture coordinates</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:611"><nobr><span class="ft22">5/8</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:501"><nobr><span class="ft22">1/8</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:528"><nobr><span class="ft22">1/4</span></nobr></DIV>
<DIV style="position:absolute;top:372;left:556"><nobr><span class="ft22">3/8</span></nobr></DIV>
<DIV style="position:absolute;top:372;left:583"><nobr><span class="ft22">1/2</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:594"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:594"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:594"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:594"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:484"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:484"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:484"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:484"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:511"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:511"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:511"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:511"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:539"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:539"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:539"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:539"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:566"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:566"><nobr><span class="ft12">00</span></nobr></DIV>
<DIV style="position:absolute;top:294;left:566"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:287;left:566"><nobr><span class="ft12">11</span></nobr></DIV>
<DIV style="position:absolute;top:401;left:512"><nobr><span class="ft3">Figure 5: Texture coordinates used for exact texel hits</span></nobr></DIV>
<DIV style="position:absolute;top:449;left:477"><nobr><span class="ft16">processor. On the other hand, most times these DSPs are not well<br>documented or the run-time system can not be modified by the user.<br>In general they are not faster than the main processor as well. Ad-<br>ditionally, there exists a wide range of different DSP systems, all of<br>which are incompatible to each other.</span></nobr></DIV>
<DIV style="position:absolute;top:546;left:477"><nobr><span class="ft26">The approach we have implemented in our system is to combine<br>a 2D and a 1D convolution kernel in order to calculate three-<br>dimensional separable convolutions. Several vendors of the graph-<br>ics API <i>OpenGL </i>-- as for example Silicon Graphics Inc. [10] --<br>have included extensions for one- and two-dimensional filtering.<br>In contrast to most implementations that emulate these extensions<br>only in software, the SGI graphics pipes <i>MXE </i>and <i>BasicReality<br></i>calculate the convolutions on-board, boosting performance by an<br>order of magnitude already for reasonably sized filters. The <i>CRM<br></i>graphics system of the O</span></nobr></DIV>
<DIV style="position:absolute;top:713;left:614"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:624"><nobr><span class="ft3">is capable of rendering convolutions in</span></nobr></DIV>
<DIV style="position:absolute;top:727;left:477"><nobr><span class="ft17">hardware as well, but it does not support volume textures, which<br>are crucial for the algorithm as well.</span></nobr></DIV>
<DIV style="position:absolute;top:770;left:477"><nobr><span class="ft16">Recall that the volume data is already stored in texture memory for<br>visualization using texture hardware. Now (1) and (2) are combined<br>to one 2D convolution that is to be applied to every plane of the vol-<br>ume data perpendicular to the z-axis. Therefore, plane by plane is<br>drawn by rendering textured triangle strips (two triangles per strip)<br>into the frame buffer as it is sketched in Figure 4. The texture co-<br>ordinates assigned to the vertices of the triangle strips are specified<br>in such way that no interpolation of the texture is necessary (see<br>Figure 5). In order to increase the potential speedup and to avoid<br>rounding problems, nearest neighbor interpolation is activated dur-<br>ing the rendering process. Each plane is then read back with the<br>OpenGL routine</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:571"><nobr><span class="ft24">glCopyTexSubImage3DEXT</span></nobr></DIV>
<DIV style="position:absolute;top:968;left:749"><nobr><span class="ft3">, which replaces</span></nobr></DIV>
<DIV style="position:absolute;top:987;left:477"><nobr><span class="ft16">one plane of the active volume texture orthogonal to the z-axis by<br>data that is read directly from the frame buffer. While transfering<br>the data to the texture memory, the separable 2D convolution filter<br>is activated using</span></nobr></DIV>
<DIV style="position:absolute;top:1042;left:575"><nobr><span class="ft24">glSeparableFilter2DEXT</span></nobr></DIV>
<DIV style="position:absolute;top:1041;left:753"><nobr><span class="ft3">. After this first</span></nobr></DIV>
<DIV style="position:absolute;top:1059;left:477"><nobr><span class="ft16">pass, the volume texture contains data filtered along the x- and y-<br>axes.</span></nobr></DIV>
<DIV style="position:absolute;top:1149;left:446"><nobr><span class="ft14"><b>472</b></span></nobr></DIV>
</DIV>
<!-- Page 3 -->
<a name="3"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft27{font-size:7px;font-family:Times;color:#000000;}
	.ft28{font-size:6px;font-family:Times;color:#000000;}
	.ft29{font-size:5px;font-family:Times;color:#000000;}
	.ft30{font-size:3px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="26003.png" alt="background image">
<DIV style="position:absolute;top:281;left:271"><nobr><span class="ft20">1D Convolution</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:190"><nobr><span class="ft3">Figure 6: The second pass</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:378"><nobr><span class="ft27">Framebuffer</span></nobr></DIV>
<DIV style="position:absolute;top:422;left:306"><nobr><span class="ft28">Operations</span></nobr></DIV>
<DIV style="position:absolute;top:462;left:309"><nobr><span class="ft27">Memory</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:310"><nobr><span class="ft27">Texture</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:81"><nobr><span class="ft27">Pixel Data</span></nobr></DIV>
<DIV style="position:absolute;top:551;left:84"><nobr><span class="ft27">Textures</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:364"><nobr><span class="ft28">Pixel Transfer Modes</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:83"><nobr><span class="ft27">Primitives</span></nobr></DIV>
<DIV style="position:absolute;top:410;left:301"><nobr><span class="ft28">Per-Fragment</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:225"><nobr><span class="ft27">Rasterization</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:160"><nobr><span class="ft27">Engine</span></nobr></DIV>
<DIV style="position:absolute;top:410;left:154"><nobr><span class="ft27">Geometry</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:83"><nobr><span class="ft27">Geometric</span></nobr></DIV>
<DIV style="position:absolute;top:451;left:385"><nobr><span class="ft29">Scale, Bias</span></nobr></DIV>
<DIV style="position:absolute;top:545;left:386"><nobr><span class="ft29">Clamping</span></nobr></DIV>
<DIV style="position:absolute;top:552;left:146"><nobr><span class="ft27">Storage Mode</span></nobr></DIV>
<DIV style="position:absolute;top:486;left:382"><nobr><span class="ft29">Convolution</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:378"><nobr><span class="ft30">Post-Convolution</span></nobr></DIV>
<DIV style="position:absolute;top:514;left:388"><nobr><span class="ft30">Scale, Bias</span></nobr></DIV>
<DIV style="position:absolute;top:541;left:163"><nobr><span class="ft27">Pixel</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:151"><nobr><span class="ft3">Figure 7: The OpenGL graphics pipeline</span></nobr></DIV>
<DIV style="position:absolute;top:652;left:81"><nobr><span class="ft16">Applying the convolution to the third axis is more complicated and<br>depicted in Figure 6. In this second pass planes are rendered per-<br>pendicular to one of the other axes. Assume that the y-axis has been<br>chosen. As</span></nobr></DIV>
<DIV style="position:absolute;top:707;left:148"><nobr><span class="ft24">glCopyTexSubImage3DEXT</span></nobr></DIV>
<DIV style="position:absolute;top:706;left:330"><nobr><span class="ft3">can not write planes</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:81"><nobr><span class="ft17">orthogonal to any other axis than the z-axis to the texture memory,<br>they have to be transfered to a second volume texture. OpenGL's<br>texture objects are used by calling</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:263"><nobr><span class="ft24">glBindTexture</span></nobr></DIV>
<DIV style="position:absolute;top:760;left:370"><nobr><span class="ft3">for switching</span></nobr></DIV>
<DIV style="position:absolute;top:778;left:81"><nobr><span class="ft17">between them, which implies only a very small overhead. While<br>copying the data from the frame buffer to the texture memory, a<br>one-dimensional convolution filter is activated. As we are dealing<br>with two-dimensional image data, we specify a 2D convolution fil-<br>ter with</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:129"><nobr><span class="ft24">glConvolutionFilter2DEXT</span></nobr></DIV>
<DIV style="position:absolute;top:851;left:324"><nobr><span class="ft3">, using a filter kernel</span></nobr></DIV>
<DIV style="position:absolute;top:869;left:81"><nobr><span class="ft3">that is exactly one pixel wide.</span></nobr></DIV>
<DIV style="position:absolute;top:896;left:81"><nobr><span class="ft17">After this second pass the convoluted volume data has been mir-<br>rored at the plane y</span></nobr></DIV>
<DIV style="position:absolute;top:911;left:191"><nobr><span class="ft9">- z = 0. For texture based volume renderers</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:81"><nobr><span class="ft16">this does not impose any restrictions, as they only have to swap co-<br>ordinates during texture coordinate calculations. When data order<br>is crucial for the application, the algorithm of pass two can be used<br>for both passes, thus restoring the data order in the second pass.<br>However, the textured planes have to be drawn two times perpen-<br>dicular to the y-axis. Cache misses are much more likely in this<br>case in respect to planes rendered orthogonal to the z-axis. This<br>can increase the convolution times on big volumes by up to 50%<br>even on fast graphics hardware.</span></nobr></DIV>
<DIV style="position:absolute;top:93;left:477"><nobr><span class="ft17">Figure 7 depicts the relevant part of the OpenGL pipeline. It re-<br>veals, that pixel fragments read from the frame buffer are clamped<br>to [0, 1) before they can be written back to the frame buffer or into<br>the texture memory. Filter kernels with negative coefficients can<br>compute negative intermediary values during the two-dimensional<br>convolution pass, which will not contribute to the final 1D convo-<br>lution. Additionally, no negative results can be stored in the output<br>volume. These values are especially needed when the filter kernel<br>is not symmetrical.</span></nobr></DIV>
<DIV style="position:absolute;top:262;left:477"><nobr><span class="ft16">The strategy for avoiding these effects depends on the particular<br>application. For edge detection the absolute maxima of the fil-<br>tered volume data are of interest.</span></nobr></DIV>
<DIV style="position:absolute;top:298;left:679"><nobr><span class="ft3">In this case, calculating the</span></nobr></DIV>
<DIV style="position:absolute;top:316;left:477"><nobr><span class="ft16">absolute value can be performed in hardware as well, further re-<br>ducing necessary computations on the CPU. In most other cases<br>post-convolution scaling and bias can be used to map the expected<br>results to the interval [0, 1) just before the clamping takes place.<br>OpenGL provides the</span></nobr></DIV>
<DIV style="position:absolute;top:389;left:603"><nobr><span class="ft24">GL POST CONVOLUTION c SCALE EXT</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:477"><nobr><span class="ft3">and</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:503"><nobr><span class="ft24">GL POST CONVOLUTION c BIAS EXT</span></nobr></DIV>
<DIV style="position:absolute;top:407;left:735"><nobr><span class="ft3">parameters, which</span></nobr></DIV>
<DIV style="position:absolute;top:425;left:477"><nobr><span class="ft17">are applied to pixel color values after convolution and before clamp-<br>ing as depicted in Figure 7.</span></nobr></DIV>
<DIV style="position:absolute;top:492;left:477"><nobr><span class="ft2"><b>4</b></span></nobr></DIV>
<DIV style="position:absolute;top:492;left:505"><nobr><span class="ft2"><b>Results</b></span></nobr></DIV>
<DIV style="position:absolute;top:534;left:477"><nobr><span class="ft16">The used data sets are presented on the color plate. Figures 8 to 12<br>show slices of a head data set of size 128</span></nobr></DIV>
<DIV style="position:absolute;top:549;left:709"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:552;left:716"><nobr><span class="ft3">. Figure 8 reveals the</span></nobr></DIV>
<DIV style="position:absolute;top:570;left:477"><nobr><span class="ft17">unfiltered data set, whereas Figure 9 and 10 present slices of the<br>software and hardware low pass filtered volume data, respectively.<br>Here, a Gauﬂ filter kernel of size 5</span></nobr></DIV>
<DIV style="position:absolute;top:603;left:676"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:687"><nobr><span class="ft3">has been used. Almost no</span></nobr></DIV>
<DIV style="position:absolute;top:624;left:477"><nobr><span class="ft17">differences can be detected. Figure 11 and 12 depict the results<br>for high pass filtering using the second derivative of the Gauﬂ fil-<br>ter, again computed in software and in hardware. The hardware<br>convoluted volume displays noticeable artifacts that occur due to<br>the already mentioned clamping step in the OpenGL pipeline. By<br>using post-convolution scaling and bias the artifacts disappear com-<br>pletely.</span></nobr></DIV>
<DIV style="position:absolute;top:757;left:477"><nobr><span class="ft16">The Figures 13 to 18 picture another data set that has been used<br>for testing the implementation. They have been visualized with the<br>hardware based volume rendering toolkit TiVOR [11], again with<br>the first picture being rendered with the original data set. While<br>the noise reduction effect of the Gauﬂ filter is rather bothering in<br>Figure 14 by smearing volume details, it has remarkable positive<br>effects on ISO surface generation (compare Figures 17 and 18).<br>Please remark that the ISO surfaces are rendered in real-time us-<br>ing a hardware accelerated volume rendering approach described<br>in [14].</span></nobr></DIV>
<DIV style="position:absolute;top:944;left:477"><nobr><span class="ft16">Noise interferes with high pass filters, which can be seen in Fig-<br>ure 15. Using a high pass filter on the already low pass filtered data<br>set reveals by far more and better separable details (see Figure 16)<br>compared to the directly filtered volume.</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:477"><nobr><span class="ft16">We have tested the speed our implementation against a well tuned<br>software convolution filter. Unsurprisingly, the software convo-<br>lution is almost completely memory bound. Even extremely fast<br>workstations as the Octane are limited by the main memory band-</span></nobr></DIV>
<DIV style="position:absolute;top:1149;left:446"><nobr><span class="ft14"><b>473</b></span></nobr></DIV>
</DIV>
<!-- Page 4 -->
<a name="4"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
	.ft31{font-size:10px;font-family:Times;color:#000000;}
	.ft32{font-size:10px;line-height:15px;font-family:Times;color:#000000;}
	.ft33{font-size:10px;line-height:15px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1188" src="26004.png" alt="background image">
<DIV style="position:absolute;top:95;left:90"><nobr><span class="ft3">Filter size</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:176"><nobr><span class="ft9">2</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:183"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:240"><nobr><span class="ft9">3</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:247"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:304"><nobr><span class="ft9">5</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:311"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:365"><nobr><span class="ft9">7</span></nobr></DIV>
<DIV style="position:absolute;top:92;left:372"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:117;left:90"><nobr><span class="ft24">head</span></nobr></DIV>
<DIV style="position:absolute;top:111;left:122"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:116;left:157"><nobr><span class="ft3">0.33/0.72</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:221"><nobr><span class="ft3">0.33/1.02</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:285"><nobr><span class="ft3">0.33/1.56</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:349"><nobr><span class="ft3">0.48/2.0</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:90"><nobr><span class="ft24">angio</span></nobr></DIV>
<DIV style="position:absolute;top:127;left:131"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:133;left:164"><nobr><span class="ft3">2.5/6.0</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:228"><nobr><span class="ft3">2.5/8.7</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:289"><nobr><span class="ft3">2.5/14.7</span></nobr></DIV>
<DIV style="position:absolute;top:133;left:349"><nobr><span class="ft3">3.7/21.3</span></nobr></DIV>
<DIV style="position:absolute;top:159;left:90"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:164;left:114"><nobr><span class="ft3">Data set created by computer tomography, 128</span></nobr></DIV>
<DIV style="position:absolute;top:162;left:365"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:179;left:90"><nobr><span class="ft11"></span></nobr></DIV>
<DIV style="position:absolute;top:184;left:114"><nobr><span class="ft3">Data set created by MR angiography, 256</span></nobr></DIV>
<DIV style="position:absolute;top:181;left:338"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:114"><nobr><span class="ft25">All times were measured on a Silicon Graphics Onyx2<br>equipped with a BasicReality graphics pipe.</span></nobr></DIV>
<DIV style="position:absolute;top:223;left:381"><nobr><span class="ft3">The</span></nobr></DIV>
<DIV style="position:absolute;top:238;left:114"><nobr><span class="ft25">system has two R10000/195 MHz processors and<br>640 MB main memory.</span></nobr></DIV>
<DIV style="position:absolute;top:283;left:87"><nobr><span class="ft3">Table 1: Convolution times in seconds using hardware / software</span></nobr></DIV>
<DIV style="position:absolute;top:331;left:81"><nobr><span class="ft17">width, as today's caches are far too small for the values needed<br>for convolution along the z-axis. High end machines as the Onyx2<br>perform huge 3D convolutions three times faster than the Octane,<br>even when equipped with slower CPUs. Standard PCs cannot cope<br>with the memory bandwidth of the Onyx2 system, and multipro-<br>cessor options will not accelerate the process because it is not CPU<br>bound.</span></nobr></DIV>
<DIV style="position:absolute;top:464;left:81"><nobr><span class="ft17">Table 1 shows convolution times for different data sets and filter<br>sizes, using software and hardware convolution. All times have<br>been measured on an Onyx2 equipped with a BasicReality graphics<br>pipe. The maximum filter size supported by the graphics system<br>is 7</span></nobr></DIV>
<DIV style="position:absolute;top:533;left:102"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:536;left:109"><nobr><span class="ft3">. Therefor, the maximum 3D convolution that can be per-</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:81"><nobr><span class="ft3">formed in hardware on this system is 7</span></nobr></DIV>
<DIV style="position:absolute;top:551;left:300"><nobr><span class="ft11">3</span></nobr></DIV>
<DIV style="position:absolute;top:554;left:306"><nobr><span class="ft3">. Noteworthy is the fact</span></nobr></DIV>
<DIV style="position:absolute;top:572;left:81"><nobr><span class="ft16">that the BasicReality graphics system is optimized for filter kernels<br>of size 5</span></nobr></DIV>
<DIV style="position:absolute;top:587;left:126"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:132"><nobr><span class="ft3">. Convolutions with smaller kernels need exactly the same</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:81"><nobr><span class="ft3">computation time. Filters of size 6</span></nobr></DIV>
<DIV style="position:absolute;top:605;left:263"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:272"><nobr><span class="ft3">and 7</span></nobr></DIV>
<DIV style="position:absolute;top:605;left:301"><nobr><span class="ft11">2</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:310"><nobr><span class="ft3">share their timing results</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:81"><nobr><span class="ft16">as well. The x and y coordinates of the volume are swapped during<br>the hardware based convolution process, which is a side effect of<br>the presented 3D convolution algorithm.</span></nobr></DIV>
<DIV style="position:absolute;top:711;left:81"><nobr><span class="ft2"><b>5</b></span></nobr></DIV>
<DIV style="position:absolute;top:711;left:109"><nobr><span class="ft2"><b>Conclusion</b></span></nobr></DIV>
<DIV style="position:absolute;top:754;left:81"><nobr><span class="ft17">As several of today's graphics workstation vendors have added two-<br>dimensional convolution to their OpenGL pipeline, using this ca-<br>pability for accelerating 3D convolution is an almost straightfor-<br>ward approach. We have determined that by using the implemented<br>algorithm three-dimensional convolution can be performed even<br>on big data sets with nearly interactive rates. First promising ap-<br>proaches of accelerating wavelet decomposition and reconstruction<br>have been investigated as well [3].</span></nobr></DIV>
<DIV style="position:absolute;top:905;left:81"><nobr><span class="ft16">As all intermediary data is transfered to the frame buffer, clamping<br>can swallow negative values that result from the two-dimensional<br>convolution as well as final negative results. Thus this approach<br>is currently most useful for symmetrical filter kernels. By using<br>post-convolution scaling and bias extensions these problems can be<br>easily overcome.</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:81"><nobr><span class="ft17">Non-separable convolutions are not possible right now with this al-<br>gorithm. However, by applying several two-dimensional filter ker-<br>nels and blending convoluted images in the frame buffer the use of<br>non-separable 3D kernels will be a possibility for the future as well.</span></nobr></DIV>
<DIV style="position:absolute;top:89;left:477"><nobr><span class="ft2"><b>References</b></span></nobr></DIV>
<DIV style="position:absolute;top:125;left:483"><nobr><span class="ft7">[1] M Bro-Nielson. <i>Medical Image Registration and Surgery Simulation</i>.</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:504"><nobr><span class="ft7">PhD thesis, IMM, Technical University of Denmark, 1996.</span></nobr></DIV>
<DIV style="position:absolute;top:162;left:483"><nobr><span class="ft7">[2] R. A. Crawfis and N. L. Max. Texture Splats for 3D Scalar and Vector</span></nobr></DIV>
<DIV style="position:absolute;top:178;left:504"><nobr><span class="ft33">Field Visualization. In G. M. Nielson and Bergeron D., editors, <i>Visual-<br>ization 93</i>, pages 261≠265, Los Alamitos, CA, 1993. IEEE Computer<br>Society, IEEE Computer Society Press.</span></nobr></DIV>
<DIV style="position:absolute;top:231;left:483"><nobr><span class="ft7">[3] M. Hopf and T. Ertl. Hardware Based Wavelet Transformations. In</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:504"><nobr><span class="ft33"><i>Erlangen Workshop '99 on Vision, Modeling and Visualization</i>, Erlan-<br>gen, November 1999. IEEE. accepted for publication, November 17 ≠<br>19.</span></nobr></DIV>
<DIV style="position:absolute;top:299;left:483"><nobr><span class="ft7">[4] A. Kaufman. <i>Volume Visualization</i>. IEEE Computer Society Press,</span></nobr></DIV>
<DIV style="position:absolute;top:315;left:504"><nobr><span class="ft7">1991.</span></nobr></DIV>
<DIV style="position:absolute;top:336;left:483"><nobr><span class="ft7">[5] P. Lacroute and M. Levoy. Fast Volume Rendering Using a Shear-</span></nobr></DIV>
<DIV style="position:absolute;top:352;left:504"><nobr><span class="ft7">Warp Factorization of the Viewing Transformation.</span></nobr></DIV>
<DIV style="position:absolute;top:352;left:774"><nobr><span class="ft7">In <i>Computer</i></span></nobr></DIV>
<DIV style="position:absolute;top:368;left:504"><nobr><span class="ft33"><i>Graphics Proceedings</i>, Annual Conference Series, pages 451≠457,<br>Los Angeles, California, July 1994. ACM SIGGRAPH, Addison-<br>Wesley Publishing Company, Inc.</span></nobr></DIV>
<DIV style="position:absolute;top:420;left:483"><nobr><span class="ft7">[6] L. Lippert, M. H. Gross, and C. Kurmann. Compression Domain</span></nobr></DIV>
<DIV style="position:absolute;top:436;left:504"><nobr><span class="ft33">Volume Rendering for Distributed Environments. In D. Fellner and<br>L. Szirmay-Kalos, editors, <i>EUROGRAPHICS '97</i>, volume 14, pages<br>C95≠C107. Eurographics Association, Blackwell Publishers, 1997.</span></nobr></DIV>
<DIV style="position:absolute;top:489;left:483"><nobr><span class="ft7">[7] C. L ®urig and T. Ertl. Hierarchical Volume Analysis and Visualization</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:504"><nobr><span class="ft33">Based on Morphological Operators. In <i>Proc. IEEE Visualization '98</i>,<br>pages 335≠341, 1998.</span></nobr></DIV>
<DIV style="position:absolute;top:542;left:483"><nobr><span class="ft7">[8] P. Schr®oder and G. Stoll. Data Parallel Volume Rendering as Line</span></nobr></DIV>
<DIV style="position:absolute;top:557;left:504"><nobr><span class="ft33">Drawing. In <i>1992 Workshop on Volume Visualization</i>. ACM SIG-<br>GRAPH, October 1992.</span></nobr></DIV>
<DIV style="position:absolute;top:594;left:483"><nobr><span class="ft7">[9] Silicon Graphics Inc., Mountain View, California. <i>Volume Rendering</i></span></nobr></DIV>
<DIV style="position:absolute;top:610;left:504"><nobr><span class="ft31"><i>using RE2 Technology</i>, 1994.</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:477"><nobr><span class="ft7">[10] Silicon Graphics Inc., Mountain View, California. <i>OpenGL on Silicon</i></span></nobr></DIV>
<DIV style="position:absolute;top:647;left:504"><nobr><span class="ft31"><i>Graphics Systems</i>, 1996.</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:477"><nobr><span class="ft7">[11] O. Sommer, A. Dietz, R. Westermann, and T. Ertl. An Interactive Vi-</span></nobr></DIV>
<DIV style="position:absolute;top:684;left:504"><nobr><span class="ft33">sualization and Navigation Tool for Medical Volume Data. In N. M.<br>Thalmann and V. Skala, editors, <i>WSCG '98, The Sixth International<br>Conference in Central Europe on Computer Graphics and Visualiza-<br>tion '98</i>, volume II, pages 362≠371, Plzen, Czech Republic, February<br>1998. University of West Bohemia Press.</span></nobr></DIV>
<DIV style="position:absolute;top:768;left:477"><nobr><span class="ft7">[12] T. Totsuka and M. Levoy. Frequency Domain Volume Rendering.</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:504"><nobr><span class="ft31"><i>Computer Graphics</i>, 27(4):271≠78, August 1993.</span></nobr></DIV>
<DIV style="position:absolute;top:806;left:477"><nobr><span class="ft7">[13] R. Westermann and T. Ertl.</span></nobr></DIV>
<DIV style="position:absolute;top:806;left:653"><nobr><span class="ft7">A Multiscale Approach to Integrated</span></nobr></DIV>
<DIV style="position:absolute;top:821;left:504"><nobr><span class="ft7">Volume Segmentation and Rendering.</span></nobr></DIV>
<DIV style="position:absolute;top:821;left:704"><nobr><span class="ft7">In <i>Computer Graphics Fo-</i></span></nobr></DIV>
<DIV style="position:absolute;top:837;left:504"><nobr><span class="ft33"><i>rum 16(3) (Proc. EUROGRAPHICS '97)</i>, number 3, pages 117≠129.<br>Blackwell, 1997.</span></nobr></DIV>
<DIV style="position:absolute;top:874;left:477"><nobr><span class="ft7">[14] R. Westermann and T. Ertl. Efficiently Using Graphics Hardware in</span></nobr></DIV>
<DIV style="position:absolute;top:890;left:504"><nobr><span class="ft33">Volume Rendering Applications. In <i>Computer Graphics Proceedings</i>,<br>Annual Conference Series, pages 169≠177, Orlando, Florida, 1998.<br>ACM SIGGRAPH.</span></nobr></DIV>
<DIV style="position:absolute;top:1149;left:446"><nobr><span class="ft14"><b>474</b></span></nobr></DIV>
</DIV>
<!-- Page 5 -->
<a name="5"></a>
<DIV style="position:relative;width:918;height:1188;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1188" src="26005.png" alt="background image">
<DIV style="position:absolute;top:259;left:81"><nobr><span class="ft25">Figure 8: The unfiltered<br>head data set</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:232"><nobr><span class="ft25">Figure 9: Head, low pass<br>filtered in software</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:383"><nobr><span class="ft3">Figure 10:</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:458"><nobr><span class="ft3">Head, low</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:383"><nobr><span class="ft3">pass filtered in hardware</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:535"><nobr><span class="ft3">Figure 11:</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:607"><nobr><span class="ft3">Head, high</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:535"><nobr><span class="ft3">pass filtered in software</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:686"><nobr><span class="ft3">Figure 12:</span></nobr></DIV>
<DIV style="position:absolute;top:259;left:758"><nobr><span class="ft3">Head, high</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:686"><nobr><span class="ft3">pass filtered in hardware</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:90"><nobr><span class="ft25">Figure 13: The original angiog-<br>raphy data set</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:277"><nobr><span class="ft25">Figure 14: The Gauﬂ filtered<br>data set</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:464"><nobr><span class="ft3">Figure 15:</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:546"><nobr><span class="ft3">Data,</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:587"><nobr><span class="ft3">after di-</span></nobr></DIV>
<DIV style="position:absolute;top:562;left:464"><nobr><span class="ft25">rect filtering with Gauﬂ' second<br>derivative</span></nobr></DIV>
<DIV style="position:absolute;top:547;left:650"><nobr><span class="ft25">Figure 16: First low pass, then<br>high pass filtered data</span></nobr></DIV>
<DIV style="position:absolute;top:1054;left:106"><nobr><span class="ft3">Figure 17: ISO surfaces on the original angiography data set</span></nobr></DIV>
<DIV style="position:absolute;top:1054;left:501"><nobr><span class="ft3">Figure 18: ISO surfaces on the Gauﬂ filtered data set</span></nobr></DIV>
</DIV>
</BODY>
</HTML>
