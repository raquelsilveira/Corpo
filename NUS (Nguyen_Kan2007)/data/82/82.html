<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<TITLE>p08-chapman.dvi</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="generator" content="pdftohtml 0.35beta">
<META name="date" content="2004-11-16T21:52:04+00:00">
</HEAD>
<BODY bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
	.ft0{font-size:24px;font-family:Times;color:#000000;}
	.ft1{font-size:15px;font-family:Times;color:#000000;}
	.ft2{font-size:12px;font-family:Times;color:#000000;}
	.ft3{font-size:11px;font-family:Times;color:#000000;}
	.ft4{font-size:9px;font-family:Times;color:#000000;}
	.ft5{font-size:16px;font-family:Courier;color:#000000;}
	.ft6{font-size:11px;font-family:Times;color:#000000;}
	.ft7{font-size:11px;line-height:15px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1258" src="82001.png" alt="background image">
<DIV style="position:absolute;top:98;left:89"><nobr><span class="ft0"><b>Enforcing Security and Safety Models with an Information</b></span></nobr></DIV>
<DIV style="position:absolute;top:128;left:337"><nobr><span class="ft0"><b>Flow Analysis Tool</b></span></nobr></DIV>
<DIV style="position:absolute;top:198;left:211"><nobr><span class="ft1">Roderick Chapman</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:197"><nobr><span class="ft2">Praxis Critical Systems Ltd.</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:227"><nobr><span class="ft2">20 Manvers Street</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:183"><nobr><span class="ft2">Bath BA1 1PX, United Kingdom</span></nobr></DIV>
<DIV style="position:absolute;top:269;left:167"><nobr><span class="ft1">rod.chapman@praxis-cs.co.uk</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:575"><nobr><span class="ft1">Adrian Hilton</span></nobr></DIV>
<DIV style="position:absolute;top:217;left:536"><nobr><span class="ft2">Praxis Critical Systems Ltd.</span></nobr></DIV>
<DIV style="position:absolute;top:232;left:566"><nobr><span class="ft2">20 Manvers Street</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:522"><nobr><span class="ft2">Bath BA1 1PX, United Kingdom</span></nobr></DIV>
<DIV style="position:absolute;top:269;left:509"><nobr><span class="ft1">adrian.hilton@praxis-cs.co.uk</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:81"><nobr><span class="ft1">ABSTRACT</span></nobr></DIV>
<DIV style="position:absolute;top:352;left:81"><nobr><span class="ft7">Existing security models require that information of a given<br>security level be prevented from "leaking" into lower-security<br>information. High-security applications must be demonstra-<br>bly free of such leaks, but such demonstration may require<br>substantial manual analysis.</span></nobr></DIV>
<DIV style="position:absolute;top:415;left:269"><nobr><span class="ft3">Other authors have argued</span></nobr></DIV>
<DIV style="position:absolute;top:430;left:81"><nobr><span class="ft7">that the natural way to enforce these models automatically<br>is with information-flow analysis, but have not shown this to<br>be practicable for general purpose programming languages<br>in current use.</span></nobr></DIV>
<DIV style="position:absolute;top:493;left:94"><nobr><span class="ft3">Modern safety-critical systems can contain software com-</span></nobr></DIV>
<DIV style="position:absolute;top:509;left:81"><nobr><span class="ft7">ponents with differing safety integrity levels, potentially op-<br>erating in the same address space. This case poses problems<br>similar to systems with differing security levels; failure to<br>show separation of data may require the entire system to be<br>validated at the higher integrity level.</span></nobr></DIV>
<DIV style="position:absolute;top:587;left:94"><nobr><span class="ft3">In this paper we show how the information flow model</span></nobr></DIV>
<DIV style="position:absolute;top:603;left:81"><nobr><span class="ft7">enforced by the SPARK Examiner provides support for en-<br>forcing these security and safety models. We describe an<br>extension to the SPARK variable annotations which allows<br>the specification of a security or safety level for each state<br>variable, and an extension to the SPARK analysis which<br>automatically enforces a given information flow policy on a<br>SPARK program.</span></nobr></DIV>
<DIV style="position:absolute;top:724;left:81"><nobr><span class="ft1">Categories and Subject Descriptors</span></nobr></DIV>
<DIV style="position:absolute;top:753;left:81"><nobr><span class="ft7">D2.4 [Software Engineering]: Software/Program verifica-<br>tion; F3.1 [Logics and Meanings of Programs]: Speci-<br>fying and verifying and reasoning about programs</span></nobr></DIV>
<DIV style="position:absolute;top:812;left:81"><nobr><span class="ft1">General Terms</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:81"><nobr><span class="ft3">Design,Measurement,Security,Verification</span></nobr></DIV>
<DIV style="position:absolute;top:868;left:81"><nobr><span class="ft1">Keywords</span></nobr></DIV>
<DIV style="position:absolute;top:897;left:81"><nobr><span class="ft7">Information flow, SPARK Ada, Dolev-Yao, Bell-LaPadula,<br>security, safety</span></nobr></DIV>
<DIV style="position:absolute;top:969;left:81"><nobr><span class="ft4">Permission to make digital or hard copies of all or part of this work for</span></nobr></DIV>
<DIV style="position:absolute;top:983;left:81"><nobr><span class="ft4">personal or classroom use is granted without fee provided that copies are</span></nobr></DIV>
<DIV style="position:absolute;top:996;left:81"><nobr><span class="ft4">not made or distributed for profit or commercial advantage and that copies</span></nobr></DIV>
<DIV style="position:absolute;top:1010;left:81"><nobr><span class="ft4">bear this notice and the full citation on the first page. To copy otherwise, to</span></nobr></DIV>
<DIV style="position:absolute;top:1023;left:81"><nobr><span class="ft4">republish, to post on servers or to redistribute to lists, requires prior specific</span></nobr></DIV>
<DIV style="position:absolute;top:1037;left:81"><nobr><span class="ft4">permission and/or a fee.</span></nobr></DIV>
<DIV style="position:absolute;top:1050;left:81"><nobr><span class="ft4">SIGAda'04, November 14­18, 2004, Atlanta, Georgia, USA.</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:81"><nobr><span class="ft4">Copyright 2004 ACM 1-58113-906-3/04/0011 ...</span></nobr></DIV>
<DIV style="position:absolute;top:1065;left:315"><nobr><span class="ft3">$</span></nobr></DIV>
<DIV style="position:absolute;top:1064;left:322"><nobr><span class="ft4">5.00.</span></nobr></DIV>
<DIV style="position:absolute;top:323;left:475"><nobr><span class="ft1">1. INTRODUCTION</span></nobr></DIV>
<DIV style="position:absolute;top:350;left:489"><nobr><span class="ft3">Software is often used to develop security-critical applica-</span></nobr></DIV>
<DIV style="position:absolute;top:365;left:475"><nobr><span class="ft7">tions. Some of these applications are required to manage in-<br>formation of different classification levels, ensuring that each<br>user may only access the data for which he or she has ade-<br>quate authorisation. This requirement has two components;<br>the developer must produce a design and implementation<br>which supports this model and its constraints, and the im-<br>plementation must support verification that the constraints<br>are never violated. It is not enough for the implementa-<br>tion to be correct; for it to be secure, it must be seen to be<br>correct.</span></nobr></DIV>
<DIV style="position:absolute;top:522;left:489"><nobr><span class="ft3">In this paper we examine the problem of developing and</span></nobr></DIV>
<DIV style="position:absolute;top:538;left:475"><nobr><span class="ft7">verifying a security-critical application containing this secu-<br>rity structure (often termed multi-level security). We will<br>analyse recent work on information flow and security and<br>show how the information flow analysis of the SPARK Ex-<br>aminer tool is appropriate for solving this problem. We will<br>show how it is also important for the efficient analysis of<br>safety-critical systems. We will then describe modifications<br>to the current definition of the SPARK Ada language[2]<br>and the Examiner which permit complete validation of Ada<br>programs against defined security models such as the Bell-<br>LaPadula model[3].</span></nobr></DIV>
<DIV style="position:absolute;top:710;left:489"><nobr><span class="ft3">We intend that the additional flow analysis features de-</span></nobr></DIV>
<DIV style="position:absolute;top:726;left:475"><nobr><span class="ft7">scribed here will appear in a future commercial Examiner<br>release. Although we anticipate possible minor changes to<br>the syntax and analysis performed, we expect the released<br>version to implement the analysis described here in all sub-<br>stantial aspects.</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:475"><nobr><span class="ft1">2. EXISTING WORK</span></nobr></DIV>
<DIV style="position:absolute;top:842;left:489"><nobr><span class="ft3">In this section we identify typical standards which will in-</span></nobr></DIV>
<DIV style="position:absolute;top:858;left:475"><nobr><span class="ft7">form the development and verification of a security-critical<br>or safety-critical application. We then analyse a survey pa-<br>per on information flow and security, and compare its con-<br>clusions against the information flow model of the SPARK<br>annotated subset of Ada95.</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:475"><nobr><span class="ft1">2.1 Standards</span></nobr></DIV>
<DIV style="position:absolute;top:967;left:489"><nobr><span class="ft3">The Common Criteria for IT Security [5] specify the de-</span></nobr></DIV>
<DIV style="position:absolute;top:983;left:475"><nobr><span class="ft7">velopment and verification activities that are suitable for<br>applications at differing levels of security. These Evalua-<br>tion Assurance Levels (EALs) range from EAL-1 (lowest) to<br>EAL-7 (highest). As the EAL number rises, the required<br>activities become more rigorous; at the higher levels, formal<br>specification and analysis of the software becomes required.</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">39</span></nobr></DIV>
</DIV>
<!-- Page 2 -->
<a name="2"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1258" src="82002.png" alt="background image">
<DIV style="position:absolute;top:81;left:94"><nobr><span class="ft3">For safety-related applications there are similar concepts</span></nobr></DIV>
<DIV style="position:absolute;top:97;left:81"><nobr><span class="ft7">for the safety criticality of software; RTCA DO-178B[10]<br>for civil avionics software defines criticality levels E (low-<br>est) through to A (most critical). As one would expect,<br>the required development and verification activities become<br>increasingly more onerous (and expensive) with increasing<br>criticality level. As a result, if an avionics system were to<br>contain a "core" of critical functionality at Level A and a<br>larger body of utility code at Level D then either the entire<br>system would have to be developed and verified at Level A<br>or a rigorous argument would have to be applied that the<br>Level D code could not in any way affect the integrity of the<br>Level A code.</span></nobr></DIV>
<DIV style="position:absolute;top:285;left:94"><nobr><span class="ft3">Another notation for safety criticality is the Safety In-</span></nobr></DIV>
<DIV style="position:absolute;top:301;left:81"><nobr><span class="ft7">tegrity Level (SIL), described in IEC 61508[8]. SIL-1 is the<br>lowest level of safety integrity, and SIL-4 the highest; DO-<br>178B level A approximates to SIL-3/SIL-4 when comparing<br>the development and verification activities required.</span></nobr></DIV>
<DIV style="position:absolute;top:363;left:94"><nobr><span class="ft3">In this paper we assume that we are attempting to vali-</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:81"><nobr><span class="ft7">date systems at EAL-5 or greater (for security) and RTCA<br>Level B or greater (for safety). We are therefore required to<br>provide a rigorous and comprehensive justification for any<br>statements which we make about the separation of data.<br>Therefore we now look at how such statements may be ex-<br>pressed.</span></nobr></DIV>
<DIV style="position:absolute;top:478;left:81"><nobr><span class="ft1">2.2 Information Flow</span></nobr></DIV>
<DIV style="position:absolute;top:504;left:94"><nobr><span class="ft3">"Information flow" as it applies to conventional impera-</span></nobr></DIV>
<DIV style="position:absolute;top:520;left:81"><nobr><span class="ft7">tive computer programs has a range of definitions, and is<br>often confused with "data flow"; we shall take the definition<br>as expressed in Barnes[2] p.13:</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:101"><nobr><span class="ft3">· data flow analysis is concerned with the direction of</span></nobr></DIV>
<DIV style="position:absolute;top:596;left:114"><nobr><span class="ft3">data flow; whereas</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:101"><nobr><span class="ft3">· information flow analysis also considers the coupling</span></nobr></DIV>
<DIV style="position:absolute;top:638;left:114"><nobr><span class="ft3">between variables.</span></nobr></DIV>
<DIV style="position:absolute;top:667;left:94"><nobr><span class="ft3">An example of the difference between data flow and infor-</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:81"><nobr><span class="ft3">mation flow comes from the following (Ada) code:</span></nobr></DIV>
<DIV style="position:absolute;top:709;left:81"><nobr><span class="ft3">while (X &lt; 4) loop</span></nobr></DIV>
<DIV style="position:absolute;top:725;left:102"><nobr><span class="ft7">A := A + 2 * B;<br>X := X * 2;</span></nobr></DIV>
<DIV style="position:absolute;top:756;left:81"><nobr><span class="ft3">end loop;</span></nobr></DIV>
<DIV style="position:absolute;top:781;left:94"><nobr><span class="ft3">Here, data flow analysis would state that data flows from</span></nobr></DIV>
<DIV style="position:absolute;top:797;left:81"><nobr><span class="ft7">X to X and from A and B to A. Information flow analysis<br>would note additionally that the final value of A is affected<br>by the initial value of X, and hence that there is information<br>flow from X to A.</span></nobr></DIV>
<DIV style="position:absolute;top:860;left:94"><nobr><span class="ft3">Sabelfeld and Myers[11] recently surveyed the use of in-</span></nobr></DIV>
<DIV style="position:absolute;top:876;left:81"><nobr><span class="ft7">formation flow analysis in software. They viewed the funda-<br>mental problem of maintaining security as one of tracking<br>the flow of information in computing systems. They exam-<br>ined the various ways that secure information could leak into<br>less secure information, overtly and covertly. They identify<br>in particular the concept of implicit information flows, an<br>example of which is given in the while-loop example above.</span></nobr></DIV>
<DIV style="position:absolute;top:985;left:94"><nobr><span class="ft3">Their survey characterised language-based information flow</span></nobr></DIV>
<DIV style="position:absolute;top:1001;left:81"><nobr><span class="ft3">as requiring:</span></nobr></DIV>
<DIV style="position:absolute;top:1030;left:97"><nobr><span class="ft3">1. semantics-based security, so that rigorous argument</span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:114"><nobr><span class="ft7">could be made about a variation of a high-security<br>value not affecting a low-security value; and</span></nobr></DIV>
<DIV style="position:absolute;top:81;left:491"><nobr><span class="ft3">2. a security type system, so that a program or expression</span></nobr></DIV>
<DIV style="position:absolute;top:97;left:509"><nobr><span class="ft7">can be assigned security values (types) and the type<br>changes of the program or expression can be charac-<br>terised.</span></nobr></DIV>
<DIV style="position:absolute;top:151;left:489"><nobr><span class="ft3">They concluded that "standard" security practices do not</span></nobr></DIV>
<DIV style="position:absolute;top:167;left:475"><nobr><span class="ft7">and cannot enforce the end-to-end confidentiality required<br>by common security models. They characterised the existing<br>work in security and information flow analysis, but notably<br>did not address the work of Bergeretti and Carr´e[4].</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:475"><nobr><span class="ft1">2.3 Security models</span></nobr></DIV>
<DIV style="position:absolute;top:260;left:489"><nobr><span class="ft3">The Bell-LaPadula (BLP) model of computer security[3]</span></nobr></DIV>
<DIV style="position:absolute;top:276;left:475"><nobr><span class="ft3">enforces two properties:</span></nobr></DIV>
<DIV style="position:absolute;top:298;left:491"><nobr><span class="ft3">1. no process may read data from a higher security level;</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:509"><nobr><span class="ft3">and</span></nobr></DIV>
<DIV style="position:absolute;top:337;left:491"><nobr><span class="ft3">2. no process may write data to a lower security level.</span></nobr></DIV>
<DIV style="position:absolute;top:359;left:489"><nobr><span class="ft3">Such multi-level security has a number of problems; An-</span></nobr></DIV>
<DIV style="position:absolute;top:375;left:475"><nobr><span class="ft3">derson[1] provides a list of them including:</span></nobr></DIV>
<DIV style="position:absolute;top:400;left:495"><nobr><span class="ft3">· "blind write-up": the inability to inform low-security</span></nobr></DIV>
<DIV style="position:absolute;top:412;left:509"><nobr><span class="ft7">data whether a write to high-security data has hap-<br>pened correctly;</span></nobr></DIV>
<DIV style="position:absolute;top:456;left:495"><nobr><span class="ft3">· "downgrading": moving information from a high secu-</span></nobr></DIV>
<DIV style="position:absolute;top:467;left:509"><nobr><span class="ft3">rity level to a lower level is sometimes desirable; and</span></nobr></DIV>
<DIV style="position:absolute;top:496;left:495"><nobr><span class="ft3">· "TCB bloat": a large subset of the operating system</span></nobr></DIV>
<DIV style="position:absolute;top:507;left:509"><nobr><span class="ft3">may end up in the Trusted Computing Base (TCB).</span></nobr></DIV>
<DIV style="position:absolute;top:529;left:489"><nobr><span class="ft3">The Dolev-Yao security model[6] makes secret information</span></nobr></DIV>
<DIV style="position:absolute;top:545;left:475"><nobr><span class="ft3">indivisible; it cannot be leaked in part but only in total.</span></nobr></DIV>
<DIV style="position:absolute;top:564;left:475"><nobr><span class="ft1">2.4 Information Flow in Ada</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:489"><nobr><span class="ft3">Bergeretti and Carr´e wrote a seminal paper[4] describ-</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:475"><nobr><span class="ft7">ing a practical implementation of information flow analy-<br>sis in the SPADE Pascal language (although the principles<br>were applicable to most conventional imperative program-<br>ming languages). This was managed by the composition<br>of matrices representing information flow dependencies be-<br>tween variable imports and exports. Notably, conditional<br>and infinite loops were permissible and analysable within<br>the framework of such a language; these were managed by<br>computing the transitive closure of the information flow ma-<br>trix corresponding to one execution of the loop.</span></nobr></DIV>
<DIV style="position:absolute;top:763;left:489"><nobr><span class="ft3">This information flow model was implemented in the SPARK</span></nobr></DIV>
<DIV style="position:absolute;top:779;left:475"><nobr><span class="ft7">annotated Ada subset[2]. The subset requires each subpro-<br>gram to be annotated with the required information flow<br>("derives" annotations) if information flow analysis is re-<br>quired. The SPARK subset is enforced by the SPARK Ex-<br>aminer tool which checks the required information flow of<br>each subprogram against the actual information flow. The<br>annotations (and other SPARK rules such as the ban on cir-<br>cular dependency) are necessary to make this information<br>flow analysis tractable.</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:489"><nobr><span class="ft3">The result of this is that it is possible, in a fully-analysed</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:475"><nobr><span class="ft7">SPARK program, to be certain that a given exported vari-<br>able is independent of a given imported variable. This is a<br>key step towards supporting multi-level security in SPARK<br>Ada, and makes it easier to write demonstrably secure and<br>correct code, but is not a complete solution. In Section 3<br>we will describe how SPARK Examiner analysis may be ex-<br>tended better to implement these checks.</span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:489"><nobr><span class="ft3">We now examine case studies of the use of SPARK, and</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:475"><nobr><span class="ft3">the utility of information flow in real applications.</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">40</span></nobr></DIV>
</DIV>
<!-- Page 3 -->
<a name="3"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
	.ft8{font-size:6px;font-family:Times;color:#000000;}
	.ft9{font-size:14px;font-family:Times;color:#000000;}
	.ft10{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</STYLE>
<IMG width="918" height="1258" src="82003.png" alt="background image">
<DIV style="position:absolute;top:74;left:81"><nobr><span class="ft1">2.5 Security and Safety Applications</span></nobr></DIV>
<DIV style="position:absolute;top:100;left:94"><nobr><span class="ft3">An example of a high-security application which was partly</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:81"><nobr><span class="ft7">developed in SPARK is the MULTOS CA[7]. This was de-<br>veloped and verified at a high level of integrity, approxi-<br>mating to the Common Criteria EAL-5. The delivered sys-<br>tem had a defect rate of 0.04 errors per thousand lines of<br>code (KLOC). This showed that SPARK was a practical<br>language for implementing high-security applications. Part<br>of the analysis required during development and verification<br>of the CA was to show that secret data could not leak out<br>directly or indirectly in unclassified outputs.</span></nobr></DIV>
<DIV style="position:absolute;top:257;left:94"><nobr><span class="ft3">An example of a safety-critical application with mixed in-</span></nobr></DIV>
<DIV style="position:absolute;top:273;left:81"><nobr><span class="ft7">tegrity levels where information flow analysis was helpful<br>was the SHOLIS information system described by King et<br>al.[9]. This application mixed SIL-4 and non-critical code,<br>and was written in the SPARK subset of Ada83. Static<br>verification was used, including information flow analysis<br>and partial program proof, to verify significant properties<br>of SHOLIS. There was a successful argument based partly<br>on information flow analysis that the high-SIL code was not<br>compromised by the low-SIL code; however, this argument<br>had to be made manually, based on the validated informa-<br>tion flow of each subprogram, as the Examiner did not pro-<br>vide such tracing facilities at the program level.</span></nobr></DIV>
<DIV style="position:absolute;top:474;left:81"><nobr><span class="ft1">3. IMPROVING SPARK ANALYSIS</span></nobr></DIV>
<DIV style="position:absolute;top:501;left:94"><nobr><span class="ft3">The outstanding need in SPARK is to be able to mark</span></nobr></DIV>
<DIV style="position:absolute;top:516;left:81"><nobr><span class="ft7">state variables in packages with a (numerical) level of secu-<br>rity and / or safety. This has been implemented by allowing<br>an optional aggregate after a package ("own") variable dec-<br>laration.</span></nobr></DIV>
<DIV style="position:absolute;top:584;left:81"><nobr><span class="ft1">3.1 Marking security levels</span></nobr></DIV>
<DIV style="position:absolute;top:610;left:94"><nobr><span class="ft3">Suppose that a package Classify was defined as follows</span></nobr></DIV>
<DIV style="position:absolute;top:626;left:81"><nobr><span class="ft3">to create various secrecy levels:</span></nobr></DIV>
<DIV style="position:absolute;top:656;left:81"><nobr><span class="ft3">package Classify is</span></nobr></DIV>
<DIV style="position:absolute;top:672;left:102"><nobr><span class="ft7">-- Security levels<br>UNCLASSIFIED : constant := 0;<br>RESTRICTED</span></nobr></DIV>
<DIV style="position:absolute;top:703;left:194"><nobr><span class="ft3">: constant := 1;</span></nobr></DIV>
<DIV style="position:absolute;top:719;left:102"><nobr><span class="ft7">CONFIDENTIAL : constant := 2;<br>SECRET</span></nobr></DIV>
<DIV style="position:absolute;top:734;left:194"><nobr><span class="ft3">: constant := 3;</span></nobr></DIV>
<DIV style="position:absolute;top:750;left:102"><nobr><span class="ft3">TOPSECRET</span></nobr></DIV>
<DIV style="position:absolute;top:750;left:194"><nobr><span class="ft3">: constant := 4;</span></nobr></DIV>
<DIV style="position:absolute;top:766;left:81"><nobr><span class="ft3">end Classify;</span></nobr></DIV>
<DIV style="position:absolute;top:794;left:94"><nobr><span class="ft3">Then we define a package KeyStore to store and manage</span></nobr></DIV>
<DIV style="position:absolute;top:810;left:81"><nobr><span class="ft10">a symmetric encryption key SymmetricKey, designed to mu-<br>tate after each encryption according to a rotation parameter<br>RotorValue</span></nobr></DIV>
<DIV style="position:absolute;top:841;left:151"><nobr><span class="ft3">. The key is clearly a high-security data item,</span></nobr></DIV>
<DIV style="position:absolute;top:857;left:81"><nobr><span class="ft3">with the rotor value requiring less security.</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:94"><nobr><span class="ft3">KeyStore</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:154"><nobr><span class="ft3">marks its state variables with the field Integrity</span></nobr></DIV>
<DIV style="position:absolute;top:871;left:443"><nobr><span class="ft8">1</span></nobr></DIV>
<DIV style="position:absolute;top:888;left:81"><nobr><span class="ft3">thus:</span></nobr></DIV>
<DIV style="position:absolute;top:915;left:81"><nobr><span class="ft7">--# inherit Classify;<br>package KeyStore<br>--# own SymmetricKey(Integrity =&gt; Classify.SECRET);<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:962;left:123"><nobr><span class="ft3">RotorValue(Integrity =&gt; Classify.RESTRICTED);</span></nobr></DIV>
<DIV style="position:absolute;top:978;left:81"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:994;left:102"><nobr><span class="ft7">procedure Rotate;<br>--# global in RotorValue;<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:1025;left:151"><nobr><span class="ft3">in out SymmetricKey;</span></nobr></DIV>
<DIV style="position:absolute;top:1046;left:81"><nobr><span class="ft8">1</span></nobr></DIV>
<DIV style="position:absolute;top:1049;left:88"><nobr><span class="ft3">Integrity</span></nobr></DIV>
<DIV style="position:absolute;top:1048;left:157"><nobr><span class="ft3">was chosen to make sense for both security and</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:81"><nobr><span class="ft3">safety applications</span></nobr></DIV>
<DIV style="position:absolute;top:82;left:496"><nobr><span class="ft7">--# derives SymmetricKey from<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:97;left:546"><nobr><span class="ft3">SymmetricKey, RotorValue;</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:496"><nobr><span class="ft3">procedure Encrypt(C : in MessageBlock;</span></nobr></DIV>
<DIV style="position:absolute;top:144;left:624"><nobr><span class="ft3">E : out MessageBlock);</span></nobr></DIV>
<DIV style="position:absolute;top:160;left:496"><nobr><span class="ft7">--# global in SymmetricKey;<br>--# derives E from C, SymmetricKey;<br>...</span></nobr></DIV>
<DIV style="position:absolute;top:207;left:475"><nobr><span class="ft3">end KeyStore;</span></nobr></DIV>
<DIV style="position:absolute;top:234;left:489"><nobr><span class="ft3">Any security analysis must show, in the case of this code,</span></nobr></DIV>
<DIV style="position:absolute;top:250;left:475"><nobr><span class="ft7">that SymmetricKey data cannot leak into RotorValue or<br>data; i.e. there must be no subprogram (or main program)<br>whose information annotation shows SymmetricKey as an<br>import to RotorValue.</span></nobr></DIV>
<DIV style="position:absolute;top:313;left:489"><nobr><span class="ft3">Note that in this case package Classify will need to be</span></nobr></DIV>
<DIV style="position:absolute;top:328;left:475"><nobr><span class="ft7">inherited by all relevant package, but will never be withed<br>and so never compiled.</span></nobr></DIV>
<DIV style="position:absolute;top:365;left:475"><nobr><span class="ft1">3.2 Implementation</span></nobr></DIV>
<DIV style="position:absolute;top:392;left:489"><nobr><span class="ft3">We now define how the integrity levels are marked in the</span></nobr></DIV>
<DIV style="position:absolute;top:408;left:475"><nobr><span class="ft7">SPARK language, and how they are enforced by the SPARK<br>Examiner.</span></nobr></DIV>
<DIV style="position:absolute;top:439;left:489"><nobr><span class="ft3">The extra information flow checking is invoked using the</span></nobr></DIV>
<DIV style="position:absolute;top:455;left:475"><nobr><span class="ft3">/policy=X</span></nobr></DIV>
<DIV style="position:absolute;top:455;left:543"><nobr><span class="ft3">command line switch to the Examiner. Current</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:475"><nobr><span class="ft3">valid policy values are security and safety.</span></nobr></DIV>
<DIV style="position:absolute;top:494;left:479"><nobr><span class="ft9"><i>3.2.1 Variable declaration</i></span></nobr></DIV>
<DIV style="position:absolute;top:519;left:489"><nobr><span class="ft3">The above Integrity property on package own variables</span></nobr></DIV>
<DIV style="position:absolute;top:534;left:475"><nobr><span class="ft7">is a static property; at any point in static analysis of the<br>code, the actual and required integrity level of an own vari-<br>able is known. Own variables without Integrity levels are<br>taken to have a default integrity level of Natural'Last (i.e.<br>very highly classified) if imported under a security policy,<br>and Natural'First (i.e. unclassified) if exported under a<br>security policy. This gives the most paranoid checking so<br>that data may not leak from an input to an output through<br>an intermediate variable with unspecified integrity.</span></nobr></DIV>
<DIV style="position:absolute;top:676;left:489"><nobr><span class="ft3">If the analysis policy is safety then the default integrity</span></nobr></DIV>
<DIV style="position:absolute;top:691;left:475"><nobr><span class="ft3">values for unspecified own variables are reversed.</span></nobr></DIV>
<DIV style="position:absolute;top:715;left:479"><nobr><span class="ft9"><i>3.2.2 Integrity checks</i></span></nobr></DIV>
<DIV style="position:absolute;top:739;left:489"><nobr><span class="ft3">Information flow is declared explicitly in derives annota-</span></nobr></DIV>
<DIV style="position:absolute;top:755;left:475"><nobr><span class="ft10">tions for subprograms; an example from our cryptographic<br>KeyStore</span></nobr></DIV>
<DIV style="position:absolute;top:771;left:536"><nobr><span class="ft3">is the Rotate subprogram which changes the key</span></nobr></DIV>
<DIV style="position:absolute;top:786;left:475"><nobr><span class="ft3">based on the value of RotorValue:</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:475"><nobr><span class="ft7">procedure Rotate;<br>--# global in RotorValue;<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:846;left:517"><nobr><span class="ft3">in out SymmetricKey;</span></nobr></DIV>
<DIV style="position:absolute;top:862;left:475"><nobr><span class="ft7">--# derives SymmetricKey from<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:878;left:517"><nobr><span class="ft3">SymmetricKey, RotorValue;</span></nobr></DIV>
<DIV style="position:absolute;top:904;left:489"><nobr><span class="ft3">Using policy security the Examiner will then check that</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:475"><nobr><span class="ft10">the integrity level of the export SymmetricKey (SECRET) is<br>no less than the integrity levels of any import (SECRET and<br>RESTRICTED</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:545"><nobr><span class="ft3">). With policy safety the checks would be that</span></nobr></DIV>
<DIV style="position:absolute;top:967;left:475"><nobr><span class="ft7">the integrity of the export is no more than the integrity lev-<br>els of any import, i.e. that high-safety data exports cannot<br>be contaminated by low-safety data imports.</span></nobr></DIV>
<DIV style="position:absolute;top:1014;left:489"><nobr><span class="ft3">Information flow is also checked at each procedure call by</span></nobr></DIV>
<DIV style="position:absolute;top:1030;left:475"><nobr><span class="ft7">substituting in actual parameters (which may be own vari-<br>ables) for formal parameters and rechecking the procedure's<br>known information flow for integrity flows. As examples we</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">41</span></nobr></DIV>
</DIV>
<!-- Page 4 -->
<a name="4"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1258" src="82004.png" alt="background image">
<DIV style="position:absolute;top:81;left:81"><nobr><span class="ft7">give the procedures which get and set the rotor and key<br>values:</span></nobr></DIV>
<DIV style="position:absolute;top:123;left:81"><nobr><span class="ft7">procedure GetKey(This_Key : out Key);<br>--# global in SymmetricKey;<br>--# derives This_Key from SymmetricKey;</span></nobr></DIV>
<DIV style="position:absolute;top:186;left:81"><nobr><span class="ft7">procedure GetRotor(This_Rotor : out Rotor);<br>--# global in RotorValue;<br>--# derives This_Rotor from RotorValue;</span></nobr></DIV>
<DIV style="position:absolute;top:248;left:81"><nobr><span class="ft7">procedure SetKey(New_Key : in Key);<br>--# global out SymmetricKey;<br>--# derives SymmetricKey from New_Key;</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:81"><nobr><span class="ft7">procedure SetRotor(New_Rotor : in Rotor);<br>--# global out RotorValue;<br>--# derives RotorValue from New_Rotor;</span></nobr></DIV>
<DIV style="position:absolute;top:367;left:94"><nobr><span class="ft3">Because RotorValue is RESTRICTED and SymmetricKey is</span></nobr></DIV>
<DIV style="position:absolute;top:384;left:81"><nobr><span class="ft3">SECRET</span></nobr></DIV>
<DIV style="position:absolute;top:383;left:123"><nobr><span class="ft3">, the analysis requires a check at each invocation of</span></nobr></DIV>
<DIV style="position:absolute;top:399;left:81"><nobr><span class="ft7">these subprograms that the actual parameters mapped to<br>formal parameters do not violate integrity flow checks.</span></nobr></DIV>
<DIV style="position:absolute;top:437;left:85"><nobr><span class="ft9"><i>3.2.3 Analysis techniques not adopted</i></span></nobr></DIV>
<DIV style="position:absolute;top:461;left:94"><nobr><span class="ft3">One analysis technique which we considered (but rejected)</span></nobr></DIV>
<DIV style="position:absolute;top:477;left:81"><nobr><span class="ft7">was to track the integrity flows within each subprogram<br>body and raise warnings at each individual statement where<br>a violation occurs. We now explain how this would have<br>worked and why we rejected it.</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:94"><nobr><span class="ft3">In the following code, the programmer generates a key</span></nobr></DIV>
<DIV style="position:absolute;top:555;left:81"><nobr><span class="ft7">and rotor, encrypts a message with it, then tries to create a<br>new rotor based on the old key.</span></nobr></DIV>
<DIV style="position:absolute;top:597;left:81"><nobr><span class="ft7">-- Key and rotor generation<br>R1 := KeyStore.MakeRotor(34,56,22,55);<br>KeyStore.SetRotor(R1);<br>K1 := KeyStore.MakeKey(66,11,2,4);<br>KeyStore.SetKey(K1);<br>-- Encrypt a message<br>KeyStore.Encrypt(C =&gt; Clear, E =&gt; Encrypted);<br>-- Get a copy of the (changed) key and break<br>--</span></nobr></DIV>
<DIV style="position:absolute;top:723;left:109"><nobr><span class="ft3">it down into data</span></nobr></DIV>
<DIV style="position:absolute;top:738;left:81"><nobr><span class="ft7">KeyStore.GetKey(K1);<br>KeyStore.DecomposeKey(K1,I1,I2,I3,I4);<br>-- Build a new rotor<br>R1 := KeyStore.MakeRotor(I1,I2,I3,I4);<br>KeyStore.SetRotor(R1);</span></nobr></DIV>
<DIV style="position:absolute;top:826;left:94"><nobr><span class="ft3">The statement-by-statement information flow would pro-</span></nobr></DIV>
<DIV style="position:absolute;top:842;left:81"><nobr><span class="ft10">ceed as shown in Table 1, where C denotes Clear, RV de-<br>notes RotorValue, SK denotes SymmetricKey, and E denotes<br>Encrypted</span></nobr></DIV>
<DIV style="position:absolute;top:873;left:144"><nobr><span class="ft3">.</span></nobr></DIV>
<DIV style="position:absolute;top:889;left:94"><nobr><span class="ft3">The final step causes RotorValue to exceed its assigned</span></nobr></DIV>
<DIV style="position:absolute;top:904;left:81"><nobr><span class="ft7">integrity level, and would generate a static integrity flow<br>error.</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:94"><nobr><span class="ft3">The problem with this technique arises from the need to</span></nobr></DIV>
<DIV style="position:absolute;top:951;left:81"><nobr><span class="ft7">track the integrity levels of local variables. It quickly be-<br>comes clear that for practical analysis reasons each local<br>variable involved needs to be assigned an integrity level.<br>This is possible, and is done by declaring them as own vari-<br>ables with integrity levels in a package embedded in the<br>subprogram in question, but is cumbersome. It also requires<br>substantial rework of any existing code which we may want<br>to retro-analyse.</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:512"><nobr><span class="ft3">R1</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:546"><nobr><span class="ft3">K1</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:579"><nobr><span class="ft3">SK</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:614"><nobr><span class="ft3">RV</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:649"><nobr><span class="ft3">I1</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:677"><nobr><span class="ft3">C</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:703"><nobr><span class="ft3">E</span></nobr></DIV>
<DIV style="position:absolute;top:78;left:729"><nobr><span class="ft3">Instruction</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:551"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:586"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:621"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:706"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:94;left:729"><nobr><span class="ft3">­</span></nobr></DIV>
<DIV style="position:absolute;top:110;left:517"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:551"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:586"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:621"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:706"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:109;left:729"><nobr><span class="ft3">R1 :=</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:551"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:586"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:126;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:706"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:125;left:729"><nobr><span class="ft3">SetRotor</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:142;left:550"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:586"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:706"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:141;left:729"><nobr><span class="ft3">K1 :=</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:551"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:706"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:157;left:729"><nobr><span class="ft3">SetKey</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:551"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:704"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:172;left:729"><nobr><span class="ft3">Encrypt</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:189;left:550"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:653"><nobr><span class="ft3">-</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:704"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:729"><nobr><span class="ft3">GetKey</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:518"><nobr><span class="ft3">0</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:551"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:651"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:704"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:204;left:729"><nobr><span class="ft3">Decompose</span></nobr></DIV>
<DIV style="position:absolute;top:220;left:517"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:551"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:620"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:652"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:704"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:219;left:729"><nobr><span class="ft3">R1 :=</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:518"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:551"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:585"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:236;left:620"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:652"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:679"><nobr><span class="ft3">1</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:704"><nobr><span class="ft3">3</span></nobr></DIV>
<DIV style="position:absolute;top:235;left:729"><nobr><span class="ft3">SetRotor</span></nobr></DIV>
<DIV style="position:absolute;top:281;left:522"><nobr><span class="ft3">Table 1: Information flow for example</span></nobr></DIV>
<DIV style="position:absolute;top:319;left:479"><nobr><span class="ft9"><i>3.2.4 Example of checking</i></span></nobr></DIV>
<DIV style="position:absolute;top:344;left:489"><nobr><span class="ft3">We placed the code described above into procedure Operate</span></nobr></DIV>
<DIV style="position:absolute;top:359;left:475"><nobr><span class="ft7">in a package Crypto and annotated the declaration with the<br>correct derives annotation thus:</span></nobr></DIV>
<DIV style="position:absolute;top:402;left:475"><nobr><span class="ft7">--# inherit KeyStore,Classify,BitString;<br>package Crypto</span></nobr></DIV>
<DIV style="position:absolute;top:434;left:489"><nobr><span class="ft7">--# own Clear,<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:449;left:525"><nobr><span class="ft3">Encrypted(Integrity =&gt; Classify.SECRET);</span></nobr></DIV>
<DIV style="position:absolute;top:465;left:475"><nobr><span class="ft3">is</span></nobr></DIV>
<DIV style="position:absolute;top:481;left:496"><nobr><span class="ft7">procedure Operate;<br>--# global out KeyStore.RotorValue,Encrypted;<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:512;left:574"><nobr><span class="ft3">in out KeyStore.SymmetricKey;</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:528;left:574"><nobr><span class="ft3">in Clear;</span></nobr></DIV>
<DIV style="position:absolute;top:543;left:496"><nobr><span class="ft7">--# derives<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:559;left:539"><nobr><span class="ft3">KeyStore.SymmetricKey,</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:575;left:539"><nobr><span class="ft3">KeyStore.RotorValue</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:590;left:539"><nobr><span class="ft3">from</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:606;left:553"><nobr><span class="ft3">KeyStore.SymmetricKey</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:622;left:539"><nobr><span class="ft3">&amp;</span></nobr></DIV>
<DIV style="position:absolute;top:638;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:638;left:539"><nobr><span class="ft3">Encrypted</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:653;left:539"><nobr><span class="ft3">from</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:669;left:553"><nobr><span class="ft3">Clear,</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:685;left:553"><nobr><span class="ft3">KeyStore.SymmetricKey</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:496"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:700;left:539"><nobr><span class="ft3">;</span></nobr></DIV>
<DIV style="position:absolute;top:716;left:475"><nobr><span class="ft3">end Crypto;</span></nobr></DIV>
<DIV style="position:absolute;top:742;left:489"><nobr><span class="ft3">Analysis using /policy=security gives the following static</span></nobr></DIV>
<DIV style="position:absolute;top:757;left:475"><nobr><span class="ft3">semantic error:</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:475"><nobr><span class="ft3">Unit name:</span></nobr></DIV>
<DIV style="position:absolute;top:784;left:560"><nobr><span class="ft3">Crypto</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:475"><nobr><span class="ft3">Unit type:</span></nobr></DIV>
<DIV style="position:absolute;top:800;left:560"><nobr><span class="ft3">package specification</span></nobr></DIV>
<DIV style="position:absolute;top:816;left:475"><nobr><span class="ft3">Unit has been analysed, any errors are listed below</span></nobr></DIV>
<DIV style="position:absolute;top:847;left:475"><nobr><span class="ft3">1 error(s) or warning(s)</span></nobr></DIV>
<DIV style="position:absolute;top:879;left:475"><nobr><span class="ft3">Line</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:489"><nobr><span class="ft3">30</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:539"><nobr><span class="ft3">--#</span></nobr></DIV>
<DIV style="position:absolute;top:894;left:595"><nobr><span class="ft7">KeyStore.SymmetricKey<br>^1</span></nobr></DIV>
<DIV style="position:absolute;top:926;left:475"><nobr><span class="ft3">*** (</span></nobr></DIV>
<DIV style="position:absolute;top:926;left:525"><nobr><span class="ft3">1) Semantic Error</span></nobr></DIV>
<DIV style="position:absolute;top:926;left:673"><nobr><span class="ft3">:175: Information flow</span></nobr></DIV>
<DIV style="position:absolute;top:941;left:546"><nobr><span class="ft7">from KeyStore.SymmetricKey to<br>KeyStore.RotorValue violates the<br>selected information flow policy..</span></nobr></DIV>
<DIV style="position:absolute;top:998;left:489"><nobr><span class="ft3">which correctly identifies the potential leak.</span></nobr></DIV>
<DIV style="position:absolute;top:1019;left:475"><nobr><span class="ft1">3.3 Case study</span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:489"><nobr><span class="ft3">SHOLIS is the Royal Navy's Ship Helicopter Operating</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:475"><nobr><span class="ft3">Limits Information System [9] designed to assist landing of</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">42</span></nobr></DIV>
</DIV>
<!-- Page 5 -->
<a name="5"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1258" src="82005.png" alt="background image">
<DIV style="position:absolute;top:81;left:81"><nobr><span class="ft7">helicopters on Royal Navy Type 23 frigates. Failure of this<br>system could result in the death of helicopter pilots and pas-<br>sengers, loss of a helicopter and damage to the ship. This<br>is intolerable for normal operation, hence SIL-4 reliability is<br>required to give sufficient confidence that such an accident<br>will not happen during the in-service lifetime of the system.<br>SHOLIS is an on-demand system rather than a continuously<br>operating system, and so has a required probability of fail-<br>ure to function on demand of approximately 10</span></nobr></DIV>
<DIV style="position:absolute;top:208;left:373"><nobr><span class="ft8">-4</span></nobr></DIV>
<DIV style="position:absolute;top:206;left:388"><nobr><span class="ft3">; a more</span></nobr></DIV>
<DIV style="position:absolute;top:222;left:81"><nobr><span class="ft7">precise probability would be specified in the system safety<br>case.</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:94"><nobr><span class="ft3">However, the bulk of the SHOLIS code does not relate</span></nobr></DIV>
<DIV style="position:absolute;top:269;left:81"><nobr><span class="ft7">to critical system functionality. The code specific to SIL-4<br>must be analysed at a deep level; the rest of the code can<br>be analysed less deeply as long as it can be shown not to<br>affect the SIL-4 data adversely.</span></nobr></DIV>
<DIV style="position:absolute;top:338;left:85"><nobr><span class="ft9"><i>3.3.1 Original analysis</i></span></nobr></DIV>
<DIV style="position:absolute;top:363;left:94"><nobr><span class="ft3">The original SHOLIS code is Ada 83 and consists of 75</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:81"><nobr><span class="ft7">source files and shadow files amenable to SPARK analysis;<br>26.5KLoC of non-blank non-comment non-annotation code.<br>It is a substantial program and therefore a suitable test to<br>see if integrity level checking scales.</span></nobr></DIV>
<DIV style="position:absolute;top:441;left:94"><nobr><span class="ft3">Without any own variables annotated, a full SPARK anal-</span></nobr></DIV>
<DIV style="position:absolute;top:457;left:81"><nobr><span class="ft7">ysis by an Examiner with policy=safety generated no in-<br>tegrity errors, as we would expect.</span></nobr></DIV>
<DIV style="position:absolute;top:495;left:85"><nobr><span class="ft9"><i>3.3.2 Identifying critical outputs</i></span></nobr></DIV>
<DIV style="position:absolute;top:520;left:94"><nobr><span class="ft3">To enable easy marking of variable safety criticality we</span></nobr></DIV>
<DIV style="position:absolute;top:535;left:81"><nobr><span class="ft3">added a single package Safety:</span></nobr></DIV>
<DIV style="position:absolute;top:561;left:81"><nobr><span class="ft3">package Safety is</span></nobr></DIV>
<DIV style="position:absolute;top:576;left:95"><nobr><span class="ft7">NSC : constant := 0;<br>SC</span></nobr></DIV>
<DIV style="position:absolute;top:592;left:123"><nobr><span class="ft3">: constant := 1;</span></nobr></DIV>
<DIV style="position:absolute;top:608;left:81"><nobr><span class="ft3">end Safety;</span></nobr></DIV>
<DIV style="position:absolute;top:632;left:94"><nobr><span class="ft3">We took as an example the safety-critical output Alarm2Z</span></nobr></DIV>
<DIV style="position:absolute;top:648;left:81"><nobr><span class="ft7">in a package RMR which represents an alarm signal on the<br>front panel. This was annotated:</span></nobr></DIV>
<DIV style="position:absolute;top:689;left:81"><nobr><span class="ft7">--# own Alarm2Z : BasicTypes.OkFailT<br>--#</span></nobr></DIV>
<DIV style="position:absolute;top:705;left:137"><nobr><span class="ft3">(Integrity =&gt; Safety.SC);</span></nobr></DIV>
<DIV style="position:absolute;top:729;left:94"><nobr><span class="ft3">A re-analysis of package RMR raised no integrity errors.</span></nobr></DIV>
<DIV style="position:absolute;top:744;left:81"><nobr><span class="ft7">The other package that used Alarm2Z was EVENT which was<br>the main event handler. A SPARK of this package raised<br>integrity flow errors in subprogram Sync, where Alarm2Z de-<br>pended on a large range of other inputs, which had not yet<br>been marked as safety-critical. This was what we would ex-<br>pect so far and confirmed that basic safety integrity analysis<br>was working.</span></nobr></DIV>
<DIV style="position:absolute;top:861;left:85"><nobr><span class="ft9"><i>3.3.3 Extending analysis</i></span></nobr></DIV>
<DIV style="position:absolute;top:885;left:94"><nobr><span class="ft3">The next phase of work started in the SENSOR package</span></nobr></DIV>
<DIV style="position:absolute;top:901;left:81"><nobr><span class="ft7">which was near the middle of the package hierarchy. We set<br>the package variables representing current speed, heading,<br>roll, pitch and wind velocity state to be safety-critical and<br>then ran a trial SPARK analysis. This indicated many own<br>variables in this and other packages which caused integrity<br>flow errors since they had no explicit integrity level.</span></nobr></DIV>
<DIV style="position:absolute;top:995;left:94"><nobr><span class="ft3">For each of these packages in turn, we:</span></nobr></DIV>
<DIV style="position:absolute;top:1020;left:97"><nobr><span class="ft3">1. marked all of the package own variables as non-critical</span></nobr></DIV>
<DIV style="position:absolute;top:1036;left:114"><nobr><span class="ft3">(Safety.NSC);</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:97"><nobr><span class="ft3">2. re-analysed the package specification;</span></nobr></DIV>
<DIV style="position:absolute;top:81;left:491"><nobr><span class="ft3">3. analysed the package body to ensure that there were</span></nobr></DIV>
<DIV style="position:absolute;top:97;left:509"><nobr><span class="ft3">no integrity flow errors at subprogram call points; and</span></nobr></DIV>
<DIV style="position:absolute;top:128;left:491"><nobr><span class="ft3">4. if necessary, transformed NSC variables to SC status and</span></nobr></DIV>
<DIV style="position:absolute;top:144;left:509"><nobr><span class="ft3">re-ran.</span></nobr></DIV>
<DIV style="position:absolute;top:173;left:489"><nobr><span class="ft3">Eventually we converged on a stable SC/NSC partition of</span></nobr></DIV>
<DIV style="position:absolute;top:188;left:475"><nobr><span class="ft3">the variables.</span></nobr></DIV>
<DIV style="position:absolute;top:213;left:479"><nobr><span class="ft9"><i>3.3.4 Declassification</i></span></nobr></DIV>
<DIV style="position:absolute;top:238;left:489"><nobr><span class="ft3">The DisplayBuffers state variable in I/O package sio5</span></nobr></DIV>
<DIV style="position:absolute;top:253;left:475"><nobr><span class="ft7">was a point where safety-critical and non-safety critical data<br>merged. It was necessary during the actual project to pro-<br>duce a manual justification that the buffer would never be<br>filled with non-safety critical data when there was safety-<br>critical data to be added and displayed to a user. We there-<br>fore set its integrity to NSC and ignored all integrity errors<br>relating to flows from SIO5.DisplayBuffers.</span></nobr></DIV>
<DIV style="position:absolute;top:373;left:479"><nobr><span class="ft9"><i>3.3.5 Results</i></span></nobr></DIV>
<DIV style="position:absolute;top:397;left:489"><nobr><span class="ft3">There were 1282 integrity flow errors, but every single</span></nobr></DIV>
<DIV style="position:absolute;top:413;left:475"><nobr><span class="ft7">one of these referred to a flow from SIO5.DisplayBuffers<br>to Fault.Faults, as expected. Therefore only one manual<br>argument is needed to validate the separation of SC and NSC<br>data at this level.</span></nobr></DIV>
<DIV style="position:absolute;top:476;left:489"><nobr><span class="ft3">Of the 233 package specification variables which were given</span></nobr></DIV>
<DIV style="position:absolute;top:491;left:475"><nobr><span class="ft3">integrity levels, 110 were NSC and 123 were SC.</span></nobr></DIV>
<DIV style="position:absolute;top:516;left:479"><nobr><span class="ft9"><i>3.3.6 Lessons learned</i></span></nobr></DIV>
<DIV style="position:absolute;top:541;left:489"><nobr><span class="ft3">SHOLIS was developed using a now out-of-date version</span></nobr></DIV>
<DIV style="position:absolute;top:557;left:475"><nobr><span class="ft7">of the SPARK Examiner which did not support proof work<br>involving abstract state; as a consequence there were many<br>more public own variables than you would expect in a well-<br>designed modern SPARK program. This made the conver-<br>sion work slower; at the top level, as noted above, it in-<br>creased the time required beyond what was available for the<br>study.</span></nobr></DIV>
<DIV style="position:absolute;top:666;left:489"><nobr><span class="ft3">The "TCB bloat" problem noted in Section 2.3 did not</span></nobr></DIV>
<DIV style="position:absolute;top:682;left:475"><nobr><span class="ft7">seem to be a problem. While working up the calling hierar-<br>chy there was a small amount of returning to lower levels to<br>make NSC variables into SC, but this did not spread out of<br>control.</span></nobr></DIV>
<DIV style="position:absolute;top:745;left:489"><nobr><span class="ft3">There is a clear need for a declassification mechanism, as</span></nobr></DIV>
<DIV style="position:absolute;top:761;left:475"><nobr><span class="ft7">discussed in more detail in Section 4.3. Being able to sup-<br>press the integrity flow errors from DisplayBuffers would<br>have made the transformation process easier.</span></nobr></DIV>
<DIV style="position:absolute;top:815;left:475"><nobr><span class="ft1">3.4 Possible tactical extensions</span></nobr></DIV>
<DIV style="position:absolute;top:842;left:489"><nobr><span class="ft3">Given the preceding work, it is relatively simple to ex-</span></nobr></DIV>
<DIV style="position:absolute;top:857;left:475"><nobr><span class="ft7">tend the own variable annotation to allow other fields in the<br>aggregate. Within the security domain, there are consider-<br>ations which mean that security cannot be considered on a<br>linear scale.</span></nobr></DIV>
<DIV style="position:absolute;top:920;left:489"><nobr><span class="ft3">An example is a set of documents on an international mil-</span></nobr></DIV>
<DIV style="position:absolute;top:936;left:475"><nobr><span class="ft7">itary aviation development where markings might include<br>NATO RESTRICTED, UK RESTRICTED and ICELAND<br>RESTRICTED. They are all at the same level of security,<br>but apply to different nationalities in different ways. A UK<br>citizen could receive the first two, a German could receive<br>the first one only, and a Russian could not receive any. The<br>nationality information could be represented by an addi-<br>tional field, which might be an array of booleans mapping<br>each country code to an Allowed/Forbidden code.</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">43</span></nobr></DIV>
</DIV>
<!-- Page 6 -->
<a name="6"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1258" src="82006.png" alt="background image">
<DIV style="position:absolute;top:74;left:81"><nobr><span class="ft1">3.5 Security policies</span></nobr></DIV>
<DIV style="position:absolute;top:100;left:94"><nobr><span class="ft3">So far we have considered enforcing the Bell-LaPadula se-</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:81"><nobr><span class="ft7">curity policy. However, there are other policies which may<br>be desirable for enforcement. One example is a policy where<br>information at security level N may only flow into other in-<br>formation at security level N; there is no concept of ordering<br>on these security levels, they may simply not be mixed.</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:94"><nobr><span class="ft3">There is further work to be done on investigating whether</span></nobr></DIV>
<DIV style="position:absolute;top:210;left:81"><nobr><span class="ft7">other information flow policies are desirable and useful for<br>security-critical or safety-critical code.</span></nobr></DIV>
<DIV style="position:absolute;top:226;left:333"><nobr><span class="ft3">In principle they</span></nobr></DIV>
<DIV style="position:absolute;top:242;left:81"><nobr><span class="ft7">should not be complicated to enforce. The /policy=X com-<br>mand line switch provides a hook to specify different policies<br>in future.</span></nobr></DIV>
<DIV style="position:absolute;top:301;left:81"><nobr><span class="ft1">4. ISSUES FOR FUTURE RESEARCH</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:94"><nobr><span class="ft3">In this section we discuss the limitations of the existing</span></nobr></DIV>
<DIV style="position:absolute;top:343;left:81"><nobr><span class="ft7">work and examine how the analysis techniques may be ex-<br>tended in the future.</span></nobr></DIV>
<DIV style="position:absolute;top:379;left:81"><nobr><span class="ft1">4.1 Difficulties with analysis</span></nobr></DIV>
<DIV style="position:absolute;top:406;left:94"><nobr><span class="ft3">The concept of "label creep" as identified by Sabelfeld and</span></nobr></DIV>
<DIV style="position:absolute;top:421;left:81"><nobr><span class="ft7">Myers refers to the tendency of data to increase in security<br>level as program execution progresses; assigning a</span></nobr></DIV>
<DIV style="position:absolute;top:438;left:386"><nobr><span class="ft4">SECRET</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:81"><nobr><span class="ft3">value to one field of a large</span></nobr></DIV>
<DIV style="position:absolute;top:454;left:261"><nobr><span class="ft4">CONFIDENTIAL</span></nobr></DIV>
<DIV style="position:absolute;top:453;left:375"><nobr><span class="ft3">record will</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:81"><nobr><span class="ft3">make the entire record</span></nobr></DIV>
<DIV style="position:absolute;top:470;left:235"><nobr><span class="ft4">SECRET</span></nobr></DIV>
<DIV style="position:absolute;top:468;left:295"><nobr><span class="ft3">. It remains to be seen</span></nobr></DIV>
<DIV style="position:absolute;top:484;left:81"><nobr><span class="ft7">how SPARK security programs should be designed in order<br>to minimise label creep.</span></nobr></DIV>
<DIV style="position:absolute;top:515;left:94"><nobr><span class="ft3">Concurrency is more complex because there is the possi-</span></nobr></DIV>
<DIV style="position:absolute;top:531;left:81"><nobr><span class="ft7">bility that security information may leak from the observable<br>scheduling order of the processes. This is addressed to some<br>extent because SPARK analysis of Ravenscar programs does<br>information flow across tasks.</span></nobr></DIV>
<DIV style="position:absolute;top:598;left:81"><nobr><span class="ft1">4.2 Wider analysis</span></nobr></DIV>
<DIV style="position:absolute;top:625;left:94"><nobr><span class="ft3">One extension suggestion that has come from a software</span></nobr></DIV>
<DIV style="position:absolute;top:640;left:81"><nobr><span class="ft7">development project within the company is the idea of sub-<br>program integrity level. The motivation is similar to that<br>for the SHOLIS analysis; that only part of a given program<br>is safety-critical, and that verification activities (proof, unit<br>testing levels, coverage analysis etc.) may be better focused<br>on the safety-critical parts. Subprograms are a more useful<br>unit of division for these activities than package state.</span></nobr></DIV>
<DIV style="position:absolute;top:750;left:94"><nobr><span class="ft3">The algorithm for identifying a subprogram's actual in-</span></nobr></DIV>
<DIV style="position:absolute;top:766;left:81"><nobr><span class="ft7">tegrity level is to examine its exports. If it only exports own<br>variables then the subprogram integrity level is the maxi-<br>mum of all exported own variable integrity levels. If some<br>exported variables are formal parameters then each invoca-<br>tion of the subprogram must be examined for own variables<br>that may be actual parameters, and the maximum integrity<br>level taken over all possible exported own variables. Func-<br>tions are taken to be equivalent to a procedure with a single<br>exported parameter.</span></nobr></DIV>
<DIV style="position:absolute;top:907;left:94"><nobr><span class="ft3">There are two clear choices for implementing this strategy:</span></nobr></DIV>
<DIV style="position:absolute;top:932;left:97"><nobr><span class="ft3">1. whole-program analysis, determining subprogram in-</span></nobr></DIV>
<DIV style="position:absolute;top:948;left:114"><nobr><span class="ft3">tegrity level once all invocations are known; or</span></nobr></DIV>
<DIV style="position:absolute;top:973;left:97"><nobr><span class="ft3">2. partial-program analysis, annotating each critical sub-</span></nobr></DIV>
<DIV style="position:absolute;top:989;left:114"><nobr><span class="ft7">program declaration with its integrity level and check-<br>ing at declaration and each invocation that the maxi-<br>mum integrity level is not violated.</span></nobr></DIV>
<DIV style="position:absolute;top:1045;left:94"><nobr><span class="ft3">The first choice is minimal-impact, but does not admit</span></nobr></DIV>
<DIV style="position:absolute;top:1061;left:81"><nobr><span class="ft3">analysis until the whole program is written which is likely to</span></nobr></DIV>
<DIV style="position:absolute;top:81;left:475"><nobr><span class="ft7">prove troublesome; the integrity level of many subprograms<br>will not be known until very late in the development process,<br>by which time testing should already be ramped up.</span></nobr></DIV>
<DIV style="position:absolute;top:128;left:489"><nobr><span class="ft3">The second choice is higher impact; it requires an extra</span></nobr></DIV>
<DIV style="position:absolute;top:144;left:475"><nobr><span class="ft7">annotation to be added to the SPARK language and checked<br>by the Examiner, and requires developers to add the anno-<br>tation to each potentially critical subprogram as it is spec-<br>ified. However, the benefits of the partial program analysis<br>are likely to outweigh these drawbacks.</span></nobr></DIV>
<DIV style="position:absolute;top:236;left:475"><nobr><span class="ft1">4.3 Subverting the analysis</span></nobr></DIV>
<DIV style="position:absolute;top:263;left:489"><nobr><span class="ft3">Declassification is occasionally necessary in security pro-</span></nobr></DIV>
<DIV style="position:absolute;top:278;left:475"><nobr><span class="ft7">grams; this is when the assigned security level of information<br>is deliberately reduced. An example would be a security fil-<br>ter which took</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:568"><nobr><span class="ft4">SECRET</span></nobr></DIV>
<DIV style="position:absolute;top:310;left:628"><nobr><span class="ft3">information, stripped out sensitive</span></nobr></DIV>
<DIV style="position:absolute;top:325;left:475"><nobr><span class="ft3">fields and output information which was no more than</span></nobr></DIV>
<DIV style="position:absolute;top:327;left:800"><nobr><span class="ft4">CON-</span></nobr></DIV>
<DIV style="position:absolute;top:343;left:475"><nobr><span class="ft4">FIDENTIAL</span></nobr></DIV>
<DIV style="position:absolute;top:341;left:559"><nobr><span class="ft3">level. This can be done in SPARK by hiding</span></nobr></DIV>
<DIV style="position:absolute;top:357;left:475"><nobr><span class="ft7">the body of a declassifying subprogram from the Examiner,<br>but this is clearly not an optimal solution. A better solution<br>should be found.</span></nobr></DIV>
<DIV style="position:absolute;top:418;left:475"><nobr><span class="ft1">4.4 Considerations for certification</span></nobr></DIV>
<DIV style="position:absolute;top:445;left:489"><nobr><span class="ft3">In very high security applications it may be necessary to</span></nobr></DIV>
<DIV style="position:absolute;top:460;left:475"><nobr><span class="ft7">certify the object code as well as the source code. It remains<br>to be seen whether and how the information known from the<br>SPARK source code analysis can be carried over to inform<br>an object code analysis.</span></nobr></DIV>
<DIV style="position:absolute;top:523;left:489"><nobr><span class="ft3">There are other ways by which secure information can be</span></nobr></DIV>
<DIV style="position:absolute;top:539;left:475"><nobr><span class="ft7">observed, such as covert or timing channels. A full imple-<br>mentation of multi-level security information analysis should<br>be followed by an analysis of how much information could<br>be leaked this way.</span></nobr></DIV>
<DIV style="position:absolute;top:633;left:475"><nobr><span class="ft1">5. CONCLUSIONS</span></nobr></DIV>
<DIV style="position:absolute;top:660;left:489"><nobr><span class="ft3">In this paper we have described recent work on applying</span></nobr></DIV>
<DIV style="position:absolute;top:675;left:475"><nobr><span class="ft7">information flow analysis techniques to enforcing multi-level<br>security in a single software application. We have shown<br>how the requirements listed by Sabelfeld and Myers[11] are<br>partially satisfied by the information flow analysis possible<br>with SPARK Ada and the SPARK Examiner. We have fur-<br>ther shown that the existing SPARK language and analy-<br>sis may be extended to enforce the Bell-LaPadula security<br>model with relatively little change.</span></nobr></DIV>
<DIV style="position:absolute;top:801;left:489"><nobr><span class="ft3">SPARK Ada has already proven itself in high-security and</span></nobr></DIV>
<DIV style="position:absolute;top:817;left:475"><nobr><span class="ft7">safety-critical application development. It now appears to<br>be an effective choice of language to partition data of differ-<br>ing criticality, and provide a low-cost but robust argument<br>of safety or security for an application. SPARK already<br>provides the semantics-based security required by Sabelfeld<br>and Myers; the extensions to own variable annotations now<br>provide the complementary security type system.</span></nobr></DIV>
<DIV style="position:absolute;top:926;left:489"><nobr><span class="ft3">For end-to-end confidentiality in a secure system, we be-</span></nobr></DIV>
<DIV style="position:absolute;top:942;left:475"><nobr><span class="ft7">lieve that SPARK Ada's extended information flow analysis<br>provides a hard-to-refute justification of data security.</span></nobr></DIV>
<DIV style="position:absolute;top:988;left:475"><nobr><span class="ft1">5.1 Acknowledgements</span></nobr></DIV>
<DIV style="position:absolute;top:1014;left:489"><nobr><span class="ft3">The authors are grateful to Peter Amey, Neil White and</span></nobr></DIV>
<DIV style="position:absolute;top:1030;left:475"><nobr><span class="ft7">Will Ward from Praxis Critical Systems for their feedback<br>on this paper and the prototype integrity checking facilities<br>of the Examiner.</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">44</span></nobr></DIV>
</DIV>
<!-- Page 7 -->
<a name="7"></a>
<DIV style="position:relative;width:918;height:1258;">
<STYLE type="text/css">
<!--
-->
</STYLE>
<IMG width="918" height="1258" src="82007.png" alt="background image">
<DIV style="position:absolute;top:74;left:81"><nobr><span class="ft1">6. REFERENCES</span></nobr></DIV>
<DIV style="position:absolute;top:101;left:88"><nobr><span class="ft3">[1] R. J. Anderson. Security engineering: a guide to</span></nobr></DIV>
<DIV style="position:absolute;top:116;left:109"><nobr><span class="ft7">building dependable distributed systems. Wiley<br>Computer Publishing, 2001. ISBN 0-471-38922-6.</span></nobr></DIV>
<DIV style="position:absolute;top:149;left:88"><nobr><span class="ft3">[2] J. Barnes. High Integrity Software: The SPARK</span></nobr></DIV>
<DIV style="position:absolute;top:165;left:109"><nobr><span class="ft7">Approach to Safety And Security. Addison Wesley,<br>April 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:198;left:88"><nobr><span class="ft3">[3] D. E. Bell and L. LaPadula. Secure computer systems.</span></nobr></DIV>
<DIV style="position:absolute;top:214;left:109"><nobr><span class="ft7">Technical Report ESR-TR-73-278, Mitre Corporation,<br>November 1973. v. I and II.</span></nobr></DIV>
<DIV style="position:absolute;top:246;left:88"><nobr><span class="ft3">[4] J.-F. Bergeretti and B. A. Carr´e. Information-flow and</span></nobr></DIV>
<DIV style="position:absolute;top:262;left:109"><nobr><span class="ft7">data-flow analysis of while-programs. ACM<br>Transactions on Programming Languages and<br>Systems, 7(1):37­61, January 1985.</span></nobr></DIV>
<DIV style="position:absolute;top:311;left:88"><nobr><span class="ft3">[5] Common Criteria. Common Criteria for Information</span></nobr></DIV>
<DIV style="position:absolute;top:326;left:109"><nobr><span class="ft3">Technology Security Evaluation, August 1999.</span></nobr></DIV>
<DIV style="position:absolute;top:343;left:88"><nobr><span class="ft3">[6] D. Dolev and A. Yao. On the security of public-key</span></nobr></DIV>
<DIV style="position:absolute;top:359;left:109"><nobr><span class="ft7">protocols. IEEE Transactions on Information Theory,<br>2(29):198­208, August 1983.</span></nobr></DIV>
<DIV style="position:absolute;top:81;left:482"><nobr><span class="ft3">[7] A. Hall and R. Chapman. Correctness by</span></nobr></DIV>
<DIV style="position:absolute;top:97;left:503"><nobr><span class="ft7">construction: Developing a commercial secure system.<br>IEEE Software, pages 18­25, Jan/Feb 2002.</span></nobr></DIV>
<DIV style="position:absolute;top:129;left:482"><nobr><span class="ft3">[8] International Electrotechnical Commission. IEC</span></nobr></DIV>
<DIV style="position:absolute;top:145;left:503"><nobr><span class="ft7">Standard 61508, Functional Safety of Electrical /<br>Electronic / Programmable Electronic Safety-Related<br>Systems, March 2000.</span></nobr></DIV>
<DIV style="position:absolute;top:194;left:482"><nobr><span class="ft3">[9] S. King, J. Hammond, R. Chapman, and A. Pryor. Is</span></nobr></DIV>
<DIV style="position:absolute;top:209;left:503"><nobr><span class="ft7">proof more cost effective than testing? IEEE<br>Transactions on Software Engineering, 26(8):675­686,<br>August 2000.</span></nobr></DIV>
<DIV style="position:absolute;top:258;left:475"><nobr><span class="ft3">[10] RTCA / EUROCAE. RTCA DO-178B / EUROCAE</span></nobr></DIV>
<DIV style="position:absolute;top:274;left:503"><nobr><span class="ft7">ED-12: Software Considerations in Airborne Systems<br>and Equipment Certification, December 1992.</span></nobr></DIV>
<DIV style="position:absolute;top:307;left:475"><nobr><span class="ft3">[11] A. Sabelfeld and A. C. Myers. Language-based</span></nobr></DIV>
<DIV style="position:absolute;top:322;left:503"><nobr><span class="ft7">information-flow security. IEEE Journal on Selected<br>Areas in Communications, 21(1), January 2003.</span></nobr></DIV>
<DIV style="position:absolute;top:1115;left:452"><nobr><span class="ft6">45</span></nobr></DIV>
</DIV>
</BODY>
</HTML>
